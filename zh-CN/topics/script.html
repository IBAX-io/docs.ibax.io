<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>智能合约 </a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#contract-structure" class="sidebar-link">智能合约结构 </a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#data-section" class="sidebar-link">数据部分 </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#conditions-section" class="sidebar-link">条件部分 </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#action-section" class="sidebar-link">操作部分 </a></li></ul></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#variables" class="sidebar-link">变量 </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#nested-contracts" class="sidebar-link">嵌套智能合约 </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#file-upload" class="sidebar-link">文件上传 </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#queries-in-json-format" class="sidebar-link">JSON格式查询语句 </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#queries-with-date-and-time-operations" class="sidebar-link">日期时间格式查询语句 </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#needle-contract-language" class="sidebar-link">needle 合约语言 </a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#basic-elements-and-structure" class="sidebar-link">基本要素和结构 </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#data-types-and-variables" class="sidebar-link">数据类型和变量 </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#array" class="sidebar-link">数组 </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#if-and-while-statements" class="sidebar-link">If和While语句 </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#functions" class="sidebar-link">函数 </a></li></ul></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#needle-functions-classification" class="sidebar-link">needle 函数功能分类 </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#needle-functions-reference" class="sidebar-link">needle 函数参考 </a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#appparam" class="sidebar-link">AppParam </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#dbfind" class="sidebar-link">DBFind </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#dbrow" class="sidebar-link">DBRow </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#dbselectmetrics" class="sidebar-link">DBSelectMetrics </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#ecosysparam" class="sidebar-link">EcosysParam </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#gethistory" class="sidebar-link">GetHistory </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#gethistoryrow" class="sidebar-link">GetHistoryRow </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#getcolumntype" class="sidebar-link">GetColumnType </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#getdatafromxlsx" class="sidebar-link">GetDataFromXLSX </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#getrowscountxlsx" class="sidebar-link">GetRowsCountXLSX </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#langres" class="sidebar-link">LangRes </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#getblock" class="sidebar-link">GetBlock </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#dbinsert" class="sidebar-link">DBInsert </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#dbupdate" class="sidebar-link">DBUpdate </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#dbupdateext" class="sidebar-link">DBUpdateExt </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#delcolumn" class="sidebar-link">DelColumn </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#deltable" class="sidebar-link">DelTable </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#append" class="sidebar-link">Append </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#join" class="sidebar-link">Join </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#split" class="sidebar-link">Split </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#len" class="sidebar-link">Len </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#row" class="sidebar-link">Row </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#one" class="sidebar-link">One </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#getmapkeys" class="sidebar-link">GetMapKeys </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#sortedkeys" class="sidebar-link">SortedKeys </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#callcontract" class="sidebar-link">CallContract </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#contractaccess" class="sidebar-link">ContractAccess </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#contractconditions" class="sidebar-link">ContractConditions </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#evalcondition" class="sidebar-link">EvalCondition </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#getcontractbyid" class="sidebar-link">GetContractById </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#getcontractbyname" class="sidebar-link">GetContractByName </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#roleaccess" class="sidebar-link">RoleAccess </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#transactioninfo" class="sidebar-link">TransactionInfo </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#throw" class="sidebar-link">Throw </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#validatecondition" class="sidebar-link">ValidateCondition </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#addresstoid" class="sidebar-link">AddressToId </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#idtoaddress" class="sidebar-link">IdToAddress </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#pubtoid" class="sidebar-link">PubToID </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#decodebase64" class="sidebar-link">DecodeBase64 </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#encodebase64" class="sidebar-link">EncodeBase64 </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#float" class="sidebar-link">Float </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#hextobytes" class="sidebar-link">HexToBytes </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#formatmoney" class="sidebar-link">FormatMoney </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#random" class="sidebar-link">Random </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#int" class="sidebar-link">Int </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#hash" class="sidebar-link">Hash </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#sha256" class="sidebar-link">Sha256 </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#str" class="sidebar-link">Str </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#jsonencode" class="sidebar-link">JSONEncode </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#jsonencodeindent" class="sidebar-link">JSONEncodeIndent </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#jsondecode" class="sidebar-link">JSONDecode </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#hasprefix" class="sidebar-link">HasPrefix </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#contains" class="sidebar-link">Contains </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#replace" class="sidebar-link">Replace </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#size" class="sidebar-link">Size </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#sprintf" class="sidebar-link">Sprintf </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#substr" class="sidebar-link">Substr </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#tolower" class="sidebar-link">ToLower </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#toupper" class="sidebar-link">ToUpper </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#trimspace" class="sidebar-link">TrimSpace </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#floor" class="sidebar-link">Floor </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#log" class="sidebar-link">Log </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#log10" class="sidebar-link">Log10 </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#pow" class="sidebar-link">Pow </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#round" class="sidebar-link">Round </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#sqrt" class="sidebar-link">Sqrt </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#stringtobytes" class="sidebar-link">StringToBytes </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#bytestostring" class="sidebar-link">BytesToString </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#sysparamstring" class="sidebar-link">SysParamString </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#sysparamint" class="sidebar-link">SysParamInt </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#dbupdatesysparam" class="sidebar-link">DBUpdateSysParam </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#updatenotifications" class="sidebar-link">UpdateNotifications </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#updaterolesnotifications" class="sidebar-link">UpdateRolesNotifications </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#httprequest" class="sidebar-link">HTTPRequest </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#httppostjson" class="sidebar-link">HTTPPostJSON </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#blocktime" class="sidebar-link">BlockTime </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#datetime" class="sidebar-link">DateTime </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#unixdatetime" class="sidebar-link">UnixDateTime </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#createobs" class="sidebar-link">CreateOBS </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#getobslist" class="sidebar-link">GetOBSList </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#runobs" class="sidebar-link">RunOBS </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#stopobs" class="sidebar-link">StopOBS </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#removeobs" class="sidebar-link">RemoveOBS </a></li></ul></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#system-contracts" class="sidebar-link">System Contracts </a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#newecosystem" class="sidebar-link">NewEcosystem </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#editecosystemname" class="sidebar-link">EditEcosystemName </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#newcontract" class="sidebar-link">NewContract </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#editcontract" class="sidebar-link">EditContract </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#bindwallet" class="sidebar-link">BindWallet </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#unbindwallet" class="sidebar-link">UnbindWallet </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#newparameter" class="sidebar-link">NewParameter </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#editparameter" class="sidebar-link">EditParameter </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#newmenu" class="sidebar-link">NewMenu </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#editmenu" class="sidebar-link">EditMenu </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#appendmenu" class="sidebar-link">AppendMenu </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#newpage" class="sidebar-link">NewPage </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#editpage" class="sidebar-link">EditPage </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#appendpage" class="sidebar-link">AppendPage </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#newblock" class="sidebar-link">NewBlock </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#editblock" class="sidebar-link">EditBlock </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#newtable" class="sidebar-link">NewTable </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#edittable" class="sidebar-link">EditTable </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#newcolumn" class="sidebar-link">NewColumn </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#editcolumn" class="sidebar-link">EditColumn </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#newlang" class="sidebar-link">NewLang </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#editlang" class="sidebar-link">EditLang </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#import" class="sidebar-link">Import </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#importupload" class="sidebar-link">ImportUpload </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#newappparam" class="sidebar-link">NewAppParam </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#editappparam" class="sidebar-link">EditAppParam </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#newdelayedcontract" class="sidebar-link">NewDelayedContract </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#editdelayedcontract" class="sidebar-link">EditDelayedContract </a></li><li class="sidebar-sub-header"><a href="/zh-CN/topics/script.html#uploadbinary" class="sidebar-link">UploadBinary </a></li></ul></li></ul></li><li><a href="/zh-CN/topics/templates2.html" class="sidebar-link">模版语言 </a></li><li><a href="/zh-CN/topics/vm.html" class="sidebar-link">编译器和虚拟机 </a></li><li><a href="/zh-CN/topics/daemons.html" class="sidebar-link">守护进程 </a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="smart-contracts"><a href="#smart-contracts" class="header-anchor">#</a> 智能合约 </h1> <ul><li><a href="#contract-structure">智能合约结构</a> <ul><li><a href="#data-section">数据部分</a></li> <li><a href="#conditions-section">条件部分</a></li> <li><a href="#action-section">操作部分</a></li></ul></li> <li><a href="#variables">变量</a></li> <li><a href="#nested-contracts">嵌套智能合约</a></li> <li><a href="#file-upload">文件上传</a></li> <li><a href="#queries-in-json-format">JSON格式查询语句</a></li> <li><a href="#queries-with-date-and-time-operations">日期时间格式查询语句</a></li> <li><a href="#needle-contract-language">needle 智能合约语言</a> <ul><li><a href="#basic-elements-and-structure">基本要素和结构</a></li> <li><a href="#data-types-and-variables">数据类型和变量</a></li> <li><a href="#array">数组</a></li> <li><a href="#if-and-while-statements">If和While语句</a></li> <li><a href="#functions">函数</a> <ul><li><a href="#function-declaration">函数声明</a></li> <li><a href="#variable-length-parameters">可变长度参数</a></li> <li><a href="#optional-parameters">可选参数</a></li></ul></li></ul></li> <li><a href="#needle-functions-classification">needle 函数功能分类</a></li> <li><a href="#needle-functions-reference">needle 函数参考</a> <ul><li><a href="#appparam">AppParam</a></li> <li><a href="#dbfind">DBFind</a></li> <li><a href="#dbrow">DBRow</a></li> <li><a href="#dbselectmetrics">DBSelectMetrics</a></li> <li><a href="#ecosysparam">EcosysParam</a></li> <li><a href="#gethistory">GetHistory</a></li> <li><a href="#gethistoryrow">GetHistoryRow</a></li> <li><a href="#getcolumntype">GetColumnType</a></li> <li><a href="#getdatafromxlsx">GetDataFromXLSX</a></li> <li><a href="#getrowscountxlsx">GetRowsCountXLSX</a></li> <li><a href="#langres">LangRes</a></li> <li><a href="#getblock">GetBlock</a></li> <li><a href="#dbinsert">DBInsert</a></li> <li><a href="#dbupdate">DBUpdate</a></li> <li><a href="#dbupdateext">DBUpdateExt</a></li> <li><a href="#delcolumn">DelColumn</a></li> <li><a href="#deltable">DelTable</a></li> <li><a href="#append">Append</a></li> <li><a href="#join">Join</a></li> <li><a href="#split">Split</a></li> <li><a href="#len">Len</a></li> <li><a href="#row">Row</a></li> <li><a href="#one">One</a></li> <li><a href="#getmapkeys">GetMapKeys</a></li> <li><a href="#sortedkeys">SortedKeys</a></li> <li><a href="#callcontract">CallContract</a></li> <li><a href="#contractaccess">ContractAccess</a></li> <li><a href="#contractconditions">ContractConditions</a></li> <li><a href="#evalcondition">EvalCondition</a></li> <li><a href="#getcontractbyid">GetContractById</a></li> <li><a href="#getcontractbyname">GetContractByName</a></li> <li><a href="#roleaccess">RoleAccess</a></li> <li><a href="#transactioninfo">TransactionInfo</a></li> <li><a href="#throw">Throw</a></li> <li><a href="#validatecondition">ValidateCondition</a></li> <li><a href="#addresstoid">AddressToId</a></li> <li><a href="#idtoaddress">IdToAddress</a></li> <li><a href="#pubtoid">PubToID</a></li> <li><a href="#decodebase64">DecodeBase64</a></li> <li><a href="#encodebase64">EncodeBase64</a></li> <li><a href="#float">Float</a></li> <li><a href="#hextobytes">HexToBytes</a></li> <li><a href="#formatmoney">FormatMoney</a></li> <li><a href="#random">Random</a></li> <li><a href="#int">Int</a></li> <li><a href="#hash">Hash</a></li> <li><a href="#sha256">Sha256</a></li> <li><a href="#str">Str</a></li> <li><a href="#jsonencode">JSONEncode</a></li> <li><a href="#jsonencodeindent">JSONEncodeIndent</a></li> <li><a href="#jsondecode">JSONDecode</a></li> <li><a href="#hasprefix">HasPrefix</a></li> <li><a href="#contains">Contains</a></li> <li><a href="#replace">Replace</a></li> <li><a href="#size">Size</a></li> <li><a href="#sprintf">Sprintf</a></li> <li><a href="#substr">Substr</a></li> <li><a href="#tolower">ToLower</a></li> <li><a href="#toupper">ToUpper</a></li> <li><a href="#trimspace">TrimSpace</a></li> <li><a href="#floor">Floor</a></li> <li><a href="#log">Log</a></li> <li><a href="#log10">Log10</a></li> <li><a href="#pow">Pow</a></li> <li><a href="#round">Round</a></li> <li><a href="#sqrt">Sqrt</a></li> <li><a href="#stringtobytes">StringToBytes</a></li> <li><a href="#bytestostring">BytesToString</a></li> <li><a href="#sysparamstring">SysParamString</a></li> <li><a href="#sysparamint">SysParamInt</a></li> <li><a href="#dbupdatesysparam">DBUpdateSysParam</a></li> <li><a href="#updatenotifications">UpdateNotifications</a></li> <li><a href="#updaterolesnotifications">UpdateRolesNotifications</a></li> <li><a href="#httprequest">HTTPRequest</a></li> <li><a href="#httppostjson">HTTPPostJSON</a></li> <li><a href="#blocktime">BlockTime</a></li> <li><a href="#datetime">DateTime</a></li> <li><a href="#unixdatetime">UnixDateTime</a></li> <li><a href="#createobs">CreateOBS</a></li> <li><a href="#getobslist">GetOBSList</a></li> <li><a href="#runobs">RunOBS</a></li> <li><a href="#stopobs">StopOBS</a></li> <li><a href="#removeobs">RemoveOBS</a></li></ul></li> <li><a href="#system-contracts">系统智能合约</a> <ul><li><a href="#newecosystem">NewEcosystem</a></li> <li><a href="#editecosystemname">EditEcosystemName</a></li> <li><a href="#newcontract">NewContract</a></li> <li><a href="#editcontract">EditContract</a></li> <li><a href="#bindwallet">BindWallet</a></li> <li><a href="#unbindwallet">UnbindWallet</a></li> <li><a href="#newparameter">NewParameter</a></li> <li><a href="#editparameter">EditParameter</a></li> <li><a href="#newmenu">NewMenu</a></li> <li><a href="#editmenu">EditMenu</a></li> <li><a href="#appendmenu">AppendMenu</a></li> <li><a href="#newpage">NewPage</a></li> <li><a href="#editpage">EditPage</a></li> <li><a href="#appendpage">AppendPage</a></li> <li><a href="#newblock">NewBlock</a></li> <li><a href="#editblock">EditBlock</a></li> <li><a href="#newtable">NewTable</a></li> <li><a href="#edittable">EditTable</a></li> <li><a href="#newcolumn">NewColumn</a></li> <li><a href="#editcolumn">EditColumn</a></li> <li><a href="#newlang">NewLang</a></li> <li><a href="#editlang">EditLang</a></li> <li><a href="#import">Import</a></li> <li><a href="#importupload">ImportUpload</a></li> <li><a href="#newappparam">NewAppParam</a></li> <li><a href="#editappparam">EditAppParam</a></li> <li><a href="#newdelayedcontract">NewDelayedContract</a></li> <li><a href="#editdelayedcontract">EditDelayedContract</a></li> <li><a href="#uploadbinary">UploadBinary</a></li></ul></li></ul> <p>用户在页面中执行智能合约通常是单个操作，结果是更改或创建数据库的条目。应用程序的所有数据操作形成了智能合约系统，这些智能合约通过数据库或者智能合约内容的函数彼此交互。</p> <h2 id="contract-structure"><a href="#contract-structure" class="header-anchor">#</a> 智能合约结构 </h2> <p>使用 <strong>contract</strong>关键字声明智能合约，后面接上智能合约名称，智能合约内容必须用大括号括起来。智能合约结构有三个主要部分：</p> <blockquote><ol><li><strong>data</strong> - <a href="#data-section">数据部分</a>，声明输入数据的变量，包括变量名称和变量类型；</li> <li><strong>conditions</strong> - <a href="#conditions-section">条件部分</a>，验证数据的正确性；</li> <li><strong>action</strong> - <a href="#action-section">操作部分</a>，执行数据操作的动作。</li></ol></blockquote> <div class="language-js extra-class"><pre class="language-js"><code>contract MyContract <span class="token punctuation">{</span>
    data <span class="token punctuation">{</span>
        FromId int
        ToId   int
        Amount money
    <span class="token punctuation">}</span>
    func conditions <span class="token punctuation">{</span>
        <span class="token operator">...</span>
    <span class="token punctuation">}</span>
    func action <span class="token punctuation">{</span>
        <span class="token operator">...</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="data-section"><a href="#data-section" class="header-anchor">#</a> 数据部分 </h3> <p><code>data</code> 部分描述了智能合约数据输入以及接收的表单参数。</p> <p>每行的依次顺序结构：</p> <blockquote><ul><li><em>变量名称</em> - 只接收变量，不支持接收数组；</li> <li><em>变量数据类型</em> - 变量的 <a href="#data-types-and-variables">数据类型</a>；</li> <li><em>optional</em> - 可选参数，不需要填充的表单元素。</li></ul></blockquote> <div class="language-js extra-class"><pre class="language-js"><code>contract my <span class="token punctuation">{</span>
  data <span class="token punctuation">{</span>
      Name string
      RequestId int
      Photo file <span class="token string">&quot;optional&quot;</span>
      Amount money
      Private bytes
  <span class="token punctuation">}</span>
  <span class="token operator">...</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="conditions-section"><a href="#conditions-section" class="header-anchor">#</a> 条件部分 </h3> <p><code>conditions</code> 部分描述了对接收的数据进行验证。</p> <p>以下命令用于错误警告：严重性错误 <code>error</code>、警告性错误<code>warning</code>、提示性错误<code>info</code>，这三种命令都会生成一个终止智能合约执行的错误，每个错误都会打印不同类型的错误日志信息。例如：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">if</span> fuel <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">{</span>
      error <span class="token string">&quot;fuel cannot be zero!&quot;</span>
<span class="token punctuation">}</span>
<span class="token keyword">if</span> money <span class="token operator">&lt;</span> limit <span class="token punctuation">{</span>
      warning <span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">&quot;You don't have enough money: %v &lt; %v&quot;</span><span class="token punctuation">,</span> money<span class="token punctuation">,</span> limit<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">if</span> idexist <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token punctuation">{</span>
      info <span class="token string">&quot;You have already been registered&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="action-section"><a href="#action-section" class="header-anchor">#</a> 操作部分 </h3> <p><code>action</code>部分描述了智能合约的主要代码，该代码检索其他数据并将结果值记录到数据库表中。例如：</p> <div class="language-js extra-class"><pre class="language-js"><code>action <span class="token punctuation">{</span>
    <span class="token function">DBUpdate</span><span class="token punctuation">(</span><span class="token string">&quot;keys&quot;</span><span class="token punctuation">,</span> $key_id<span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token string-property property">&quot;-amount&quot;</span><span class="token operator">:</span> $amount<span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token function">DBUpdate</span><span class="token punctuation">(</span><span class="token string">&quot;keys&quot;</span><span class="token punctuation">,</span> $recipient<span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token string-property property">&quot;+amount&quot;</span><span class="token operator">:</span> $amount<span class="token punctuation">,</span> <span class="token string-property property">&quot;pub&quot;</span><span class="token operator">:</span> $Pub<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="variables"><a href="#variables" class="header-anchor">#</a> 变量 </h2> <p><strong>data</strong> 部分声明的变量通过 <code>$</code>符号后面跟上变量名称传递给其他智能合约部分。<code>$</code>符号也可以声明其他不在数据部分内的变量。这些变量被认为是这个智能合约和所有嵌套该智能合约的全局变量。</p> <p>智能合约内可以使用预定义变量，这些变量包含调用该智能合约的交易数据：</p> <blockquote><ul><li><code>$time</code> -- 交易时间戳；</li> <li><code>$ecosystem_id</code> -- 生态系统ID；</li> <li><code>$block</code> -- 包含该交易的区块ID；</li> <li><code>$key_id</code> -- 签署当前交易的账户地址；</li> <li><code>$type</code> 虚拟机中智能合约ID；</li> <li><code>$block_key_id</code> -- 生成区块的节点账户地址；</li> <li><code>$block_time</code> -- 区块生成时间戳；</li> <li><code>$original_contract</code> -- 最初进行交易处理的智能合约名称。如果该变量为空字符串，表示交易在验证过程中调用了该智能合约。要检查该智能合约是由另一个智能合约调用还是直接从交易调用，需要比较 <em>$original_contract</em> 和 <em>$this_contract</em> 的值。 如果它们相等，则表示智能合约是从交易调用的；</li> <li><code>$this_contract</code> -- 当前执行智能合约名称；</li> <li><code>$guest_key</code> -- 访客账户地址；</li> <li><code>$stack</code> -- 智能合约数组堆栈，*array* 类型，包含所有执行的智能合约，数组第一个元素表示当前执行的智能合约名称，最后一个元素表示最初进行交易处理的智能合约名称；</li> <li><code>$node_position</code> -- 区块所在的验证节点数组的索引号；</li> <li><code>$txhash</code> -- 交易哈希；</li> <li><code>$contract</code> -- 当前智能合约结构数组。</li></ul></blockquote> <p>预定义变量不仅可以在智能合约中访问，还可以在定义应用程序元素的访问权限条件的权限字段中访问。当用于权限字段时，关于区块信息的预定义变量始终等于零，例如<code>$time</code>， <code>$block</code> 等。</p> <p>预定义变量 <code>$result</code> 赋值于智能合约的返回结果。</p> <div class="language-js extra-class"><pre class="language-js"><code>contract my <span class="token punctuation">{</span>
  data <span class="token punctuation">{</span>
      Name string 
      Amount money
  <span class="token punctuation">}</span>
  func conditions <span class="token punctuation">{</span>
      <span class="token keyword">if</span> $Amount <span class="token operator">&lt;=</span> <span class="token number">0</span> <span class="token punctuation">{</span>
         error <span class="token string">&quot;Amount cannot be 0&quot;</span>
      <span class="token punctuation">}</span>
      $ownerId <span class="token operator">=</span> <span class="token number">1232</span>
  <span class="token punctuation">}</span>
  func action <span class="token punctuation">{</span>
      <span class="token keyword">var</span> amount money
      amount <span class="token operator">=</span> $Amount <span class="token operator">-</span> <span class="token number">10</span>
      <span class="token function">DBUpdate</span><span class="token punctuation">(</span><span class="token string">&quot;mytable&quot;</span><span class="token punctuation">,</span> $ownerId<span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span> $Name<span class="token punctuation">,</span><span class="token literal-property property">amount</span><span class="token operator">:</span> amount<span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token function">DBUpdate</span><span class="token punctuation">(</span><span class="token string">&quot;mytable2&quot;</span><span class="token punctuation">,</span> $ownerId<span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">amount</span><span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="nested-contracts"><a href="#nested-contracts" class="header-anchor">#</a> 嵌套智能合约 </h2> <p>在智能合约的 <em>conditions</em> 和 <em>action</em>部分可以嵌套合约。嵌套合约可以直接调用，合约参数在其合约名称后面的括号中指定，例如，<code>@1NameContract(Params)</code>。也可以使用<a href="#CallContract">CallContract</a> 函数调用。</p> <h2 id="file-upload"><a href="#file-upload" class="header-anchor">#</a> 文件上传 </h2> <p>使用 <code>multipart/form-data</code> 格式的表单上传文件，合约的数据类型必须是<code>file</code>。</p> <div class="language-js extra-class"><pre class="language-js"><code>contract Upload <span class="token punctuation">{</span>
    data <span class="token punctuation">{</span>
        File file
    <span class="token punctuation">}</span>
    <span class="token operator">...</span>
<span class="token punctuation">}</span>
</code></pre></div><p><a href="#UploadBinary">UploadBinary</a> 合约用于上传和存储文件。在页面编辑器使用 Logicor 语言的函数<a href="/zh-CN/topics/templates2.html#binary">Binary</a> 可以获取文件下载链接。</p> <h2 id="queries-in-json-format"><a href="#queries-in-json-format" class="header-anchor">#</a> JSON格式查询语句 </h2> <p>在合约语言中，<strong>JSON</strong> 格式类型可以指定为字段类型。使用语法：</p> <p><strong>columnname-&gt;fieldname</strong> 来处理条目字段。获得的值记录在<strong>columnname.fieldname</strong>。</p> <p>上述语法可以在<a href="/zh-CN/topics/templates2.html#dbfind">DBFind</a> 函数的<em>Columns,One,Where</em> 中使用。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> ret map
<span class="token keyword">var</span> val str
<span class="token keyword">var</span> list array
ret <span class="token operator">=</span> <span class="token function">DBFind</span><span class="token punctuation">(</span><span class="token string">&quot;mytable&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Columns</span><span class="token punctuation">(</span><span class="token string">&quot;myname,doc,doc-&gt;ind&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">WhereId</span><span class="token punctuation">(</span>$Id<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Row</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
val <span class="token operator">=</span> ret<span class="token punctuation">[</span><span class="token string">&quot;doc.ind&quot;</span><span class="token punctuation">]</span>
val <span class="token operator">=</span> <span class="token function">DBFind</span><span class="token punctuation">(</span><span class="token string">&quot;mytable&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Columns</span><span class="token punctuation">(</span><span class="token string">&quot;myname,doc-&gt;type&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">WhereId</span><span class="token punctuation">(</span>$Id<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">One</span><span class="token punctuation">(</span><span class="token string">&quot;doc-&gt;type&quot;</span><span class="token punctuation">)</span>
list <span class="token operator">=</span> <span class="token function">DBFind</span><span class="token punctuation">(</span><span class="token string">&quot;mytable&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Columns</span><span class="token punctuation">(</span><span class="token string">&quot;myname,doc,doc-&gt;ind&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span><span class="token string">&quot;doc-&gt;ind = ?&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;101&quot;</span><span class="token punctuation">)</span>
val <span class="token operator">=</span> <span class="token function">DBFind</span><span class="token punctuation">(</span><span class="token string">&quot;mytable&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">WhereId</span><span class="token punctuation">(</span>$Id<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">One</span><span class="token punctuation">(</span><span class="token string">&quot;doc-&gt;check&quot;</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="queries-with-date-and-time-operations"><a href="#queries-with-date-and-time-operations" class="header-anchor">#</a> 日期时间格式查询语句 </h2> <p>合约语言函数不能直接查询和更新日期时间，但是可以像示例中在Where语句中使用PostgreSQL的函数和功能。例如，需要比较字段<em>date_column</em> 和当前时间，如果 <em>date_column</em>是timestamp类型，那么表达式为 <code>date_column &lt; NOW()</code>；如果 <em>date_column</em>是Unix类型，那么表达式为 <code>to_timestamp(date_column) &gt; NOW()</code>。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">Where</span><span class="token punctuation">(</span><span class="token string">&quot;to_timestamp(date_column) &gt; NOW()&quot;</span><span class="token punctuation">)</span>
<span class="token function">Where</span><span class="token punctuation">(</span><span class="token string">&quot;date_column &lt; NOW() - 30 * interval '1 day'&quot;</span><span class="token punctuation">)</span>
</code></pre></div><p>以下 Needle 函数是处理SQL格式的日期和时间：</p> <ul><li><a href="#blocktime">BlockTime</a></li> <li><a href="#datetime">DateTime</a></li> <li><a href="#unixdatetime">UnixDateTime</a></li></ul> <h2 id="needle-contract-language"><a href="#needle-contract-language" class="header-anchor">#</a> needle 合约语言 </h2> <p>该语言包括一组函数、运算符和结构，可实现数据算法处理和数据库操作。</p> <p>在编辑合约权限不为 <code>false</code>的条件下，合约内容可以修改。对合约更改的完整历史记录存储在区块链中，从Weaver 可获知更改情况。</p> <p>区块链中的数据操作由最新版本的合约执行。</p> <h3 id="basic-elements-and-structure"><a href="#basic-elements-and-structure" class="header-anchor">#</a> 基本要素和结构 </h3> <h3 id="data-types-and-variables"><a href="#data-types-and-variables" class="header-anchor">#</a> 数据类型和变量 </h3> <p>每个变量必须定义数据类型，通常情况下，数据类型会自动转换。可以使用以下数据类型：</p> <blockquote><ul><li><p><code>bool</code> - 布尔值，<code>true</code> 和 <code>false</code>；</p></li> <li><p><code>bytes</code> - 字节格式；</p></li> <li><p><code>int</code> - 64位整数型；</p></li> <li><p><code>array</code> - 任意类型值的数组；</p></li> <li><p><code>map</code> - 对象数组；</p></li> <li><p><code>money</code> - 大整数类型；</p></li> <li><p><code>float</code> - 64位浮点型；</p></li> <li><p><code>string</code> - 字符串，双引号或转义格式： &quot;This is a string&quot; 或者
`This is a string`；</p></li> <li><p><code>file</code> - 对象数组：</p> <blockquote><ul><li><code>Name</code> - 文件名称，<code>string</code> 类型；</li> <li><code>MimeType</code> - <strong>mime-type</strong> 文件格式，<code>string</code> 类型；</li> <li><code>Body</code> - 文件内容，，<code>bytes</code> 类型。</li></ul></blockquote></li></ul></blockquote> <p>所有标识符，包括变量、函数和合约等的名称都区分大小写（MyFunc和myFunc是不同的名称）。</p> <p>使用 <strong>var</strong>关键字声明变量，后跟变量的名称和类型。在大括号内声明的变量必须在同一对大括号内使用。</p> <p>声明的变量具有默认零值：bool类型的零值false，所有数字类型的零值0，字符串类型的零值空字符串，变量声明示例：</p> <div class="language-js extra-class"><pre class="language-js"><code>func <span class="token function">myfunc</span><span class="token punctuation">(</span> val int<span class="token punctuation">)</span> int <span class="token punctuation">{</span>
    <span class="token keyword">var</span> mystr1 mystr2 string<span class="token punctuation">,</span> mypar int
    <span class="token keyword">var</span> checked bool
    <span class="token operator">...</span>
    <span class="token keyword">if</span> checked <span class="token punctuation">{</span>
         <span class="token keyword">var</span> temp int
         <span class="token operator">...</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="array"><a href="#array" class="header-anchor">#</a> 数组 </h3> <p>该语言支持两种数组类型：</p> <ul><li><code>array</code> - 索引从0开始的数组；</li> <li><code>map</code> - 对象数组。</li></ul> <p>分配和检索数组元素时，索引必须放在方括号中。数组中不支持多个索引，不能将数组元素作为 <em>myarr[i][j]</em> 来处理。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> myarr array
<span class="token keyword">var</span> mymap map
<span class="token keyword">var</span> s string

myarr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">100</span>
myarr<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;This is a line&quot;</span>
mymap<span class="token punctuation">[</span><span class="token string">&quot;value&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">777</span>
mymap<span class="token punctuation">[</span><span class="token string">&quot;param&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;Parameter&quot;</span>

s <span class="token operator">=</span> <span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">&quot;%v, %v, %v&quot;</span><span class="token punctuation">,</span> myarr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> mymap<span class="token punctuation">[</span><span class="token string">&quot;value&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> myarr<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> mymap<span class="token punctuation">[</span><span class="token string">&quot;param&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment">// s = 877, This is a line, Parameter</span>
</code></pre></div><p>您还可以在 <code>[]</code> 通过指定元素定义 <code>array</code> 类型。对于 <code>map</code>类型数组，请使用 <code>{}</code>。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> my map
my<span class="token operator">=</span><span class="token punctuation">{</span><span class="token string-property property">&quot;key1&quot;</span><span class="token operator">:</span> <span class="token string">&quot;value1&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">key2</span><span class="token operator">:</span> i<span class="token punctuation">,</span> <span class="token string-property property">&quot;key3&quot;</span><span class="token operator">:</span> $Name<span class="token punctuation">}</span>
<span class="token keyword">var</span> mya array
mya<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&quot;value1&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">key2</span><span class="token operator">:</span> i<span class="token punctuation">}</span><span class="token punctuation">,</span> $Name<span class="token punctuation">]</span>
</code></pre></div><p>您可以在表达式中使用这样的初始化。例如，在函数参数中使用。</p> <div class="language-js extra-class"><pre class="language-js"><code>DBFind<span class="token operator">...</span><span class="token function">Where</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>对于对象数组，您必须指定一个键。键用双引号（<code>&quot;&quot;</code>）指定字符串。如果键名仅限于字母，数字和下划线，则可以省略双引号。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span><span class="token literal-property property">key1</span><span class="token operator">:</span> <span class="token string">&quot;value1&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">key2</span><span class="token operator">:</span> <span class="token string">&quot;value2&quot;</span><span class="token punctuation">}</span>
</code></pre></div><p>数组可以包含字符串、数字、任何类型的变量名称和带 <code>$</code>符号的变量名称。支持嵌套数组，可以将不同的映射或数组指定为值。</p> <p>表达式不能用作数组元素，使用一个变量来存储表达式结果并指定这个变量为数组元素。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token function">myfunc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> name<span class="token punctuation">[</span><span class="token string">&quot;param&quot;</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token comment">// don't do this</span>
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3.4</span><span class="token punctuation">,</span> mystr<span class="token punctuation">,</span> <span class="token string">&quot;string&quot;</span><span class="token punctuation">,</span> $ext<span class="token punctuation">,</span> myarr<span class="token punctuation">,</span> mymap<span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token string-property property">&quot;ids&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span> i<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token literal-property property">company</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token string-property property">&quot;Name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;MyCompany&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token punctuation">]</span> <span class="token comment">// this is ok</span>

<span class="token keyword">var</span> val string
val <span class="token operator">=</span> my<span class="token punctuation">[</span><span class="token string">&quot;param&quot;</span><span class="token punctuation">]</span>
<span class="token function">MyFunc</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">key</span><span class="token operator">:</span> val<span class="token punctuation">,</span> <span class="token literal-property property">sub</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;My name&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;color&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Red&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="if-and-while-statements"><a href="#if-and-while-statements" class="header-anchor">#</a> If和While语句 </h3> <p>合约语言支持标准 <strong>if</strong> 条件语句和 <strong>while</strong>循环，可以在合约和函数中使用。这些语句可以相互嵌套。</p> <p><strong>if</strong> 和 <strong>while</strong> 关键字后必须跟条件语句。如果条件语句返回一个数字，则当其值为0，被视为<em>false</em>。</p> <p><em>val == 0</em> 等于 <em>!val</em>，<em>val != 0</em> 等于 <em>val</em>。<strong>if</strong> 语句可以有<strong>else</strong> 代码块，在 <strong>if</strong> 条件语句为 <em>false</em> 时执行 <strong>else</strong> 。</p> <p>以下比较运算符可用于条件语句：<code>&lt;, &gt;, &gt;=, &lt;=, ==, !=, ||, &amp;&amp;</code></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">if</span> val <span class="token operator">&gt;</span> <span class="token number">10</span> <span class="token operator">||</span> id <span class="token operator">!=</span> $block_key_id <span class="token punctuation">{</span>
    <span class="token operator">...</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>while</strong> 循环的条件语句为 <em>true</em> 时执行代码块。<strong>break</strong>表示结束代码块的循环，想要从头开始循环请使用 <strong>continue</strong>。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> i int
<span class="token keyword">while</span> <span class="token boolean">true</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> i <span class="token operator">&gt;</span> <span class="token number">100</span> <span class="token punctuation">{</span>
        <span class="token keyword">break</span>
    <span class="token punctuation">}</span>
    <span class="token operator">...</span>
    <span class="token keyword">if</span> i <span class="token operator">==</span> <span class="token number">50</span> <span class="token punctuation">{</span>
        <span class="token keyword">continue</span>
    <span class="token punctuation">}</span>
    <span class="token operator">...</span>
    i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span>
<span class="token punctuation">}</span>
</code></pre></div><p>除了条件语句外，needle 还支持标准的算术运算：<code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>。</p> <p><strong>string</strong> 和 <strong>bytes</strong>类型可以作为条件语句，如果类型长度大于零时，条件为 <em>true</em>，反之为 <em>false</em>。</p> <h3 id="functions"><a href="#functions" class="header-anchor">#</a> 函数 </h3> <p>函数可以对合约 <a href="#data-section">数据部分</a>接收的数据执行一些操作：读取和写入数据库的数据、转换值的类型以及建立合约之间的交互。</p> <h4 id="function-declaration"><a href="#function-declaration" class="header-anchor">#</a> 函数声明 </h4> <p>使用 <strong>func</strong>关键词声明一个函数，后面是函数名称和传递给它的参数列表及其参数类型，所有参数都用小括号括起来，用逗号分隔。在小括号之后，必须声明函数返回值的数据类型。函数体必须用大括号括起来。如果函数没有参数，那么大括号可以省略。使用<code>return</code> 关键字返回函数返回值。</p> <div class="language-js extra-class"><pre class="language-js"><code>func <span class="token function">myfunc</span><span class="token punctuation">(</span>left int<span class="token punctuation">,</span> right int<span class="token punctuation">)</span> int <span class="token punctuation">{</span>
    <span class="token keyword">return</span> left<span class="token operator">*</span>right <span class="token operator">+</span> left <span class="token operator">-</span> right
<span class="token punctuation">}</span>
func test int <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">myfunc</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">myfunc</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
func ooops <span class="token punctuation">{</span>
    error <span class="token string">&quot;Ooops...&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>函数不会返回错误，因为所有错误检查都是自动执行的。当在任何函数中出现错误时，合约将停止其操作并显示包含错误描述的窗口。</p> <h4 id="variable-length-parameters"><a href="#variable-length-parameters" class="header-anchor">#</a> 可变长度参数 </h4> <p>函数可以定义可变长度参数，使用 <code>...</code>符号作为函数的最后一个参数类型，表示可变长度参数，其数据类型为<code>array</code>。可变长度参数包含从调用传递该参数变量开始的所有变量。任何类型的变量都可以传递，但是您需要处理与数据类型不匹配的冲突。</p> <div class="language-js extra-class"><pre class="language-js"><code>func <span class="token function">sum</span><span class="token punctuation">(</span><span class="token parameter">out string<span class="token punctuation">,</span> values <span class="token operator">...</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> i<span class="token punctuation">,</span> res int

    <span class="token keyword">while</span> i <span class="token operator">&lt;</span> <span class="token function">Len</span><span class="token punctuation">(</span><span class="token parameter">values</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
       res <span class="token operator">=</span> res <span class="token operator">+</span> values<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
       i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span>
    <span class="token punctuation">}</span>
    <span class="token function">Println</span><span class="token punctuation">(</span>out<span class="token punctuation">,</span> res<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

func <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token function">sum</span><span class="token punctuation">(</span><span class="token string">&quot;Sum:&quot;</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="optional-parameters"><a href="#optional-parameters" class="header-anchor">#</a> 可选参数 </h4> <p>函数有很多参数，但在调用它时我们只需要其中某些参数。这样的情况下，您可以通过以下方式声明可选参数：<code>func myfunc(name string).Param1(param string).Param2(param2 int) {...}</code>，这样您就可以调用任意顺序指定的参数：<code>myfunc(&quot;name&quot;).Param2(100)</code>。</p> <p>在函数体中，您可以像正常处理这些变量。如果未调用指定的可选参数，它们默认为零值。您还可以使用<code>...</code>指定可变长度参数：<code>func DBFind(table string).Where(request string, params ...)</code>。然后调用它：<code>DBFind(&quot;mytable&quot;).Where({&quot;id&quot;: $myid, &quot;type&quot;: 2})</code>。</p> <div class="language-js extra-class"><pre class="language-js"><code>func <span class="token function">DBFind</span><span class="token punctuation">(</span>table string<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Columns</span><span class="token punctuation">(</span>columns string<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span>format string<span class="token punctuation">,</span> tail <span class="token operator">...</span><span class="token punctuation">)</span>
         <span class="token punctuation">.</span><span class="token function">Limit</span><span class="token punctuation">(</span>limit int<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Offset</span><span class="token punctuation">(</span>offset int<span class="token punctuation">)</span> string  <span class="token punctuation">{</span>
   <span class="token operator">...</span>
<span class="token punctuation">}</span>

func <span class="token function">names</span><span class="token punctuation">(</span><span class="token punctuation">)</span> string <span class="token punctuation">{</span>
   <span class="token operator">...</span>
   <span class="token keyword">return</span> <span class="token function">DBFind</span><span class="token punctuation">(</span><span class="token string">&quot;table&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Columns</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string-property property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Limit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="needle-functions-classification"><a href="#needle-functions-classification" class="header-anchor">#</a> needle 函数功能分类 </h2> <p>数据库检索值：</p> <table><thead><tr><th></th> <th></th> <th></th></tr></thead> <tbody><tr><td><a href="#appparam">AppParam</a></td> <td><a href="#ecosysparam">EcosysParam</a></td> <td><a href="#getdatafromxlsx">GetDataFromXLSX</a></td></tr> <tr><td><a href="#dbfind">DBFind</a></td> <td><a href="#gethistory">GetHistory</a></td> <td><a href="#getrowscountxlsx">GetRowsCountXLSX</a></td></tr> <tr><td><a href="#dbrow">DBRow</a></td> <td><a href="#gethistoryrow">GetHistoryRow</a></td> <td><a href="#getblock">GetBlock</a></td></tr> <tr><td><a href="#dbselectmetrics">DBSelectMetrics</a></td> <td><a href="#getcolumntype">GetColumnType</a></td> <td><a href="#langres">LangRes</a></td></tr></tbody></table> <p>更改数据表值：</p> <table><thead><tr><th></th> <th></th> <th></th></tr></thead> <tbody><tr><td><a href="#dbinsert">DBInsert</a></td> <td><a href="#dbupdateext">DBUpdateExt</a></td> <td><a href="#deltable">DelTable</a></td></tr> <tr><td><a href="#dbupdate">DBUpdate</a></td> <td><a href="#delcolumn">DelColumn</a></td> <td></td></tr></tbody></table> <p>数组操作：</p> <table><thead><tr><th></th> <th></th> <th></th></tr></thead> <tbody><tr><td><a href="#append">Append</a></td> <td><a href="#len">Len</a></td> <td><a href="#getmapkeys">GetMapKeys</a></td></tr> <tr><td><a href="#join">Join</a></td> <td><a href="#row">Row</a></td> <td><a href="#sortedkeys">SortedKeys</a></td></tr> <tr><td><a href="#split">Split</a></td> <td><a href="#one">One</a></td> <td></td></tr></tbody></table> <p>合约和权限操作：</p> <table><thead><tr><th></th> <th></th> <th></th></tr></thead> <tbody><tr><td><a href="#callcontract">CallContract</a></td> <td><a href="#getcontractbyid">GetContractById</a></td> <td><a href="#transactioninfo">TransactionInfo</a></td></tr> <tr><td><a href="#contractaccess">ContractAccess</a></td> <td><a href="#roleaccess">RoleAccess</a></td> <td><a href="#throw">Throw</a></td></tr> <tr><td><a href="#contractconditions">ContractConditions</a></td> <td><a href="#getcontractbyname">GetContractByName</a></td> <td><a href="#validatecondition">ValidateCondition</a></td></tr> <tr><td><a href="#evalcondition">EvalCondition</a></td> <td></td> <td></td></tr></tbody></table> <p>地址操作：</p> <table><thead><tr><th></th> <th></th> <th></th></tr></thead> <tbody><tr><td><a href="#addresstoid">AddressToId</a></td> <td><a href="#idtoaddress">IdToAddress</a></td> <td><a href="#pubtoid">PubToID</a></td></tr></tbody></table> <p>变量值操作：</p> <table><thead><tr><th></th> <th></th> <th></th></tr></thead> <tbody><tr><td><a href="#decodebase64">DecodeBase64</a></td> <td><a href="#formatmoney">FormatMoney</a></td> <td><a href="#hash">Hash</a></td></tr> <tr><td><a href="#encodebase64">EncodeBase64</a></td> <td><a href="#random">Random</a></td> <td><a href="#sha256">Sha256</a></td></tr> <tr><td><a href="#float">Float</a></td> <td><a href="#int">Int</a></td> <td><a href="#str">Str</a></td></tr> <tr><td><a href="#hextobytes">HexToBytes</a></td> <td></td> <td></td></tr></tbody></table> <p>算术运算：</p> <table><thead><tr><th></th> <th></th> <th></th></tr></thead> <tbody><tr><td><a href="#floor">Floor</a></td> <td><a href="#log10">Log10</a></td> <td><a href="#round">Round</a></td></tr> <tr><td><a href="#log">Log</a></td> <td><a href="#pow">Pow</a></td> <td><a href="#sqrt">Sqrt</a></td></tr></tbody></table> <p>JSON格式操作：</p> <table><thead><tr><th></th> <th></th> <th></th></tr></thead> <tbody><tr><td><a href="#jsonencode">JSONEncode</a></td> <td><a href="#jsonencodeindent">JSONEncodeIndent</a></td> <td><a href="#jsondecode">JSONDecode</a></td></tr></tbody></table> <p>字符串操作：</p> <table><thead><tr><th></th> <th></th> <th></th></tr></thead> <tbody><tr><td><a href="#hasprefix">HasPrefix</a></td> <td><a href="#size">Size</a></td> <td><a href="#tolower">ToLower</a></td></tr> <tr><td><a href="#contains">Contains</a></td> <td><a href="#sprintf">Sprintf</a></td> <td><a href="#toupper">ToUpper</a></td></tr> <tr><td><a href="#replace">Replace</a></td> <td><a href="#substr">Substr</a></td> <td><a href="#trimspace">TrimSpace</a></td></tr></tbody></table> <p>字节操作：</p> <table><thead><tr><th></th> <th></th> <th></th></tr></thead> <tbody><tr><td><a href="#stringtobytes">StringToBytes</a></td> <td><a href="#bytestostring">BytesToString</a></td> <td></td></tr></tbody></table> <p>SQL格式的日期和时间操作：</p> <table><thead><tr><th></th> <th></th> <th></th></tr></thead> <tbody><tr><td><a href="#blocktime">BlockTime</a></td> <td><a href="#datetime">DateTime</a></td> <td><a href="#unixdatetime">UnixDateTime</a></td></tr></tbody></table> <p>平台参数操作：</p> <table><thead><tr><th></th> <th></th> <th></th></tr></thead> <tbody><tr><td><a href="#sysparamstring">SysParamString</a></td> <td><a href="#sysparamint">SysParamInt</a></td> <td><a href="#dbupdatesysparam">DBUpdateSysParam</a></td></tr> <tr><td><a href="#updatenotifications">UpdateNotifications</a></td> <td><a href="#updaterolesnotifications">UpdateRolesNotifications</a></td> <td></td></tr></tbody></table> <p>CLB 模式函数操作：</p> <table><thead><tr><th></th> <th></th> <th></th></tr></thead> <tbody><tr><td><a href="#httprequest">HTTPRequest</a></td> <td><a href="#httppostjson">HTTPPostJSON</a></td> <td></td></tr></tbody></table> <p>主 CLB 节点函数操作：</p> <table><thead><tr><th></th> <th></th> <th></th></tr></thead> <tbody><tr><td><a href="#createobs">CreateOBS</a></td> <td><a href="#getobslist">GetOBSList</a></td> <td><a href="#runobs">RunOBS</a></td></tr> <tr><td><a href="#stopobs">StopOBS</a></td> <td><a href="#removeobs">RemoveOBS</a></td> <td></td></tr></tbody></table> <h2 id="needle-functions-reference"><a href="#needle-functions-reference" class="header-anchor">#</a> needle 函数参考 </h2> <h3 id="appparam"><a href="#appparam" class="header-anchor">#</a> AppParam </h3> <p>返回指定应用程序参数的值（来自应用程序参数表 <em>app_params</em>）。</p> <p><strong>语法</strong></p> <div class="language-text extra-class"><pre class="language-text"><code>AppParam(app int, name string, ecosystemid int) string
</code></pre></div><blockquote><p>app</p></blockquote> <div class="language- extra-class"><pre><code>应用程序ID。
</code></pre></div><blockquote><p>name</p></blockquote> <div class="language- extra-class"><pre><code>应用程序参数名称。
</code></pre></div><blockquote><p>ecosystemid</p></blockquote> <div class="language- extra-class"><pre><code>生态系统ID。
</code></pre></div><p><strong>示例</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">AppParam</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&quot;app_account&quot;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="dbfind"><a href="#dbfind" class="header-anchor">#</a> DBFind </h3> <p>根据指定参数从指定数据表中查询数据。返回一个由对象数组 <em>map</em> 组成的数组<em>array</em>。</p> <p><code>.Row()</code> 可获得请求记录的第一个 <em>map</em> 元素，<code>.One(column string)</code> 可获得请求记录中指定列的第一个 <em>map</em> 元素。</p> <p><strong>语法</strong></p> <div class="language-text extra-class"><pre class="language-text"><code>DBFind(table string)
    [.Columns(columns array|string)]
    [.Where(where map)]
    [.WhereId(id int)]
    [.Order(order string)]
    [.Limit(limit int)]
    [.Offset(offset int)]
    [.Row()]
    [.One(column string)]
    [.Ecosystem(ecosystemid int)] array
</code></pre></div><blockquote><p>table</p></blockquote> <div class="language- extra-class"><pre><code>数据表名称。
</code></pre></div><blockquote><p>сolumns</p></blockquote> <div class="language- extra-class"><pre><code>返回列的列表。如果未指定，则将返回所有列。
该值为数组或使用逗号分隔的字符串。
</code></pre></div><blockquote><p>where</p></blockquote> <div class="language- extra-class"><pre><code>查询条件。

示例： `.Where({name: &quot;John&quot;})` 或者 `.Where({&quot;id&quot;: {&quot;$gte&quot;: 4}})`。

此参数必须包含具有搜索条件的对象数组。该数组可以包含嵌套元素。

遵循句法结构如下：
</code></pre></div><ul><li><p><code>{&quot;field1&quot;: &quot;value1&quot;, &quot;field2&quot; : &quot;value2&quot;}</code></p> <blockquote><p>等价于 <code>field1 = &quot;value1&quot; AND field2 = &quot;value2&quot;</code>。</p></blockquote></li> <li><p><code>{&quot;field1&quot;: {&quot;$eq&quot;:&quot;value&quot;}}</code></p> <blockquote><p>等价于 <code>field = &quot;value&quot;</code>。</p></blockquote></li> <li><p><code>{&quot;field1&quot;: {&quot;$neq&quot;: &quot;value&quot;}}</code></p> <blockquote><p>等价于 <code>field != &quot;value&quot;</code>。</p></blockquote></li> <li><p><code>{&quot;field1: {&quot;$in&quot;: [1,2,3]}</code></p> <blockquote><p>等价于 <code>field IN (1,2,3)</code>。</p></blockquote></li> <li><p><code>{&quot;field1&quot;: {&quot;$nin&quot; : [1,2,3]}</code></p> <blockquote><p>等价于 <code>field NOT IN (1,2,3)</code>。</p></blockquote></li> <li><p><code>{&quot;field&quot;: {&quot;$lt&quot;: 12}}</code></p> <blockquote><p>等价于 <code>field &lt; 12</code>。</p></blockquote></li> <li><p><code>{&quot;field&quot;: {&quot;$lte&quot;: 12}}</code></p> <blockquote><p>等价于 <code>field &lt;= 12</code>。</p></blockquote></li> <li><p><code>{&quot;field&quot;: {&quot;$gt&quot;: 12}}</code></p> <blockquote><p>等价于 <code>field &gt; 12</code>。</p></blockquote></li> <li><p><code>{&quot;field&quot;: {&quot;$gte&quot;: 12}}</code></p> <blockquote><p>等价于 <code>field &gt;= 12</code>。</p></blockquote></li> <li><p><code>{&quot;$and&quot;: [&lt;expr1&gt;, &lt;expr2&gt;, &lt;expr3&gt;]}</code></p> <blockquote><p>等价于 <code>expr1 AND expr2 AND expr3</code>。</p></blockquote></li> <li><p><code>{&quot;$or&quot;: [&lt;expr1&gt;, &lt;expr2&gt;, &lt;expr3&gt;]}</code></p> <blockquote><p>等价于 <code>expr1 OR expr2 OR expr3</code>。</p></blockquote></li> <li><p><code>{field: {&quot;$like&quot;: &quot;value&quot;}}</code></p> <blockquote><p>等价于 <code>field like '%value%'</code> (模糊搜索)。</p></blockquote></li> <li><p><code>{field: {&quot;$begin&quot;: &quot;value&quot;}}</code></p> <blockquote><p>等价于 <code>field like 'value%'</code> (以 <code>value</code> 开头)。</p></blockquote></li> <li><p><code>{field: {&quot;$end&quot;: &quot;value&quot;}}</code></p> <blockquote><p>等价于 <code>field like '%value'</code> (以 <code>value</code> 结尾)。</p></blockquote></li> <li><p><code>{field: &quot;$isnull&quot;}</code></p> <blockquote><p>等价于 <code>field is null</code>。</p></blockquote></li></ul> <p>请确保不要覆盖对象数组的键。例如，如果想用 <code>id&gt;2 and id&lt;5</code>语句查询，不能使用<code>{id:{&quot;$gt&quot;: 2}, id:{&quot;$lt&quot;: 5}}</code>，因为第一个元素会被第二个元素覆盖。应该使用如下结构查询：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span><span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token string-property property">&quot;$gt&quot;</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token string-property property">&quot;$lt&quot;</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span><span class="token string-property property">&quot;$and&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token literal-property property">id</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token string-property property">&quot;$gt&quot;</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">id</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token string-property property">&quot;$lt&quot;</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
</code></pre></div><blockquote><p>id</p></blockquote> <div class="language- extra-class"><pre><code>根据ID查询。例如，`.WhereId(1)`。
</code></pre></div><blockquote><p>order</p></blockquote> <div class="language- extra-class"><pre><code>用于根据指定的列对结果集进行排序。默认按照 *id* 排序。
如果仅用一个字段进行排序，则可以将其指定为字符串。多个字段排序需要指定一个字符串对象数组：
</code></pre></div><p>降序： <code>{&quot;field&quot;: &quot;-1&quot;}</code> 等价于 <code>field desc</code>。</p> <p>升序： <code>{&quot;field&quot;: &quot;1&quot;}</code> 等价于 <code>field asc</code>。</p> <blockquote><p>limit</p></blockquote> <div class="language- extra-class"><pre><code>返回条目数。默认25条，最大10000条。
</code></pre></div><blockquote><p>offset</p></blockquote> <div class="language- extra-class"><pre><code>偏移量。
</code></pre></div><blockquote><p>ecosystemid</p></blockquote> <div class="language- extra-class"><pre><code>生态系统ID。默认为查询当前生态系统的数据表。
</code></pre></div><p><strong>示例</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> i int
<span class="token keyword">var</span> ret string

ret <span class="token operator">=</span> <span class="token function">DBFind</span><span class="token punctuation">(</span><span class="token string">&quot;contracts&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Columns</span><span class="token punctuation">(</span><span class="token string">&quot;id,value&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token string-property property">&quot;$gt&quot;</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token string-property property">&quot;$lt&quot;</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Order</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">while</span> i <span class="token operator">&lt;</span> <span class="token function">Len</span><span class="token punctuation">(</span><span class="token parameter">ret</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> vals map
    vals <span class="token operator">=</span> ret<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    <span class="token function">Println</span><span class="token punctuation">(</span>vals<span class="token punctuation">[</span><span class="token string">&quot;value&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span>
<span class="token punctuation">}</span>
ret <span class="token operator">=</span> <span class="token function">DBFind</span><span class="token punctuation">(</span><span class="token string">&quot;contracts&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Columns</span><span class="token punctuation">(</span><span class="token string">&quot;id,value&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">WhereId</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">One</span><span class="token punctuation">(</span><span class="token string">&quot;value&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> ret <span class="token operator">!=</span> nil <span class="token punctuation">{</span>
 <span class="token function">Println</span><span class="token punctuation">(</span>ret<span class="token punctuation">)</span>
 <span class="token function">Println</span><span class="token punctuation">(</span>ret<span class="token punctuation">)</span> 
 <span class="token function">Println</span><span class="token punctuation">(</span>ret<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="dbrow"><a href="#dbrow" class="header-anchor">#</a> DBRow </h3> <p>根据指定参数从指定数据表中查询数据。返回一个由对象数组 <em>map</em> 组成的数组<em>array</em>。</p> <p><strong>语法</strong></p> <div class="language-text extra-class"><pre class="language-text"><code>DBRow(table string)
    [.Columns(columns array|string)]
    [.Where(where map)]
    [.WhereId(id int)]
    [.Order(order array|string)]
    [.Ecosystem(ecosystemid int)] map
</code></pre></div><ul><li><p>table</p> <p>数据表名称。</p></li> <li><p>columns</p> <p>返回列的列表。如果未指定，则将返回所有列。</p> <p>该值为数组或使用逗号分隔的字符串。</p></li> <li><p>where</p> <p>查询条件。</p> <p>例如： <code>.Where({name: &quot;John&quot;})</code> 或者 <code>.Where({&quot;id&quot;: {&quot;$gte&quot;: 4}})</code>。</p> <p>更多详细信息，请参考<a href="/zh-CN/topics/templates2.html#dbfind">DBFind</a> 。</p></li> <li><p>id</p> <p>根据ID查询。例如，<code>.WhereId(1)</code>。</p></li> <li><p>order</p> <p>用于根据指定的列对结果集进行排序。默认按照 <em>id</em> 排序。</p> <p>更多详细信息，请参考<a href="/zh-CN/topics/templates2.html#dbfind">DBFind</a> 。</p></li> <li><p>ecosystemid</p> <p>生态系统ID。默认为查询当前生态系统的数据表。</p></li></ul> <p><strong>示例</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> ret map
ret <span class="token operator">=</span> <span class="token function">DBRow</span><span class="token punctuation">(</span><span class="token string">&quot;contracts&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Columns</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;value&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token function">Println</span><span class="token punctuation">(</span>ret<span class="token punctuation">)</span>
</code></pre></div><h3 id="dbselectmetrics"><a href="#dbselectmetrics" class="header-anchor">#</a> DBSelectMetrics </h3> <p>返回指标的聚合数据。</p> <p>每生成100个区块时都会更新指标标准。以1天为周期存储聚合数据。</p> <p><strong>语法</strong></p> <div class="language-text extra-class"><pre class="language-text"><code>DBSelectMetrics(metric string, timeInterval string, aggregateFunc string) array
</code></pre></div><ul><li><p>metric</p> <p>指标名称。</p></li> <li><p>ecosystem_pages</p> <p>生态系统页面数。</p> <p>返回值: <em>key</em> - 生态系统ID， <em>value</em> - 生态系统页面数。</p></li> <li><p>ecosystem_members</p> <p>生态系统成员数。</p> <p>返回值: <em>key</em> - 生态系统ID， <em>value</em> - 生态系统成员数。</p></li> <li><p>ecosystem_tx</p> <p>生态系统交易数。</p> <p>返回值: <em>key</em> - 生态系统ID， <em>value</em> - 生态系统交易数。</p></li> <li><p>timeInterval</p> <p>聚合指标数据的时间间隔。例如：<code>1 day</code>， <code>30 days</code>。</p></li> <li><p>aggregateFunc</p> <p>聚合函数。例如 <code>max</code>, <code>min</code>, <code>avg</code>。</p></li></ul> <p><strong>示例</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> rows array
rows <span class="token operator">=</span> <span class="token function">DBSelectMetrics</span><span class="token punctuation">(</span><span class="token string">&quot;ecosystem_tx&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;30 days&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;avg&quot;</span><span class="token punctuation">)</span>

<span class="token keyword">var</span> i int
<span class="token keyword">while</span><span class="token punctuation">(</span>i <span class="token operator">&lt;</span> <span class="token function">Len</span><span class="token punctuation">(</span>rows<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">var</span> row map
   row <span class="token operator">=</span> rows<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
   i <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="ecosysparam"><a href="#ecosysparam" class="header-anchor">#</a> EcosysParam </h3> <p>返回生态系统参数表 <em>parameters</em> 指定参数的值。</p> <p><strong>语法</strong></p> <div class="language-text extra-class"><pre class="language-text"><code>EcosysParam(name string) string
</code></pre></div><ul><li><p>name</p> <p>参数名称。</p></li></ul> <p><strong>示例</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">Println</span><span class="token punctuation">(</span><span class="token function">EcosysParam</span><span class="token punctuation">(</span><span class="token string">&quot;founder_account&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="gethistory"><a href="#gethistory" class="header-anchor">#</a> GetHistory </h3> <p>返回指定数据表中条目更改的历史记录。</p> <p><strong>语法</strong></p> <div class="language-text extra-class"><pre class="language-text"><code>GetHistory(table string, id int) array
</code></pre></div><ul><li><p>table</p> <p>数据表名称。</p></li> <li><p>id</p> <p>条目ID。</p></li></ul> <p><strong>返回值</strong></p> <p>返回 <em>map</em> 类型的对象数组。这些数组指定数据表中条目更改的历史记录。</p> <p>每个数组都包含下一次更改之前的记录字段。</p> <p>数组按从最近更改顺序排序。</p> <p>数组中 <em>id</em> 字段指向 <em>rollback_tx</em> 表的 <em>id</em>。<em>block_id</em>代表区块ID，<em>block_time</em> 代表区块生成时间戳。</p> <p><strong>示例</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> list array
<span class="token keyword">var</span> item map
list <span class="token operator">=</span> <span class="token function">GetHistory</span><span class="token punctuation">(</span><span class="token string">&quot;blocks&quot;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> <span class="token function">Len</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token punctuation">{</span>
   item <span class="token operator">=</span> list<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="gethistoryrow"><a href="#gethistoryrow" class="header-anchor">#</a> GetHistoryRow </h3> <p>从指定数据表中指定条目的更改历史记录返回单个快照。</p> <p><strong>语法</strong></p> <div class="language-text extra-class"><pre class="language-text"><code>GetHistoryRow(table string, id int, rollbackId int) map
</code></pre></div><ul><li><p>table</p> <p>数据表名称。</p></li> <li><p>id</p> <p>条目ID。</p></li> <li><p>rollbackId</p> <p><em>rollback_tx</em> 表的条目ID。</p></li></ul> <div class="language-js extra-class"><pre class="language-js"><code>$result <span class="token operator">=</span> <span class="token function">GetHistoryRow</span><span class="token punctuation">(</span><span class="token string">&quot;contracts&quot;</span><span class="token punctuation">,</span><span class="token number">205</span><span class="token punctuation">,</span><span class="token number">2358</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="getcolumntype"><a href="#getcolumntype" class="header-anchor">#</a> GetColumnType </h3> <p>返回指定表中指定字段的数据类型。</p> <p><strong>语法</strong></p> <div class="language-text extra-class"><pre class="language-text"><code>GetColumnType(table, column string) string
</code></pre></div><ul><li><p>table</p> <p>数据表名称。</p></li> <li><p>column</p> <p>字段名称。</p></li></ul> <p><strong>返回值</strong></p> <p>返回以下类型: <code>text, varchar, number, money, double, bytes, json, datetime, double</code>。</p> <p><strong>示例</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> coltype string
coltype <span class="token operator">=</span> <span class="token function">GetColumnType</span><span class="token punctuation">(</span><span class="token string">&quot;members&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;member_name&quot;</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="getdatafromxlsx"><a href="#getdatafromxlsx" class="header-anchor">#</a> GetDataFromXLSX </h3> <p>从 <em>XLSX</em> 电子表格返回数据。</p> <p><strong>语法</strong></p> <div class="language-text extra-class"><pre class="language-text"><code>GetDataFromXLSX(binId int, line int, count int, sheet int) string
</code></pre></div><ul><li><p>binId</p> <p>二进制表 <em>binary</em> 中XLSX格式的ID。</p></li> <li><p>line</p> <p>开始行数，默认从0开始。</p></li> <li><p>count</p> <p>需要返回的行数。</p></li> <li><p>sheet</p> <p>列表编号，默认从1开始。</p></li></ul> <p><strong>示例</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> a array
a <span class="token operator">=</span> <span class="token function">GetDataFromXLSX</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="getrowscountxlsx"><a href="#getrowscountxlsx" class="header-anchor">#</a> GetRowsCountXLSX </h3> <p>返回指定XLSX文件行数。</p> <p><strong>语法</strong></p> <div class="language-text extra-class"><pre class="language-text"><code>GetRowsCountXLSX(binId int, sheet int) int
</code></pre></div><ul><li><p>binId</p> <p>二进制表 <em>binary</em> 中XLSX格式的ID。</p></li> <li><p>sheet</p> <p>列表编号，默认从1开始。</p></li></ul> <p><strong>示例</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> count int
count <span class="token operator">=</span> <span class="token function">GetRowsCountXLSX</span><span class="token punctuation">(</span>binid<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="langres"><a href="#langres" class="header-anchor">#</a> LangRes </h3> <p>返回指定多语言资源。其标签 <em>lang</em>为双字符语言代码，例如：<code>en, zh</code>。如果所选的语言标签没有语言资源，则返回<code>en</code> 标签的语言资源。</p> <p><strong>语法</strong></p> <div class="language-text extra-class"><pre class="language-text"><code>LangRes(label string, lang string) string
</code></pre></div><ul><li><p>label</p> <p>语言资源名称。</p></li> <li><p>lang</p> <p>双字符语言代码。</p></li></ul> <p><strong>示例</strong></p> <div class="language-js extra-class"><pre class="language-js"><code>warning <span class="token function">LangRes</span><span class="token punctuation">(</span><span class="token string">&quot;@1confirm&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;en&quot;</span><span class="token punctuation">)</span>
error <span class="token function">LangRes</span><span class="token punctuation">(</span><span class="token string">&quot;@1problems&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;zh&quot;</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="getblock"><a href="#getblock" class="header-anchor">#</a> GetBlock </h3> <p>返回指定区块的相关信息。</p> <p><strong>语法</strong></p> <div class="language-text extra-class"><pre class="language-text"><code>GetBlock(blockID int64) map
</code></pre></div><ul><li><p>blockID</p> <p>区块ID。</p></li></ul> <p><strong>返回值</strong></p> <p>返回一个对象数组：</p> <ul><li><p><em>id</em></p> <blockquote><p>区块ID。</p></blockquote></li> <li><p><em>time</em></p> <blockquote><p>区块生成时间戳。</p></blockquote></li> <li><p><em>key_id</em></p> <blockquote><p>生成该区块的验证节点账户地址。</p></blockquote></li></ul> <p><strong>示例</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> b map
b <span class="token operator">=</span> <span class="token function">GetBlock</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token function">Println</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span>
</code></pre></div><h3 id="dbinsert"><a href="#dbinsert" class="header-anchor">#</a> DBInsert </h3> <p>添加条目到指定数据表并返回条目的ID。</p> <p><strong>语法</strong></p> <div class="language-text extra-class"><pre class="language-text"><code>DBInsert(table string, params map) int
</code></pre></div><ul><li><p>tblname</p> <p>数据表名称。</p></li> <li><p>params</p> <p>对象数组，其中键是字段名称，值是插入的值。</p></li></ul> <p><strong>示例</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">DBInsert</span><span class="token punctuation">(</span><span class="token string">&quot;mytable&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;John Smith&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">amount</span><span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="dbupdate"><a href="#dbupdate" class="header-anchor">#</a> DBUpdate </h3> <p>更改指定数据表中指定条目ID的列值，如果该表中不存在该条目ID，则返回错误。</p> <p><strong>语法</strong></p> <div class="language-text extra-class"><pre class="language-text"><code>DBUpdate(tblname string, id int, params map)
</code></pre></div><ul><li><p>tblname</p> <p>数据表名称。</p></li> <li><p>id</p> <p>条目ID。</p></li> <li><p>params</p> <p>对象数组，其中键是字段名称，值是更改的新值。</p></li></ul> <p><strong>示例</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">DBUpdate</span><span class="token punctuation">(</span><span class="token string">&quot;mytable&quot;</span><span class="token punctuation">,</span> myid<span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;John Smith&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">amount</span><span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="dbupdateext"><a href="#dbupdateext" class="header-anchor">#</a> DBUpdateExt </h3> <p>更改指定数据表中与查询条件的匹配的列值。</p> <p><strong>语法</strong></p> <div class="language-text extra-class"><pre class="language-text"><code>DBUpdateExt(tblname string, where map, params map)
</code></pre></div><ul><li><p>tblname</p> <p>数据表名称。</p></li> <li><p>where</p> <p>查询条件。</p></li></ul> <p>更多详细信息，请参考 <a href="/zh-CN/topics/templates2.html#dbfind">DBFind</a> 。</p> <ul><li><p>params</p> <p>对象数组，其中键是字段名称，值是更改的新值。</p></li></ul> <p><strong>示例</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">DBUpdateExt</span><span class="token punctuation">(</span><span class="token string">&quot;mytable&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">id</span><span class="token operator">:</span> $key_id<span class="token punctuation">,</span> <span class="token literal-property property">ecosystem</span><span class="token operator">:</span> $ecosystem_id<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;John Smith&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">amount</span><span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="delcolumn"><a href="#delcolumn" class="header-anchor">#</a> DelColumn </h3> <p>删除指定表中的字段。该表必须没有记录。</p> <p><strong>语法</strong></p> <div class="language-text extra-class"><pre class="language-text"><code>DelColumn(tblname string, column string)
</code></pre></div><ul><li><p>tblname</p> <p>数据表名称。</p></li> <li><p>column</p> <p>需要删除的字段。</p></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">DelColumn</span><span class="token punctuation">(</span><span class="token string">&quot;mytable&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;mycolumn&quot;</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="deltable"><a href="#deltable" class="header-anchor">#</a> DelTable </h3> <p>删除指定的数据表。该表必须没有记录。</p> <p><strong>语法</strong></p> <div class="language-text extra-class"><pre class="language-text"><code>DelTable(tblname string)
</code></pre></div><ul><li><p>tblname</p> <p>数据表名称。</p></li></ul> <p><strong>示例</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">DelTable</span><span class="token punctuation">(</span><span class="token string">&quot;mytable&quot;</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="append"><a href="#append" class="header-anchor">#</a> Append </h3> <p>将任何类型的 <em>val</em> 插入到 <em>src</em> 数组中。</p> <p><strong>语法</strong></p> <div class="language-text extra-class"><pre class="language-text"><code>Append(src array, val anyType) array
</code></pre></div><ul><li><p>src</p> <p>原始数组。</p></li> <li><p>val</p> <p>需要插入的值。</p></li></ul> <p><strong>示例</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> list array
list <span class="token operator">=</span> <span class="token function">Append</span><span class="token punctuation">(</span>list<span class="token punctuation">,</span> <span class="token string">&quot;new_val&quot;</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="join"><a href="#join" class="header-anchor">#</a> Join </h3> <p>将 <em>in</em> 数组的元素合并到具有指定 <em>sep</em> 分隔符的字符串中。</p> <p><strong>语法</strong></p> <div class="language-text extra-class"><pre class="language-text"><code>Join(in array, sep string) string
</code></pre></div><ul><li><p>in</p> <p>数组名称。</p></li> <li><p>sep</p> <p>分隔符。</p></li></ul> <p><strong>示例</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> val string<span class="token punctuation">,</span> myarr array
myarr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;first&quot;</span>
myarr<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">10</span>
val <span class="token operator">=</span> <span class="token function">Join</span><span class="token punctuation">(</span>myarr<span class="token punctuation">,</span> <span class="token string">&quot;,&quot;</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="split"><a href="#split" class="header-anchor">#</a> Split </h3> <p>使用 <em>sep</em> 分隔符将 <em>in</em> 字符串拆分为元素，并将它们放入数组中。</p> <p><strong>语法</strong></p> <div class="language-text extra-class"><pre class="language-text"><code>Split(in string, sep string) array
</code></pre></div><ul><li><p>in</p> <p>字符串。</p></li> <li><p>sep</p> <p>分隔符。</p></li></ul> <p><strong>示例</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> myarr array
myarr <span class="token operator">=</span> <span class="token function">Split</span><span class="token punctuation">(</span><span class="token string">&quot;first,second,third&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;,&quot;</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="len"><a href="#len" class="header-anchor">#</a> Len </h3> <p>返回指定数组元素个数。</p> <p><strong>语法</strong></p> <div class="language-text extra-class"><pre class="language-text"><code>Len(val array) int
</code></pre></div><ul><li><p>val</p> <p>数组。</p></li></ul> <p><strong>示例</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">if</span> <span class="token function">Len</span><span class="token punctuation">(</span>mylist<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="row"><a href="#row" class="header-anchor">#</a> Row </h3> <p>The <em>list</em> parameter must not be specified in this case. 返回数组列表的第一个对象数组。如果列表为空，则返回结果为空。该函数主要与<a href="/zh-CN/topics/templates2.html#dbfind">DBFind</a>函数一起使用，使用时该函数不能指定参数。</p> <p><strong>语法</strong></p> <div class="language-text extra-class"><pre class="language-text"><code>Row(list array) map
</code></pre></div><ul><li><p>list</p> <p>由 <strong>DBFind</strong> 函数返回的对象数组。</p></li></ul> <p><strong>示例</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> ret map
ret <span class="token operator">=</span> <span class="token function">DBFind</span><span class="token punctuation">(</span><span class="token string">&quot;contracts&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Columns</span><span class="token punctuation">(</span><span class="token string">&quot;id,value&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">WhereId</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Row</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">Println</span><span class="token punctuation">(</span>ret<span class="token punctuation">)</span>
</code></pre></div><h3 id="one"><a href="#one" class="header-anchor">#</a> One </h3> <p>返回数组列表中第一个对象数组的字段值。如果列表数组为空，则返回nil。该函数主要与<a href="/zh-CN/topics/templates2.html#dbfind">DBFind</a>函数一起使用，使用时该函数不能指定参数。</p> <p><strong>语法</strong></p> <div class="language-text extra-class"><pre class="language-text"><code>One(list array, column string) string
</code></pre></div><ul><li><p>list</p> <ul><li>由 <strong>DBFind</strong> 函数返回的对象数组。</li></ul></li> <li><p>column</p> <ul><li>字段名称。</li></ul></li></ul> <p><strong>示例</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> ret string
ret <span class="token operator">=</span> <span class="token function">DBFind</span><span class="token punctuation">(</span><span class="token string">&quot;contracts&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Columns</span><span class="token punctuation">(</span><span class="token string">&quot;id,value&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">WhereId</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">One</span><span class="token punctuation">(</span><span class="token string">&quot;value&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> ret <span class="token operator">!=</span> nil <span class="token punctuation">{</span>
   <span class="token function">Println</span><span class="token punctuation">(</span>ret<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="getmapkeys"><a href="#getmapkeys" class="header-anchor">#</a> GetMapKeys </h3> <p>返回对象数组中的键数组。</p> <p><strong>语法</strong></p> <div class="language-text extra-class"><pre class="language-text"><code>GetMapKeys(val map) array
</code></pre></div><ul><li><p>val</p> <p>对象数组。</p></li></ul> <p><strong>示例</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> val map
<span class="token keyword">var</span> arr array
val<span class="token punctuation">[</span><span class="token string">&quot;k1&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;v1&quot;</span>
val<span class="token punctuation">[</span><span class="token string">&quot;k2&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;v2&quot;</span>
arr <span class="token operator">=</span> <span class="token function">GetMapKeys</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span>
</code></pre></div><h3 id="sortedkeys"><a href="#sortedkeys" class="header-anchor">#</a> SortedKeys </h3> <p>返回对象数组中的键数组，该数组已排序。</p> <p><strong>语法</strong></p> <div class="language-text extra-class"><pre class="language-text"><code>SortedKeys(val map) array
</code></pre></div><ul><li><p>val</p> <p>对象数组。</p></li></ul> <p><strong>示例</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> val map
<span class="token keyword">var</span> arr array
val<span class="token punctuation">[</span><span class="token string">&quot;k2&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;v2&quot;</span>
val<span class="token punctuation">[</span><span class="token string">&quot;k1&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;v1&quot;</span>
arr <span class="token operator">=</span> <span class="token function">SortedKeys</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span>
</code></pre></div><h3 id="callcontract"><a href="#callcontract" class="header-anchor">#</a> CallContract </h3> <p>调用指定名称的合约。合约数据部分的所有参数必须列入一个对象数组中。该函数返回指定合约分配给**$result** 变量的值。</p> <p><strong>语法</strong></p> <div class="language-text extra-class"><pre class="language-text"><code>CallContract(name string, params map)
</code></pre></div><ul><li><p>name</p> <p>被调用合同的名称。</p></li> <li><p>params</p> <p>合约输入数据的关联数组。</p></li></ul> <p><strong>示例</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> par map
par<span class="token punctuation">[</span><span class="token string">&quot;Name&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;My Name&quot;</span>
<span class="token function">CallContract</span><span class="token punctuation">(</span><span class="token string">&quot;MyContract&quot;</span><span class="token punctuation">,</span> par<span class="token punctuation">)</span>
</code></pre></div><h3 id="contractaccess"><a href="#contractaccess" class="header-anchor">#</a> ContractAccess </h3> <p>检查执行合约的名称是否与参数中列出的名称之一匹配。通常用于控制合约对数据表访问。编辑数据表字段或在表权限部分的插入和新列字段时，在权限字段中指定该函数。</p> <p><strong>语法</strong></p> <div class="language-text extra-class"><pre class="language-text"><code>ContractAccess(name string, [name string]) bool
</code></pre></div><ul><li><p>name</p> <p>合约名称。</p></li></ul> <p><strong>示例</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">ContractAccess</span><span class="token punctuation">(</span><span class="token string">&quot;MyContract&quot;</span><span class="token punctuation">)</span>
<span class="token function">ContractAccess</span><span class="token punctuation">(</span><span class="token string">&quot;MyContract&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;SimpleContract&quot;</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="contractconditions"><a href="#contractconditions" class="header-anchor">#</a> ContractConditions </h3> <p>从指定名称的合约中调用 <strong>conditions</strong> 条件部分。</p> <p>对于该类的合约，数据部分必须为空。如果条件部分执行没有错误，则返回<em>true</em>。如果在执行期间生成错误，则父合约也将以此错误结束。该函数通常用于控制合约对表的访问，并且可以在编辑系统表时在权限字段中调用。</p> <p><strong>语法</strong></p> <div class="language-text extra-class"><pre class="language-text"><code>ContractConditions(name string, [name string]) bool
</code></pre></div><ul><li><p>name</p> <p>合约名称。</p></li></ul> <p><strong>示例</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">ContractConditions</span><span class="token punctuation">(</span><span class="token string">&quot;MainCondition&quot;</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="evalcondition"><a href="#evalcondition" class="header-anchor">#</a> EvalCondition </h3> <p>从 <em>tablename</em> 表中获取带有 <em>'name'</em> 字段记录中的 <em>condfield</em>字段的值，并检查 <em>condfield</em> 字段值的条件。</p> <p><strong>语法</strong></p> <div class="language-text extra-class"><pre class="language-text"><code>EvalCondition(tablename string, name string, condfield string)
</code></pre></div><ul><li><p>tablename</p> <p>数据表名称。</p></li> <li><p>name</p> <p>根据 'name' 字段查询值。</p></li> <li><p>condfield</p> <p>需要检查条件的字段名称。</p></li></ul> <p><strong>示例</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">EvalCondition</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">menu</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> $Name<span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">conditions</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
</code></pre></div><h3 id="getcontractbyid"><a href="#getcontractbyid" class="header-anchor">#</a> GetContractById </h3> <p>该函数通过合约ID返回其合约名称。如果找不到合约，则返回空字符串。</p> <p><strong>语法</strong></p> <div class="language-text extra-class"><pre class="language-text"><code>GetContractById(id int) string
</code></pre></div><ul><li><p>id</p> <p>在合约表 <em>contracts</em> 的合约ID。</p></li></ul> <p><strong>示例</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> name string
name <span class="token operator">=</span> <span class="token function">GetContractById</span><span class="token punctuation">(</span>$IdContract<span class="token punctuation">)</span>
</code></pre></div><h3 id="getcontractbyname"><a href="#getcontractbyname" class="header-anchor">#</a> GetContractByName </h3> <p>该函数通过合约名称返回其合约ID。如果找不到合约，则返回零。</p> <p><strong>语法</strong></p> <div class="language-text extra-class"><pre class="language-text"><code>GetContractByName(name string) int
</code></pre></div><ul><li><p>name</p> <p>在合约表 <em>contracts</em> 的合约名称。</p></li></ul> <p><strong>示例</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> id int
id <span class="token operator">=</span> <span class="token function">GetContractByName</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">NewBlock</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
</code></pre></div><h3 id="roleaccess"><a href="#roleaccess" class="header-anchor">#</a> RoleAccess </h3> <p>检查合约调用者的角色ID是否与参数中指定的ID之一匹配。</p> <p>使用该函数可以控制对数据表和其他数据的合约访问。</p> <p><strong>语法</strong></p> <div class="language-text extra-class"><pre class="language-text"><code>RoleAccess(id int, [id int]) bool
</code></pre></div><ul><li><p>id</p> <p>角色ID。</p></li></ul> <p><strong>示例</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">RoleAccess</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token function">RoleAccess</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="transactioninfo"><a href="#transactioninfo" class="header-anchor">#</a> TransactionInfo </h3> <p>按指定的哈希值查询交易并返回已执行的合约及其参数的信息。</p> <p><strong>语法</strong></p> <div class="language-text extra-class"><pre class="language-text"><code>TransactionInfo(hash: string)
</code></pre></div><ul><li><p>hash</p> <p>十六进制字符串格式的交易哈希。</p></li></ul> <p><strong>返回值</strong></p> <p>该函数返回json格式的字符串：</p> <blockquote><div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span><span class="token property">&quot;contract&quot;</span><span class="token operator">:</span><span class="token string">&quot;ContractName&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;params&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;val&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token property">&quot;block&quot;</span><span class="token operator">:</span> <span class="token string">&quot;N&quot;</span><span class="token punctuation">}</span>
</code></pre></div></blockquote> <ul><li><p>contract</p> <p>合约名称。</p></li> <li><p>params</p> <p>传递给合约参数的数据。</p></li> <li><p>block</p> <p>处理该交易的区块ID。</p></li></ul> <p><strong>示例</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> out map
out <span class="token operator">=</span> <span class="token function">JSONDecode</span><span class="token punctuation">(</span><span class="token function">TransactionInfo</span><span class="token punctuation">(</span>hash<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="throw"><a href="#throw" class="header-anchor">#</a> Throw </h3> <p>生成 <em>exception</em> 异常类型的错误。</p> <p><strong>语法</strong></p> <div class="language-text extra-class"><pre class="language-text"><code>Throw(ErrorId string, ErrDescription string)
</code></pre></div><ul><li><p>ErrorId</p> <p>错误标识符。</p></li> <li><p>ErrDescription</p> <p>错误描述。</p></li></ul> <p><strong>返回值</strong></p> <p>该类交易结果的格式：</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span><span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token string">&quot;exception&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;error&quot;</span><span class="token operator">:</span><span class="token string">&quot;Error description&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;id&quot;</span><span class="token operator">:</span><span class="token string">&quot;Error ID&quot;</span><span class="token punctuation">}</span>
</code></pre></div><p><strong>示例</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">Throw</span><span class="token punctuation">(</span><span class="token string">&quot;Problem&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;There is a problem&quot;</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="validatecondition"><a href="#validatecondition" class="header-anchor">#</a> ValidateCondition </h3> <p>尝试编译 <em>condition</em>参数指定的条件。如果在编译过程中发生错误，则生成错误并终止调用合约。该函数旨在检查条件格式的正确性。</p> <p><strong>语法</strong></p> <div class="language-text extra-class"><pre class="language-text"><code>ValidateCondition(condition string, state int)
</code></pre></div><ul><li><p>condition</p> <p>需要验证的条件格式。</p></li> <li><p>state</p> <p>生态系统ID。如果检查全局条件，请指定为0。</p></li></ul> <p><strong>示例</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">ValidateCondition</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">ContractAccess(&quot;@1MyContract&quot;)</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="addresstoid"><a href="#addresstoid" class="header-anchor">#</a> AddressToId </h3> <p>根据钱包地址返回对应的账户地址。如果指定了无效的地址，则返回 '0'。</p> <p><strong>语法</strong></p> <div class="language-text extra-class"><pre class="language-text"><code>AddressToId(address string) int
</code></pre></div><ul><li><p>address</p> <p>钱包地址 <code>XXXX-...-XXXX</code> 格式或数字形式。</p></li></ul> <p><strong>示例</strong></p> <div class="language-js extra-class"><pre class="language-js"><code>wallet <span class="token operator">=</span> <span class="token function">AddressToId</span><span class="token punctuation">(</span>$Recipient<span class="token punctuation">)</span>
</code></pre></div><h3 id="idtoaddress"><a href="#idtoaddress" class="header-anchor">#</a> IdToAddress </h3> <p>根据账户地址返回对应的钱包地址。如果指定了无效的地址，则返回无效地址'invalid'。</p> <p><strong>语法</strong></p> <div class="language-text extra-class"><pre class="language-text"><code>IdToAddress(id int) string
</code></pre></div><ul><li><p>id</p> <p>账户地址。</p></li></ul> <p><strong>示例</strong></p> <div class="language-js extra-class"><pre class="language-js"><code>$address <span class="token operator">=</span> <span class="token function">IdToAddress</span><span class="token punctuation">(</span>$id<span class="token punctuation">)</span>
</code></pre></div><h3 id="pubtoid"><a href="#pubtoid" class="header-anchor">#</a> PubToID </h3> <p>通过十六进制编码格式的公钥返回帐户地址。</p> <p><strong>语法</strong></p> <div class="language-text extra-class"><pre class="language-text"><code>PubToID(hexkey string) int
</code></pre></div><ul><li><p>hexkey</p> <p>十六进制编码格式的公钥。</p></li></ul> <p><strong>示例</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> wallet int
wallet <span class="token operator">=</span> <span class="token function">PubToID</span><span class="token punctuation">(</span><span class="token string">&quot;04fa5e78.....34abd6&quot;</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="decodebase64"><a href="#decodebase64" class="header-anchor">#</a> DecodeBase64 </h3> <p>通过指定base64编码格式返回字符串。</p> <p><strong>语法</strong></p> <div class="language-text extra-class"><pre class="language-text"><code>DecodeBase64(input string) string
</code></pre></div><ul><li><p>input</p> <p>base64编码格式字符串。</p></li></ul> <p><strong>示例</strong></p> <div class="language-js extra-class"><pre class="language-js"><code>val <span class="token operator">=</span> <span class="token function">DecodeBase64</span><span class="token punctuation">(</span>mybase64<span class="token punctuation">)</span>
</code></pre></div><h3 id="encodebase64"><a href="#encodebase64" class="header-anchor">#</a> EncodeBase64 </h3> <p>通过指定字符串返回base64编码格式的字符串。</p> <p><strong>语法</strong></p> <div class="language-text extra-class"><pre class="language-text"><code>EncodeBase64(input string) string
</code></pre></div><ul><li><p>input</p> <p>需要编码的字符串。</p></li></ul> <p><strong>示例</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> base64str string
base64str <span class="token operator">=</span> <span class="token function">EncodeBase64</span><span class="token punctuation">(</span><span class="token string">&quot;my text&quot;</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="float"><a href="#float" class="header-anchor">#</a> Float </h3> <p>将整数或字符串转换为浮点数。</p> <p><strong>语法</strong></p> <div class="language-text extra-class"><pre class="language-text"><code>Float(val int|string) float
</code></pre></div><ul><li><p>val</p> <p>整数或字符串。</p></li></ul> <p><strong>示例</strong></p> <div class="language-js extra-class"><pre class="language-js"><code>val <span class="token operator">=</span> <span class="token function">Float</span><span class="token punctuation">(</span><span class="token string">&quot;567.989&quot;</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">Float</span><span class="token punctuation">(</span><span class="token number">232</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="hextobytes"><a href="#hextobytes" class="header-anchor">#</a> HexToBytes </h3> <p>将十六进制编码格式的字符串转换为字节类型 <em>bytes</em>。</p> <p><strong>语法</strong></p> <div class="language-text extra-class"><pre class="language-text"><code>HexToBytes(hexdata string) bytes
</code></pre></div><ul><li><p>hexdata</p> <p>十六进制编码格式的字符串。</p></li></ul> <p><strong>示例</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> val bytes
val <span class="token operator">=</span> <span class="token function">HexToBytes</span><span class="token punctuation">(</span><span class="token string">&quot;34fe4501a4d80094&quot;</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="formatmoney"><a href="#formatmoney" class="header-anchor">#</a> FormatMoney </h3> <p>返回 <em>exp / 10 ^ digit</em> 的字符串值。</p> <p><strong>语法</strong></p> <div class="language-text extra-class"><pre class="language-text"><code>FormatMoney(exp string, digit int) string
</code></pre></div><ul><li><p>exp</p> <p>数字的字符串格式。</p></li> <li><p>digit</p> <p><code>exp/10^digit</code>
表达式中10的指数，该值可以是正数或负数。正值决定了小数点后的位数。</p></li></ul> <p><strong>示例</strong></p> <div class="language-js extra-class"><pre class="language-js"><code>s <span class="token operator">=</span> <span class="token function">FormatMoney</span><span class="token punctuation">(</span><span class="token string">&quot;78236475917384&quot;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="random"><a href="#random" class="header-anchor">#</a> Random </h3> <p>返回min和max之间的随机数（min &lt;= result &lt;max）。min和max都必须是正数。</p> <p><strong>语法</strong></p> <div class="language-text extra-class"><pre class="language-text"><code>Random(min int, max int) int
</code></pre></div><ul><li><p>min</p> <p>随机数的最小值。</p></li> <li><p>max</p> <p>随机数的上限。生成的随机数将小于该值。</p></li></ul> <p><strong>示例</strong></p> <div class="language-js extra-class"><pre class="language-js"><code>i <span class="token operator">=</span> <span class="token function">Random</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">5000</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="int"><a href="#int" class="header-anchor">#</a> Int </h3> <p>将字符串值转换为整数。</p> <p><strong>语法</strong></p> <div class="language-text extra-class"><pre class="language-text"><code>Int(val string) int
</code></pre></div><ul><li><p>val</p> <p>数字的字符串格式。</p></li></ul> <p><strong>示例</strong></p> <div class="language-js extra-class"><pre class="language-js"><code>mystr <span class="token operator">=</span> <span class="token string">&quot;-37763499007332&quot;</span>
val <span class="token operator">=</span> <span class="token function">Int</span><span class="token punctuation">(</span>mystr<span class="token punctuation">)</span>
</code></pre></div><h3 id="hash"><a href="#hash" class="header-anchor">#</a> Hash </h3> <p>返回指定字节数组或字符串的哈希，由系统加密库crypto生成的哈希。</p> <p><strong>语法</strong></p> <div class="language-text extra-class"><pre class="language-text"><code>Hash(val interface{}) string, error
</code></pre></div><ul><li><p>val</p> <p>字符串或字节数组。</p></li></ul> <p><strong>示例</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> hash string
hash <span class="token operator">=</span> <span class="token function">Hash</span><span class="token punctuation">(</span><span class="token string">&quot;Test message&quot;</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="sha256"><a href="#sha256" class="header-anchor">#</a> Sha256 </h3> <p>返回指定字符串的 <strong>SHA256</strong> 哈希值。</p> <p><strong>语法</strong></p> <div class="language-text extra-class"><pre class="language-text"><code>Sha256(val string) string
</code></pre></div><ul><li><p>val</p> <p>需要 <strong>Sha256</strong> 哈希运算的字符串。</p></li></ul> <p><strong>示例</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> sha string
sha <span class="token operator">=</span> <span class="token function">Sha256</span><span class="token punctuation">(</span><span class="token string">&quot;Test message&quot;</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="str"><a href="#str" class="header-anchor">#</a> Str </h3> <p>将整数 <em>int</em> 或浮点数 <em>float</em> 转换为字符串。</p> <p><strong>语法</strong></p> <div class="language-text extra-class"><pre class="language-text"><code>Str(val int|float) string
</code></pre></div><ul><li><p>val</p> <p>整数或浮点数。</p></li></ul> <p><strong>示例</strong></p> <div class="language-js extra-class"><pre class="language-js"><code>myfloat <span class="token operator">=</span> <span class="token number">5.678</span>
val <span class="token operator">=</span> <span class="token function">Str</span><span class="token punctuation">(</span>myfloat<span class="token punctuation">)</span>
</code></pre></div><h3 id="jsonencode"><a href="#jsonencode" class="header-anchor">#</a> JSONEncode </h3> <p>将数字、字符串或数组转换为JSON格式的字符串。</p> <p><strong>语法</strong></p> <div class="language-text extra-class"><pre class="language-text"><code>JSONEncode(src int|float|string|map|array) string
</code></pre></div><ul><li><p>src</p> <p>需转换的数据。</p></li></ul> <p><strong>示例</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> mydata map
mydata<span class="token punctuation">[</span><span class="token string">&quot;key&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>
<span class="token keyword">var</span> json string
json <span class="token operator">=</span> <span class="token function">JSONEncode</span><span class="token punctuation">(</span>mydata<span class="token punctuation">)</span>
</code></pre></div><h3 id="jsonencodeindent"><a href="#jsonencodeindent" class="header-anchor">#</a> JSONEncodeIndent </h3> <p>使用指定的缩进将数字、字符串或数组转换为JSON格式的字符串。</p> <p><strong>语法</strong></p> <div class="language-text extra-class"><pre class="language-text"><code>JSONEncodeIndent(src int|float|string|map|array, indent string) string
</code></pre></div><ul><li><p>src</p> <p>需要转换的数据。</p></li> <li><p>indent</p> <p>用作缩进的字符串。</p></li></ul> <p><strong>示例</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> mydata map
mydata<span class="token punctuation">[</span><span class="token string">&quot;key&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>
<span class="token keyword">var</span> json string
json <span class="token operator">=</span> <span class="token function">JSONEncodeIndent</span><span class="token punctuation">(</span>mydata<span class="token punctuation">,</span> <span class="token string">&quot;\t&quot;</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="jsondecode"><a href="#jsondecode" class="header-anchor">#</a> JSONDecode </h3> <p>将JSON格式的字符串转换为数字，字符串或数组。</p> <p><strong>语法</strong></p> <div class="language-text extra-class"><pre class="language-text"><code>JSONDecode(src string) int|float|string|map|array
</code></pre></div><ul><li><p>src</p> <p>包含JSON格式数据的字符串。</p></li></ul> <p><strong>示例</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> mydata map
mydata <span class="token operator">=</span> <span class="token function">JSONDecode</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">{&quot;name&quot;: &quot;John Smith&quot;, &quot;company&quot;: &quot;Smith's company&quot;}</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
</code></pre></div><h3 id="hasprefix"><a href="#hasprefix" class="header-anchor">#</a> HasPrefix </h3> <p>检查字符串是否以指定的字符串开头。</p> <p><strong>语法</strong></p> <div class="language-text extra-class"><pre class="language-text"><code>HasPrefix(s string, prefix string) bool
</code></pre></div><ul><li><p>s</p> <p>字符串。</p></li> <li><p>prefix</p> <p>需要检查的前缀。</p></li></ul> <p><strong>返回值</strong></p> <p>如果字符串以指定的字符串开头，则返回 <code>true</code>。</p> <p><strong>示例</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">if</span> <span class="token function">HasPrefix</span><span class="token punctuation">(</span>$Name<span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">my</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token operator">...</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="contains"><a href="#contains" class="header-anchor">#</a> Contains </h3> <p>检查字符串是否包含指定的子字符串。</p> <p><strong>语法</strong></p> <div class="language-text extra-class"><pre class="language-text"><code>Contains(s string, substr string) bool
</code></pre></div><ul><li><p>s</p> <p>字符串。</p></li> <li><p>substr</p> <p>子字符串。</p></li></ul> <p><strong>返回值</strong></p> <p>如果字符串包含子字符串，则返回 <code>true</code>。</p> <p><strong>示例</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">if</span> <span class="token function">Contains</span><span class="token punctuation">(</span>$Name<span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">my</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token operator">...</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="replace"><a href="#replace" class="header-anchor">#</a> Replace </h3> <p>把字符串中的 old（旧字符串） 替换成 new(新字符串)。</p> <p><strong>语法</strong></p> <div class="language-text extra-class"><pre class="language-text"><code>Replace(s string, old string, new string) string
</code></pre></div><ul><li><p>s</p> <p>原始字符串。</p></li> <li><p>old</p> <p>将被替换的子字符串。</p></li> <li><p>new</p> <p>新字符串。</p></li></ul> <p><strong>示例</strong></p> <div class="language-js extra-class"><pre class="language-js"><code>s <span class="token operator">=</span> <span class="token function">Replace</span><span class="token punctuation">(</span>$Name<span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">me</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">you</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
</code></pre></div><h3 id="size"><a href="#size" class="header-anchor">#</a> Size </h3> <p>返回指定字符串的字节数。</p> <p><strong>语法</strong></p> <div class="language-text extra-class"><pre class="language-text"><code>Size(val string) int
</code></pre></div><ul><li><p>val</p> <p>字符串。</p></li></ul> <p><strong>示例</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> len int
len <span class="token operator">=</span> <span class="token function">Size</span><span class="token punctuation">(</span>$Name<span class="token punctuation">)</span>
</code></pre></div><h3 id="sprintf"><a href="#sprintf" class="header-anchor">#</a> Sprintf </h3> <p>该函数根据指定的模板和参数创建一个字符串。</p> <p>可用的通配符：</p> <blockquote><ul><li><code>%d</code> (整数)</li> <li><code>%s</code> (字符串)</li> <li><code>%f</code> (浮点型)</li> <li><code>%v</code> (任何类型)</li></ul></blockquote> <p><strong>语法</strong></p> <div class="language-text extra-class"><pre class="language-text"><code>Sprintf(pattern string, val ...) string
</code></pre></div><ul><li><p>pattern</p> <p>字符串的模板。</p></li></ul> <p><strong>示例</strong></p> <div class="language-js extra-class"><pre class="language-js"><code>out <span class="token operator">=</span> <span class="token function">Sprintf</span><span class="token punctuation">(</span><span class="token string">&quot;%s=%d&quot;</span><span class="token punctuation">,</span> mypar<span class="token punctuation">,</span> <span class="token number">6448</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="substr"><a href="#substr" class="header-anchor">#</a> Substr </h3> <p>返回从偏移量 <em>offset</em>(默认从0开始计算)开始的指定字符串中获取的子字符串，其最大长度限制为<em>length</em>。</p> <p>如果偏移量或长度限制小于零、偏移量大于长度限制的值，则返回一个空字符串。</p> <p>如果偏移量和长度限制的总和大于字符串字节数，则子字符串将从偏移量开始返回到指定字符串的末尾。</p> <p><strong>语法</strong></p> <div class="language-text extra-class"><pre class="language-text"><code>Substr(s string, offset int, length int) string
</code></pre></div><ul><li><p>val</p> <p>字符串。</p></li> <li><p>offset</p> <p>偏移量。</p></li> <li><p>length</p> <p>子字符串的长度限制。</p></li></ul> <p><strong>示例</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> s string
s <span class="token operator">=</span> <span class="token function">Substr</span><span class="token punctuation">(</span>$Name<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="tolower"><a href="#tolower" class="header-anchor">#</a> ToLower </h3> <p>以小写形式返回指定的字符串。</p> <p><strong>语法</strong></p> <div class="language-text extra-class"><pre class="language-text"><code>ToLower(val string) string
</code></pre></div><ul><li><p>val</p> <p>字符串。</p></li></ul> <p><strong>示例</strong></p> <div class="language-js extra-class"><pre class="language-js"><code>val <span class="token operator">=</span> <span class="token function">ToLower</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span>
</code></pre></div><h3 id="toupper"><a href="#toupper" class="header-anchor">#</a> ToUpper </h3> <p>以大写形式返回指定的字符串。</p> <p><strong>语法</strong></p> <div class="language-text extra-class"><pre class="language-text"><code>ToUpper(val string) string
</code></pre></div><ul><li><p>val</p> <p>字符串。</p></li></ul> <p><strong>示例</strong></p> <div class="language-js extra-class"><pre class="language-js"><code>val <span class="token operator">=</span> <span class="token function">ToUpper</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span>
</code></pre></div><h3 id="trimspace"><a href="#trimspace" class="header-anchor">#</a> TrimSpace </h3> <p>删除指定字符串的前后空格、制表符和换行符号。</p> <p><strong>语法</strong></p> <div class="language-text extra-class"><pre class="language-text"><code>TrimSpace(val string) string
</code></pre></div><ul><li><p>val</p> <p>字符串。</p></li></ul> <p><strong>示例</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> val string
val <span class="token operator">=</span> <span class="token function">TrimSpace</span><span class="token punctuation">(</span><span class="token string">&quot;  mystr  &quot;</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="floor"><a href="#floor" class="header-anchor">#</a> Floor </h3> <p>返回小于或等于指定数字、浮点数和字符串的最大整数值。</p> <p><strong>语法</strong></p> <div class="language-text extra-class"><pre class="language-text"><code>Floor(x float|int|string) int
</code></pre></div><ul><li><p>x</p> <p>数字、浮点数和字符串。</p></li></ul> <p><strong>示例</strong></p> <div class="language-js extra-class"><pre class="language-js"><code>val <span class="token operator">=</span> <span class="token function">Floor</span><span class="token punctuation">(</span><span class="token number">5.6</span><span class="token punctuation">)</span> <span class="token comment">// returns 5</span>
</code></pre></div><h3 id="log"><a href="#log" class="header-anchor">#</a> Log </h3> <p>返回指定数字、浮点数和字符串的自然对数。</p> <p><strong>语法</strong></p> <div class="language-text extra-class"><pre class="language-text"><code>Log(x float|int|string) float
</code></pre></div><ul><li><p>x</p> <p>数字、浮点数和字符串。</p></li></ul> <p><strong>示例</strong></p> <div class="language-js extra-class"><pre class="language-js"><code>val <span class="token operator">=</span> <span class="token function">Log</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="log10"><a href="#log10" class="header-anchor">#</a> Log10 </h3> <p>返回指定数字、浮点数和字符串的以10为底的对数。</p> <p><strong>语法</strong></p> <div class="language-text extra-class"><pre class="language-text"><code>Log10(x float|int|string) float
</code></pre></div><ul><li><p>x</p> <p>数字、浮点数和字符串。</p></li></ul> <p><strong>示例</strong></p> <div class="language-js extra-class"><pre class="language-js"><code>val <span class="token operator">=</span> <span class="token function">Log10</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="pow"><a href="#pow" class="header-anchor">#</a> Pow </h3> <p>返回(x^y^)，y是以x为基数的指数。</p> <p><strong>语法</strong></p> <div class="language-text extra-class"><pre class="language-text"><code>Pow(x float|int|string, y float|int|string) float
</code></pre></div><ul><li><p>x</p> <p>基数。</p></li> <li><p>y</p> <p>指数。</p></li></ul> <p><strong>示例</strong></p> <div class="language-js extra-class"><pre class="language-js"><code>val <span class="token operator">=</span> <span class="token function">Pow</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="round"><a href="#round" class="header-anchor">#</a> Round </h3> <p>返回指定数字四舍五入到最近整数的值。</p> <p><strong>语法</strong></p> <div class="language-text extra-class"><pre class="language-text"><code>Round(x float|int|string) int
</code></pre></div><ul><li><p>x</p> <p>数字。</p></li></ul> <p><strong>示例</strong></p> <div class="language-js extra-class"><pre class="language-js"><code>val <span class="token operator">=</span> <span class="token function">Round</span><span class="token punctuation">(</span><span class="token number">5.6</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="sqrt"><a href="#sqrt" class="header-anchor">#</a> Sqrt </h3> <p>返回指定数字的平方根。</p> <div class="language-text extra-class"><pre class="language-text"><code>Sqrt(x float|int|string) float
</code></pre></div><ul><li><p>x</p> <p>数字。</p></li></ul> <p><strong>示例</strong></p> <div class="language-js extra-class"><pre class="language-js"><code>val <span class="token operator">=</span> <span class="token function">Sqrt</span><span class="token punctuation">(</span><span class="token number">225</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="stringtobytes"><a href="#stringtobytes" class="header-anchor">#</a> StringToBytes </h3> <p>将字符串转换为字节。</p> <p><strong>语法</strong></p> <div class="language-text extra-class"><pre class="language-text"><code>StringToBytes(src string) bytes
</code></pre></div><ul><li><p>src</p> <p>字符串。</p></li></ul> <p><strong>示例</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> b bytes
b <span class="token operator">=</span> <span class="token function">StringToBytes</span><span class="token punctuation">(</span><span class="token string">&quot;my string&quot;</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="bytestostring"><a href="#bytestostring" class="header-anchor">#</a> BytesToString </h3> <p>将字节转换为字符串。</p> <p><strong>语法</strong></p> <div class="language-text extra-class"><pre class="language-text"><code>BytesToString(src bytes) string
</code></pre></div><ul><li><p>src</p> <p>字节。</p></li></ul> <p><strong>示例</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> s string
s <span class="token operator">=</span> <span class="token function">BytesToString</span><span class="token punctuation">(</span>$Bytes<span class="token punctuation">)</span>
</code></pre></div><h3 id="sysparamstring"><a href="#sysparamstring" class="header-anchor">#</a> SysParamString </h3> <p>返回指定平台参数的值。</p> <p><strong>语法</strong></p> <div class="language-text extra-class"><pre class="language-text"><code>SysParamString(name string) string
</code></pre></div><ul><li><p>name</p> <p>参数名称。</p></li></ul> <p><strong>示例</strong></p> <div class="language-js extra-class"><pre class="language-js"><code>url <span class="token operator">=</span> <span class="token function">SysParamString</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">blockchain_url</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
</code></pre></div><h3 id="sysparamint"><a href="#sysparamint" class="header-anchor">#</a> SysParamInt </h3> <p>以数字的形式返回指定平台参数的值。</p> <p><strong>语法</strong></p> <div class="language-text extra-class"><pre class="language-text"><code>SysParamInt(name string) int
</code></pre></div><ul><li><p>name</p> <p>参数名称。</p></li></ul> <p><strong>示例</strong></p> <div class="language-js extra-class"><pre class="language-js"><code>maxcol <span class="token operator">=</span> <span class="token function">SysParam</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">max_columns</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
</code></pre></div><h3 id="dbupdatesysparam"><a href="#dbupdatesysparam" class="header-anchor">#</a> DBUpdateSysParam </h3> <p>更新平台参数的值和条件。如果您不需要更改值或条件，请在相应参数中指定空字符串。</p> <p><strong>语法</strong></p> <div class="language-text extra-class"><pre class="language-text"><code>DBUpdateSysParam(name, value, conditions string)
</code></pre></div><ul><li><p>name</p> <p>平台参数名称。</p></li> <li><p>value</p> <p>参数的新值。</p></li> <li><p>conditions</p> <p>更改参数的新条件。</p></li></ul> <p><strong>示例</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">DBUpdateSysParam</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">fuel_rate</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">400000000000</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
</code></pre></div><h3 id="updatenotifications"><a href="#updatenotifications" class="header-anchor">#</a> UpdateNotifications </h3> <p>从数据库中获取指定键的通知列表，并将获取的通知发送到Centrifugo。</p> <p><strong>语法</strong></p> <div class="language-text extra-class"><pre class="language-text"><code>UpdateNotifications(ecosystemID int, keys int ...)
</code></pre></div><ul><li><p>ecosystemID</p> <p>生态系统ID。</p></li> <li><p>key</p> <p>账户地址列表，以逗号分隔。或您可以使用一个数组指定账户地址列表。</p></li></ul> <p><strong>示例</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">UpdateNotifications</span><span class="token punctuation">(</span>$ecosystem_id<span class="token punctuation">,</span> $key_id<span class="token punctuation">,</span> <span class="token number">23345355454</span><span class="token punctuation">,</span> <span class="token number">35545454554</span><span class="token punctuation">)</span>
<span class="token function">UpdateNotifications</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>$key_id<span class="token punctuation">,</span> <span class="token number">23345355454</span><span class="token punctuation">,</span> <span class="token number">35545454554</span><span class="token punctuation">]</span> <span class="token punctuation">)</span>
</code></pre></div><h3 id="updaterolesnotifications"><a href="#updaterolesnotifications" class="header-anchor">#</a> UpdateRolesNotifications </h3> <p>获取数据库中指定角色ID的所有账户地址的通知列表，并将获取的通知发送到Centrifugo。</p> <p><strong>语法</strong></p> <div class="language-text extra-class"><pre class="language-text"><code>UpdateRolesNotifications(ecosystemID int, roles int ...)
</code></pre></div><ul><li><p>ecosystemID</p> <p>生态系统ID。</p></li> <li><p>roles</p> <p>角色ID列表，以逗号分隔。或您可以使用一个数组指定角色ID列表。</p></li></ul> <p><strong>示例</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">UpdateRolesNotifications</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="httprequest"><a href="#httprequest" class="header-anchor">#</a> HTTPRequest </h3> <p>将HTTP请求发送到指定的地址。</p> <div class="language-text extra-class"><pre class="language-text"><code>该函数仅可用于 CLB 合约。
</code></pre></div><p><strong>语法</strong></p> <div class="language-text extra-class"><pre class="language-text"><code>HTTPRequest(url string, method string, heads map, pars map) string
</code></pre></div><ul><li><p>url</p> <p>发送的请求地址。</p></li> <li><p>method</p> <p>请求类型（GET或POST）。</p></li> <li><p>heads</p> <p>请求头，对象数组。</p></li> <li><p>pars</p> <p>请求参数。</p></li></ul> <p><strong>示例</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> ret string
<span class="token keyword">var</span> ret string 
<span class="token keyword">var</span> ret string
<span class="token keyword">var</span> pars<span class="token punctuation">,</span> heads<span class="token punctuation">,</span> json map
heads<span class="token punctuation">[</span><span class="token string">&quot;Authorization&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;Bearer &quot;</span> <span class="token operator">+</span> $auth_token
pars<span class="token punctuation">[</span><span class="token string">&quot;obs&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;true&quot;</span>
ret <span class="token operator">=</span> <span class="token function">HTTPRequest</span><span class="token punctuation">(</span><span class="token string">&quot;http://localhost:7079/api/v2/content/page/default_page&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;POST&quot;</span><span class="token punctuation">,</span> heads<span class="token punctuation">,</span> pars<span class="token punctuation">)</span>
json <span class="token operator">=</span> <span class="token function">JSONToMap</span><span class="token punctuation">(</span>ret<span class="token punctuation">)</span>
</code></pre></div><h3 id="httppostjson"><a href="#httppostjson" class="header-anchor">#</a> HTTPPostJSON </h3> <p>该函数类似于 <em>HTTPRequest</em> 函数，但它发送POST请求，请求参数为字符串。</p> <div class="language-text extra-class"><pre class="language-text"><code>该函数仅可用于 CLB 合约。
</code></pre></div><p><strong>语法</strong></p> <div class="language-text extra-class"><pre class="language-text"><code>HTTPPostJSON(url string, heads map, pars string) string
</code></pre></div><ul><li><p>url</p> <p>发送的请求地址。</p></li> <li><p>heads</p> <p>请求头，对象数组。</p></li> <li><p>pars</p> <p>请求参数，JSON字符串。</p></li></ul> <p><strong>示例</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> ret string
<span class="token keyword">var</span> ret string 
<span class="token keyword">var</span> ret string
<span class="token keyword">var</span> heads<span class="token punctuation">,</span> json map
heads<span class="token punctuation">[</span><span class="token string">&quot;Authorization&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;Bearer &quot;</span> <span class="token operator">+</span> $auth_token
ret <span class="token operator">=</span> <span class="token function">HTTPPostJSON</span><span class="token punctuation">(</span><span class="token string">&quot;http://localhost:7079/api/v2/content/page/default_page&quot;</span><span class="token punctuation">,</span> heads<span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">{&quot;obs&quot;:&quot;true&quot;}</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
json <span class="token operator">=</span> <span class="token function">JSONToMap</span><span class="token punctuation">(</span>ret<span class="token punctuation">)</span>
</code></pre></div><h3 id="blocktime"><a href="#blocktime" class="header-anchor">#</a> BlockTime </h3> <p>以SQL格式返回区块的生成时间。</p> <p><strong>语法</strong></p> <div class="language-text extra-class"><pre class="language-text"><code>BlockTime()
</code></pre></div><p><strong>示例</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> mytime string
mytime <span class="token operator">=</span> <span class="token function">BlockTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">DBInsert</span><span class="token punctuation">(</span><span class="token string">&quot;mytable&quot;</span><span class="token punctuation">,</span> myid<span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">time</span><span class="token operator">:</span> mytime<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="datetime"><a href="#datetime" class="header-anchor">#</a> DateTime </h3> <p>将时间戳unixtime转换为 [YYYY-MM-DD HH：MI：SS]{.title-ref} 格式的字符串。</p> <p><strong>语法</strong></p> <div class="language-text extra-class"><pre class="language-text"><code>DateTime(unixtime int) string
</code></pre></div><p><strong>示例</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">DateTime</span><span class="token punctuation">(</span><span class="token number">1532325250</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="unixdatetime"><a href="#unixdatetime" class="header-anchor">#</a> UnixDateTime </h3> <p>将 [YYYY-MM-DD HH：MI：SS]{.title-ref} 格式的字符串转换为时间戳unixtime。</p> <p><strong>语法</strong></p> <div class="language-text extra-class"><pre class="language-text"><code>UnixDateTime(datetime string) int
</code></pre></div><p><strong>示例</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">UnixDateTime</span><span class="token punctuation">(</span><span class="token string">&quot;2018-07-20 14:23:10&quot;</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="createobs"><a href="#createobs" class="header-anchor">#</a> CreateOBS </h3> <p>创建子 CLB 。</p> <p>该函数只能在主 CLB 模式下使用。</p> <p><strong>语法</strong></p> <div class="language-text extra-class"><pre class="language-text"><code>CreateOBS(OBSName string, DBUser string, DBPassword string, OBSAPIPort int)
</code></pre></div><ul><li><p>OBSName</p> <p>CLB 的名称。</p></li> <li><p>DBUser</p> <p>数据库的角色名称。</p></li> <li><p>DBPassword</p> <p>该角色的密码。</p></li> <li><p>OBSAPIPort</p> <p>API请求的端口。</p></li></ul> <p><strong>示例</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">CreateOBS</span><span class="token punctuation">(</span><span class="token string">&quot;obsname&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;obsuser&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;obspwd&quot;</span><span class="token punctuation">,</span> <span class="token number">8095</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="getobslist"><a href="#getobslist" class="header-anchor">#</a> GetOBSList </h3> <p>返回子 CLB 列表。</p> <p>该函数只能在主 CLB 模式下使用。</p> <p><strong>语法</strong></p> <div class="language-text extra-class"><pre class="language-text"><code>GetOBSList()
</code></pre></div><p><strong>返回值</strong></p> <p>一个对象数组，其中键是 CLB 名称和值是进程状态。</p> <h3 id="runobs"><a href="#runobs" class="header-anchor">#</a> RunOBS </h3> <p>运行 CLB 的进程。</p> <p>该函数只能在主 CLB 模式下使用。</p> <p><strong>语法</strong></p> <div class="language-text extra-class"><pre class="language-text"><code>RunOBS(OBSName string)
</code></pre></div><ul><li><p>OBSName</p> <p>CLB 名称。</p></li></ul> <p>只能包含字母和数字，不能使用空格符号。</p> <h3 id="stopobs"><a href="#stopobs" class="header-anchor">#</a> StopOBS </h3> <p>停止指定 CLB 的进程。</p> <p>该函数只能在主 CLB 模式下使用。</p> <p><strong>语法</strong></p> <div class="language-text extra-class"><pre class="language-text"><code>StopOBS(OBSName string)
</code></pre></div><ul><li><p>OBSName</p> <p>CLB 名称。</p></li></ul> <p>只能包含字母和数字，不能使用空格符号。</p> <h3 id="removeobs"><a href="#removeobs" class="header-anchor">#</a> RemoveOBS </h3> <p>删除指定 CLB 的进程。</p> <p>该函数只能在主 CLB 模式下使用。</p> <p><strong>语法</strong></p> <div class="language-text extra-class"><pre class="language-text"><code>RemoveOBS(OBSName string)
</code></pre></div><ul><li><p>OBSName</p> <p>CLB 名称。</p> <p>只能包含字母和数字，不能使用空格符号。</p></li></ul> <h2 id="system-contracts"><a href="#system-contracts" class="header-anchor">#</a> System Contracts </h2> <p>系统合约是在启动 IBAX区块链平台时默认创建的。所有这些合约都是在第一个生态系统中创建的，这就是为什么你需要指定其全名来从其他生态系统中调用它们， 例如，<code>@1NewContract</code>。</p> <h3 id="newecosystem"><a href="#newecosystem" class="header-anchor">#</a> NewEcosystem </h3> <p>创建一个新的生态系统，要获取创建的生态系统ID，必须引用在<a href="/zh-CN/reference/api2.html#txstatus">txstatus</a> 中返回的 <em>result</em> 字段</p> <p>参数：</p> <blockquote><ul><li><em>Name string</em> - 生态系统的名称，可以更改该名称。</li></ul></blockquote> <h3 id="editecosystemname"><a href="#editecosystemname" class="header-anchor">#</a> EditEcosystemName </h3> <p>更改 <em>1_ecosystems</em> 表中生态系统的名称，该表仅存在于第一个生态系统中。</p> <p>参数：</p> <blockquote><ul><li><em>EcosystemID int</em> - 更改其名称的生态系统ID；</li> <li><em>NewName string</em> - 生态系统新名称。</li></ul></blockquote> <h3 id="newcontract"><a href="#newcontract" class="header-anchor">#</a> NewContract </h3> <p>在当前生态系统中创建一个新合约。</p> <p>参数：</p> <ul><li><em>ApplicationId int</em> - 新合约所属的应用程序；</li> <li><em>Value string</em> - 合约源码，上层必须只有一个合约；</li> <li><em>Conditions string</em> - 更改该合约的条件；</li> <li><em>TokenEcosystem int &quot;optional&quot;</em> - 生态系统ID，当合约被激活时，将使用哪种通证进行交易。</li></ul> <h3 id="editcontract"><a href="#editcontract" class="header-anchor">#</a> EditContract </h3> <p>编辑当前生态系统中的合约。</p> <p>参数：</p> <blockquote><ul><li><em>Id int</em> - 更改的合约ID；</li> <li><em>Value string &quot;optional&quot;</em> - 合约源码；</li> <li><em>Conditions string &quot;optional&quot;</em> - 更改该合约的条件。</li></ul></blockquote> <h3 id="bindwallet"><a href="#bindwallet" class="header-anchor">#</a> BindWallet </h3> <p>将合约绑定到当前生态系统中的钱包地址。合同绑定后，该地址将支付执行该合约的费用。参数：</p> <blockquote><ul><li><em>Id int</em> - 要绑定的合约ID。</li> <li><em>WalletId string &quot;optional&quot;</em> - 合约绑定的钱包地址。</li></ul></blockquote> <h3 id="unbindwallet"><a href="#unbindwallet" class="header-anchor">#</a> UnbindWallet </h3> <p>从当前生态系统中的钱包地址取消绑定合约，只有已绑定该合约的地址才能取消绑定。合约未绑定后，执行合约的用户将支付执行费用。</p> <p>参数：</p> <blockquote><ul><li><em>Id int</em> - 绑定的合同ID。</li></ul></blockquote> <h3 id="newparameter"><a href="#newparameter" class="header-anchor">#</a> NewParameter </h3> <p>早当前生态系统添加了一个新生态系统参数。</p> <p>参数：</p> <blockquote><ul><li><em>Name string</em> - 参数名称；</li> <li><em>Value string</em> - 参数值；</li> <li><em>Conditions string</em> - 更改参数的条件。</li></ul></blockquote> <h3 id="editparameter"><a href="#editparameter" class="header-anchor">#</a> EditParameter </h3> <p>更改当前生态系统中的现有生态系统参数。</p> <p>参数：</p> <blockquote><ul><li><em>Name string</em> - 要更改的参数名称；</li> <li><em>Value string</em> - 新参数值；</li> <li><em>Conditions string</em> - 更改参数的新条件。</li></ul></blockquote> <h3 id="newmenu"><a href="#newmenu" class="header-anchor">#</a> NewMenu </h3> <p>在当前生态系统中添加一个新菜单。</p> <p>参数：</p> <blockquote><ul><li><em>Name string</em> - 菜单名称；</li> <li><em>Value string</em> - 菜单源码；</li> <li><em>Title string &quot;optional&quot;</em> - 菜单标题；</li> <li><em>Conditions string</em> - 更改菜单的条件。</li></ul></blockquote> <h3 id="editmenu"><a href="#editmenu" class="header-anchor">#</a> EditMenu </h3> <p>更改当前生态系统中的现有菜单。</p> <p>参数：</p> <blockquote><ul><li><em>Id int</em> - 要更改的菜单ID；</li> <li><em>Value string &quot;optional&quot;</em> - 新菜单源码；</li> <li><em>Title string &quot;optional&quot;</em> - 新菜单标题；</li> <li><em>Conditions string &quot;optional&quot;</em> - 更改菜单的新条件。</li></ul></blockquote> <h3 id="appendmenu"><a href="#appendmenu" class="header-anchor">#</a> AppendMenu </h3> <p>将源码内容添加到当前生态系统中的现有菜单。</p> <p>参数：</p> <blockquote><ul><li><em>Id int</em> - 菜单ID；</li> <li><em>Value string</em> - 要添加的源码。</li></ul></blockquote> <h3 id="newpage"><a href="#newpage" class="header-anchor">#</a> NewPage </h3> <p>在当前生态系统中添加新页面。</p> <p>参数：</p> <blockquote><ul><li><em>Name string</em> - 页面名称；</li> <li><em>Value string</em> - 页面源码；</li> <li><em>Menu string</em> - 关联该页面的菜单名称；</li> <li><em>Conditions string</em> - 更改页面的条件；</li> <li><em>ValidateCount int &quot;optional&quot;</em> - 页面验证所需的节点数。如果未指定此参数，则使用 <em>min_page_validate_count</em> 生态系统参数值。
该值不能小于 <em>min_page_validate_count</em> 且大于 <em>max_page_validate_count</em>；</li> <li><em>ValidateMode int &quot;optional&quot;</em> - 页面有效性检查模式。值为0表示在加载页面时检查页面。值为1表示在加载和离开页面时检查页面。</li></ul></blockquote> <h3 id="editpage"><a href="#editpage" class="header-anchor">#</a> EditPage </h3> <p>更改当前生态系统中的现有页面。</p> <p>参数：</p> <blockquote><ul><li><em>Id int</em> - 要更改的页面ID；</li> <li><em>Value string &quot;optional&quot;</em> - 新页面源码；</li> <li><em>Menu string &quot;optional&quot;</em> - 关联该页面的新菜单名称；</li> <li><em>Conditions string &quot;optional&quot;</em> - 更改页面的新条件；</li> <li><em>ValidateCount int &quot;optional&quot;</em> - 页面验证所需的节点数。如果未指定此参数，则使用 <em>min_page_validate_count</em> 生态系统参数值。
该值不能小于 <em>min_page_validate_count</em> 且大于 <em>max_page_validate_count</em>；</li> <li><em>ValidateMode int &quot;optional&quot;</em> - 页面有效性检查模式。值为0表示在加载页面时检查页面。值为1表示在加载和离开页面时检查页面。</li></ul></blockquote> <h3 id="appendpage"><a href="#appendpage" class="header-anchor">#</a> AppendPage </h3> <p>将源码内容添加到当前生态系统中的现有页面。</p> <p>参数：</p> <blockquote><ul><li><em>Id int</em> - 要更改的页面ID；</li> <li><em>Value string</em> - 要添加的源码。</li></ul></blockquote> <h3 id="newblock"><a href="#newblock" class="header-anchor">#</a> NewBlock </h3> <p>在当前生态系统添加一个页面模块。</p> <p>参数：</p> <blockquote><ul><li><em>Name string</em> - 模块名称；</li> <li><em>Value string</em> - 模块源码；</li> <li><em>Conditions string</em> - 更改模块的条件。</li></ul></blockquote> <h3 id="editblock"><a href="#editblock" class="header-anchor">#</a> EditBlock </h3> <p>更改当前生态系统中的现有页面模块。</p> <p>Parameters</p> <blockquote><ul><li><em>Id int</em> - 要更改的模块ID；</li> <li><em>Value string</em> - 新模块源码；</li> <li><em>Conditions string</em> - 更改模块的新条件。</li></ul></blockquote> <h3 id="newtable"><a href="#newtable" class="header-anchor">#</a> NewTable </h3> <p>在当前生态系统中添加一个新数据表。</p> <p>参数：</p> <ul><li><p><em>ApplicationId int</em> - 关联数据表的应用程序ID；</p></li> <li><p><em>Name string</em> - 新数据表名称；</p></li> <li><p><em>Columns string</em> - JSON格式的字段数组<code>[{&quot;name&quot;:&quot;...&quot;, &quot;type&quot;:&quot;...&quot;,&quot;index&quot;: &quot;0&quot;, &quot;conditions&quot;:&quot;...&quot;},...]</code>，其中：</p> <blockquote><ul><li><em>name</em> - 字段名称，仅限拉丁字符；</li> <li><em>type</em> - 数据类型 <code>varchar,bytea,number,datetime,money,text,double,character</code>；</li> <li><em>index</em> - 非主键字段 <code>0</code>，主键 <code>1</code>；</li> <li><em>conditions</em> - 更改字段中数据的条件，必须以JSON格式指定访问权限 <code>{&quot;update&quot;:&quot;ContractConditions(`MainCondition`)&quot;, &quot;read&quot;:&quot;ContractConditions(`MainCondition`)&quot;}</code>；</li></ul></blockquote></li> <li><p><em>Permissions string</em> - JSON格式访问权限<code>{&quot;insert&quot;: &quot;...&quot;, &quot;new_column&quot;: &quot;...&quot;, &quot;update&quot;: &quot;...&quot;, &quot;read&quot;: &quot;...&quot;}</code>。</p> <blockquote><ul><li><em>insert</em> - 插入条目的权限；</li> <li><em>new_column</em> - 添加新列的权限；</li> <li><em>update</em> - 更改条目数据的权限；</li> <li><em>read</em> - 读取条目数据的权限。</li></ul></blockquote></li></ul> <h3 id="edittable"><a href="#edittable" class="header-anchor">#</a> EditTable </h3> <p>更改当前生态系统中数据表的访问权限。</p> <p>参数：</p> <blockquote><ul><li><em>Name string</em> - 数据表名称。</li> <li><em>InsertPerm string</em> - 将条目插入数据表中的权限；</li> <li><em>UpdatePerm string</em> - 更新表中条目的权限；</li> <li><em>ReadPerm string</em> - 读取表中条目的权限；</li> <li><em>NewColumnPerm string</em> -创建新列的权限；</li></ul></blockquote> <h3 id="newcolumn"><a href="#newcolumn" class="header-anchor">#</a> NewColumn </h3> <p>在当前生态系统的数据表中添加一个新字段。</p> <p>参数：</p> <blockquote><ul><li><em>TableName string</em> - 数据表名称；</li> <li><em>Name string</em> - 拉丁字符字段名称；</li> <li><em>Type string</em> - 数据类型;
<code>varchar,bytea,number,money,datetime,text,double,character</code>；</li> <li><em>UpdatePerm string</em> - 更改列中值的权限；</li> <li><em>ReadPerm string</em> - 读取列中值的权限。</li></ul></blockquote> <h3 id="editcolumn"><a href="#editcolumn" class="header-anchor">#</a> EditColumn </h3> <p>更改当前生态系统中的指定数据表字段的权限。</p> <p>参数：</p> <blockquote><ul><li><em>TableName string</em> - 数据表名称；</li> <li><em>Name string</em> - 要更改的拉丁字符字段名称；</li> <li><em>UpdatePerm string</em> - 更改列中值的新权限；</li> <li><em>ReadPerm string</em> - 读取列中值的新权限。</li></ul></blockquote> <h3 id="newlang"><a href="#newlang" class="header-anchor">#</a> NewLang </h3> <p>在当前生态系统中新增多语言资源，添加权限在生态系统参数的 <em>changing_language</em> 参数中设置。</p> <p>参数：</p> <blockquote><ul><li><em>Name string</em> - 拉丁字符多语言资源的名称；</li> <li><em>Trans string</em> - JSON格式的字符串，双字符语言代码作为键，翻译字符串作为值。例如:<code>{&quot;en&quot;: &quot;English text&quot;, &quot;zh&quot;: &quot;Chinese text&quot;}</code>。</li></ul></blockquote> <h3 id="editlang"><a href="#editlang" class="header-anchor">#</a> EditLang </h3> <p>更改当前生态系统中的语言资源。更改权限在生态系统参数的 <em>changing_language</em> 参数中设置。</p> <p>参数：</p> <blockquote><ul><li><em>Id int</em> - 多语言资源ID。</li> <li><em>Trans</em> - JSON格式的字符串，双字符语言代码作为键，翻译字符串作为值。例如，<code>{&quot;en&quot;: &quot;English text&quot;, &quot;zh&quot;: &quot;Chinese text&quot;}</code>。</li></ul></blockquote> <h3 id="import"><a href="#import" class="header-anchor">#</a> Import </h3> <p>将应用程序导入当前生态系统。导入来自<a href="#importupload">ImportUpload</a> 合约加载的数据。</p> <p>参数：</p> <blockquote><ul><li><em>Data string</em> - 以文本内容格式导入的数据，该数据来自生态系统导出的文件。</li></ul></blockquote> <h3 id="importupload"><a href="#importupload" class="header-anchor">#</a> ImportUpload </h3> <p>将外部应用程序文件加载到当前生态系统的 <em>buffer_data</em> 表中，以便后续导入。</p> <p>参数：</p> <blockquote><ul><li><em>InputFile file</em> - 写入当前生态系统的 <em>buffer_data</em> 表的文件。</li></ul></blockquote> <h3 id="newappparam"><a href="#newappparam" class="header-anchor">#</a> NewAppParam </h3> <p>当前生态系统添加新的应用程序参数。</p> <p>参数：</p> <blockquote><ul><li><em>ApplicationId int</em> - 应用程序ID；</li> <li><em>Name string</em> - 参数名称；</li> <li><em>Value string</em> - 参数值；</li> <li><em>Conditions string</em> - 更改参数的权限。</li></ul></blockquote> <h3 id="editappparam"><a href="#editappparam" class="header-anchor">#</a> EditAppParam </h3> <p>更改当前生态系统中的现有应用程序参数。</p> <p>参数：</p> <blockquote><ul><li><em>Id int</em> - 应用程序参数ID；</li> <li><em>Value string &quot;optional&quot;</em> - 新参数值；</li> <li><em>Conditions string &quot;optional&quot;</em> - 更改参数的新权限。</li></ul></blockquote> <h3 id="newdelayedcontract"><a href="#newdelayedcontract" class="header-anchor">#</a> NewDelayedContract </h3> <p>向延迟调度合约守护进程添加新任务。</p> <p>延迟调度合约守护进程运行当前生成的区块所需的合约。</p> <p>参数：</p> <blockquote><ul><li><em>Contract string</em> - 合约名称；</li> <li><em>EveryBlock int</em> - 合约将在指定每隔区块数量后执行；</li> <li><em>Conditions string</em> - 更改任务的权限；</li> <li><em>BlockID int &quot;optional&quot;</em> - 开始启动合约的区块ID，如果未指定，则自动计算&quot;当前区块ID&quot;+<em>EveryBlock</em>；</li> <li><em>Limit int &quot;optional&quot;</em> - 任务的启动次数，如果未指定，则启动合约的任务将无限次执行。</li></ul></blockquote> <h3 id="editdelayedcontract"><a href="#editdelayedcontract" class="header-anchor">#</a> EditDelayedContract </h3> <p>更改延迟调度合约守护进程中的任务。</p> <p>参数：</p> <blockquote><ul><li><em>Id int</em> - 任务ID。</li> <li><em>Contract string</em> - 合约名称。</li> <li><em>EveryBlock int</em> - 合约将在指定每隔区块数量后执行；</li> <li><em>Conditions string</em> - 更改任务的权限；</li> <li><em>BlockID int &quot;optional&quot;</em> - 开始启动合约的区块ID，如果未指定，则自动计算&quot;当前区块ID&quot;+ <em>EveryBlock</em>；</li> <li><em>Limit int &quot;optional&quot;</em> - 任务的启动次数，如果未指定，则启动合约的任务将无限次执行。</li> <li><em>Deleted int &quot;optional&quot;</em> - 任务切换。值为 <code>1</code> 将禁用该任务。值为 <code>0</code> 将启用该任务。</li></ul></blockquote> <h3 id="uploadbinary"><a href="#uploadbinary" class="header-anchor">#</a> UploadBinary </h3> <p>在 <em>X_binaries</em> 表中添加或覆盖静态文件。通过HTTP API调用合约时，请求格式必须使用<code>multipart/form-data</code>；</p> <p>该DataMimeType参数将与表单数据一起使用。</p> <p>参数：</p> <blockquote><ul><li><em>Name string</em> - 静态文件名称；</li> <li><em>Data bytes</em> - 静态文件的内容；</li> <li><em>DataMimeType string &quot;optional&quot;</em> - <em>mime-type</em> 文件格式的静态文件；</li> <li><em>ApplicationId int</em> - 关联 <em>X_binaries</em> 表的应用程序ID。</li></ul></blockquote> <p>如果未传递 <em>DataMimeType</em> 参数，则默认使用 <code>application/octet-stream</code> 格式。</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/IBAX-io/documentation/edit/master/docs/zh-CN/topics/script.md" target="_blank" rel="noopener noreferrer">在 GitHub 上编辑此页</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2023/6/25 15:46:02</span></div></footer> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/zh-CN/topics/templates2.html">
        模版语言 
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.8ffd1d30.js" defer></script><script src="/assets/js/2.8d94a0db.js" defer></script><script src="/assets/js/164.7f63800f.js" defer></script>
  </body>
</html>
