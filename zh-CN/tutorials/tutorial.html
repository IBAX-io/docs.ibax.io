<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>IBAX开发教程 </a></li><li><a href="/zh-CN/tutorials/tutorial.html" aria-current="page" class="active sidebar-link">IBAX开发教程 </a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/zh-CN/tutorials/tutorial.html#getting-started-guide" class="sidebar-link">入门指南 </a></li><li class="sidebar-sub-header"><a href="/zh-CN/tutorials/tutorial.html#deployment" class="sidebar-link">部署 </a></li><li class="sidebar-sub-header"><a href="/zh-CN/tutorials/tutorial.html#advanced-guide" class="sidebar-link">进阶指南 </a></li><li class="sidebar-sub-header"><a href="/zh-CN/tutorials/tutorial.html#deploy-first-smart-contract-via-command-line-tool" class="sidebar-link">通过命令行工具部署第一个智能合约 </a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/zh-CN/tutorials/tutorial.html#create-application" class="sidebar-link">创建应用 </a></li><li class="sidebar-sub-header"><a href="/zh-CN/tutorials/tutorial.html#writing-contracts" class="sidebar-link">编写智能合约 </a></li><li class="sidebar-sub-header"><a href="/zh-CN/tutorials/tutorial.html#create-contract" class="sidebar-link">创建智能合约 </a></li></ul></li><li class="sidebar-sub-header"><a href="/zh-CN/tutorials/tutorial.html#command-line-tool-eco-development" class="sidebar-link">命令行工具生态开发 </a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/zh-CN/tutorials/tutorial.html#step-1-create-ecosystem" class="sidebar-link">第1步创建生态 </a></li><li class="sidebar-sub-header"><a href="/zh-CN/tutorials/tutorial.html#step-2-create-application" class="sidebar-link">第2步创建应用 </a></li><li class="sidebar-sub-header"><a href="/zh-CN/tutorials/tutorial.html#step-3-create-table" class="sidebar-link">第3步创建数据表 </a></li><li class="sidebar-sub-header"><a href="/zh-CN/tutorials/tutorial.html#step-4-create-application-parameters" class="sidebar-link">第4步创建应用参数 </a></li><li class="sidebar-sub-header"><a href="/zh-CN/tutorials/tutorial.html#step-5-create-contract-deploy-contract" class="sidebar-link">第5步创建智能合约部署智能合约 </a></li><li class="sidebar-sub-header"><a href="/zh-CN/tutorials/tutorial.html#step-6-create-ecological-parameters" class="sidebar-link">第6步设置生态参数 </a></li><li class="sidebar-sub-header"><a href="/zh-CN/tutorials/tutorial.html#step-7-add-localization" class="sidebar-link">第7步添加本地化 </a></li><li class="sidebar-sub-header"><a href="/zh-CN/tutorials/tutorial.html#step-8-modify-the-contract" class="sidebar-link">第8步修改智能合约 </a></li></ul></li><li class="sidebar-sub-header"><a href="/zh-CN/tutorials/tutorial.html#deploy-application-using-command-line-tools" class="sidebar-link">使用命令行工具部署应用 </a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/zh-CN/tutorials/tutorial.html#export-application" class="sidebar-link">导出应用 </a></li><li class="sidebar-sub-header"><a href="/zh-CN/tutorials/tutorial.html#import-application" class="sidebar-link">导入应用 </a></li></ul></li><li class="sidebar-sub-header"><a href="/zh-CN/tutorials/tutorial.html#ecological-configuration-using-command-line-tool" class="sidebar-link">使用命令行工具生态配置 </a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/zh-CN/tutorials/tutorial.html#apply-to-join-the-ecosystem" class="sidebar-link">申请加入生态 </a></li><li class="sidebar-sub-header"><a href="/zh-CN/tutorials/tutorial.html#add-ecosystem-members" class="sidebar-link">添加生态成员 </a></li><li class="sidebar-sub-header"><a href="/zh-CN/tutorials/tutorial.html#freezing-of-accounts" class="sidebar-link">冻结账户 </a></li><li class="sidebar-sub-header"><a href="/zh-CN/tutorials/tutorial.html#role-management" class="sidebar-link">角色管理 </a></li><li class="sidebar-sub-header"><a href="/zh-CN/tutorials/tutorial.html#issuance-of-token" class="sidebar-link">生态代币发行 </a></li><li class="sidebar-sub-header"><a href="/zh-CN/tutorials/tutorial.html#eco-deduction" class="sidebar-link">生态代扣 </a></li><li class="sidebar-sub-header"><a href="/zh-CN/tutorials/tutorial.html#dao-governance-ecosystem" class="sidebar-link">DAO治理生态 </a></li></ul></li><li class="sidebar-sub-header"><a href="/zh-CN/tutorials/tutorial.html#deploy-applications-using-application-packaging-tool" class="sidebar-link">使用应用打包工具部署应用 </a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="ibax-development-tutorial"><a href="#ibax-development-tutorial" class="header-anchor">#</a> IBAX开发教程 </h1> <h2 id="getting-started-guide"><a href="#getting-started-guide" class="header-anchor">#</a> 入门指南 </h2> <ul><li><a href="#deploy-first-smart-contract-via-command-line-tool">通过命令行工具部署第一个智能合约</a></li> <li><a href="#command-line-tool-eco-development">命令行工具生态开发</a></li></ul> <h2 id="deployment"><a href="#deployment" class="header-anchor">#</a> 部署 </h2> <ul><li><a href="#deploy-application-using-command-line-tools">使用命令行工具部署应用</a></li> <li><a href="#ecological-configuration-using-command-line-tool">使用命令行工具生态配置</a></li></ul> <h2 id="advanced-guide"><a href="#advanced-guide" class="header-anchor">#</a> 进阶指南 </h2> <ul><li><a href="#deploy-applications-using-application-packaging-tool">使用应用打包工具部署应用</a></li></ul> <h2 id="deploy-first-smart-contract-via-command-line-tool"><a href="#deploy-first-smart-contract-via-command-line-tool" class="header-anchor">#</a> 通过命令行工具部署第一个智能合约 </h2> <p>我们将通过<a href="https://github.com/IBAX-io/ibax-cli" target="_blank" rel="noopener noreferrer">命令行工具<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 在IBAX区块链上部署<a href="/zh-CN/concepts/thesaurus.html#smart-contract">智能合约</a> , 并学习何如调用智能合约。作为我们的第一个智能合约，我们将其部署到<a href="/zh-CN/concepts/blockchain-layers.html">本地测试网络</a> 上，如何部署本地网络你可以参考<a href="/zh-CN/howtos/deployment.html">网络部署</a> , 因此您不需要任何开销就可以随意部署和运行它。</p> <h3 id="create-application"><a href="#create-application" class="header-anchor">#</a> 创建应用 </h3> <p>调用智能合约@1NewApplication创建应用，该智能合约有一个应用名称参数和一个修改<a href="/zh-CN/concepts/about-the-platform.html#access-rights-control-mechanism">权限参数</a> 。</p> <div class="language-text extra-class"><pre class="language-text"><code>1    $ ibax-cli console
2    
3    Welcome to the IBAX console!
4    To exit, press ctrl-d or type exit
5  &gt;callContract @1NewApplication {&quot;Name&quot;: &quot;testapp&quot;, &quot;Conditions&quot;: &quot;ContractConditions(\&quot;@1DeveloperCondition\&quot;)&quot;}
6  
7  {
8      &quot;block_id&quot;: 1217,
9      &quot;hash&quot;: &quot;6327161d2202c33c06d34ab4ed9b509c05fc2cbb15cf260c6d3d404a6f640028&quot;,
10      &quot;penalty&quot;: 0,
11      &quot;err&quot;: &quot;31&quot;
12  }
</code></pre></div><p>下面按行解释：</p> <ul><li>第1行，启动命令行终端。</li> <li>第5行，调用智能合约@1NewApplication创建一个应用，应用名称为<code>testapp</code>,应用修改权限为开发者权限<code>@1DeveloperCondition</code>。</li> <li>第8行，交易产生的区块id。</li> <li>第9行，交易产生的区块哈希。</li> <li>第10行，如果交易执行失败（0：无惩罚 1：惩罚）。</li> <li>第11行，如果交易执行失败，则返回一条错误文本消息，如果返回了区块id，err字段为该应用的id。</li></ul> <p>当然如果你想查看这个智能合约有哪些字段，字段类型，可以调用<code>getContractInfo</code>方法,它将返回智能合约信息，如下：</p> <div class="language-text extra-class"><pre class="language-text"><code>&gt;getContractInfo @1NewApplication

{
    &quot;id&quot;: 5022,
    &quot;state&quot;: 1,
    &quot;tableid&quot;: &quot;22&quot;,
    &quot;walletid&quot;: &quot;0&quot;,
    &quot;tokenid&quot;: &quot;1&quot;,
    &quot;address&quot;: &quot;0000-0000-0000-0000-0000&quot;,
    &quot;fields&quot;: [
        {
            &quot;name&quot;: &quot;Name&quot;,
            &quot;type&quot;: &quot;string&quot;,
            &quot;optional&quot;: false
        },
        {
            &quot;name&quot;: &quot;Conditions&quot;,
            &quot;type&quot;: &quot;string&quot;,
            &quot;optional&quot;: false
        },
        {
            &quot;name&quot;: &quot;VotingId&quot;,
            &quot;type&quot;: &quot;int&quot;,
            &quot;optional&quot;: true
        }
    ],
    &quot;name&quot;: &quot;@1NewApplication&quot;,
    &quot;app_id&quot;: 1,
    &quot;ecosystem&quot;: 1,
    &quot;conditions&quot;: &quot;ContractConditions(\&quot;@1DeveloperCondition\&quot;)&quot;
}
</code></pre></div><p><code>fields</code>字段为该智能合约的参数,包括参数的名称<code>name</code>，类型<code>type</code>，可选项<code>optional</code>，<code>Name</code>和<code>Conditions</code>为必填项，<code>VotingId</code>为可选项,可参考<a href="/zh-CN/reference/api2.html#contract-name">contract/name</a>  API方法。</p> <h3 id="writing-contracts"><a href="#writing-contracts" class="header-anchor">#</a> 编写智能合约 </h3> <p>我们使用<a href="/zh-CN/topics/script.html#needle-contract-language">Needle</a> 编写智能合约，我们实现一个简单的加法运算，智能合约源码如下,我们将智能合约保存为<code>SumMath.sim</code>。</p> <div class="language-text extra-class"><pre class="language-text"><code>1    contract SumMath {
2        data {
3            A int
4            B int
5        }
6        conditions {
7    
8        }
9        action {
10            var sum int
11            sum = $A + $B
12            $result = sum
13        }
14    }
</code></pre></div><p>下面按行解释：</p> <ul><li>第1行，我们定义了一个名称为SumMath的智能合约。</li> <li>第2行, <a href="/zh-CN/topics/script.html#data-section">数据部分</a> 。</li> <li>第3-第4行，我们定义了两个输入64位整数型参数<code>A B</code>。</li> <li>第6行,<a href="/zh-CN/topics/script.html#conditions-section">条件部分</a> 。</li> <li>第9行,<a href="/zh-CN/topics/script.html#action-section">操作部分</a> 我们定义了一个变量sum，用于接收A+B结果，将sum的值赋给$result,作为智能合约的返回结果.当然也可以直接将A+B的值赋给$result，但它可以作为一个例子展示.</li></ul> <h3 id="create-contract"><a href="#create-contract" class="header-anchor">#</a> 创建智能合约 </h3> <p>有两种方法创建智能合约，第一种方法：</p> <p>第一步我们编写一个智能合约参数文件，文件格式为json：</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;ApplicationId&quot;</span><span class="token operator">:</span> <span class="token number">31</span><span class="token punctuation">,</span>
  <span class="token property">&quot;Value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;contract SumMath {\n    data {\n        A int\n        B int\n    }\n    conditions {\n\n    }\n    action {\n        var sum int\n        sum = $A + $B\n        $result = sum\n    }\n}&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;Conditions&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ContractConditions(\&quot;@1DeveloperCondition\&quot;)&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>其中<code>ApplicationId</code>为应用id,<code>Value</code>为智能合约源码，需要对特殊字符进行转义处理，<code>Conditions</code>为该智能合约修改权限。</p> <p>我们将它命名为<code>SumMathParams.json</code>。</p> <p>第二步调用创建智能合约@1NewContract。</p> <div class="language- extra-class"><pre class="language-text"><code>1    &gt;callContract @1NewContract -f=./data/SumMathParams.json
2    {
3        &quot;block_id&quot;: 1238,
4        &quot;hash&quot;: &quot;f3fe7aff8a613c96299723b7e9af0682aa8cabe7becf67a485e2a77a974f58b6&quot;,
5        &quot;penalty&quot;: 0,
6        &quot;err&quot;: &quot;328&quot;
7    }
</code></pre></div><p>第二种方法：</p> <p>直接将保存的智能合约源码文件传入智能合约参数中，参数格式为<code>参数名称</code>+ <code>-</code> + &quot;file&quot;,<code>paramsName-file</code>如下：</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token number">1</span>    <span class="token operator">&gt;</span>callContract @1NewContract <span class="token punctuation">{</span><span class="token string">&quot;ApplicationId&quot;</span><span class="token builtin class-name">:</span> <span class="token number">31</span>, <span class="token string">&quot;Value-file&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;SumMath.sim&quot;</span>, <span class="token string">&quot;Conditions&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;true&quot;</span><span class="token punctuation">}</span>    
<span class="token number">2</span>    <span class="token punctuation">{</span>
<span class="token number">3</span>        <span class="token string">&quot;block_id&quot;</span><span class="token builtin class-name">:</span> <span class="token number">2055</span>,
<span class="token number">4</span>        <span class="token string">&quot;hash&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;cdf25060669cf7cba137278...26ca463fd5d458f3402a5f0137f693db&quot;</span>,
<span class="token number">5</span>        <span class="token string">&quot;penalty&quot;</span><span class="token builtin class-name">:</span> <span class="token number">0</span>,
<span class="token number">6</span>        <span class="token string">&quot;err&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;368&quot;</span>
<span class="token number">7</span>    <span class="token punctuation">}</span>
</code></pre></div><p>下面按行解释：</p> <ul><li>第1行：调用智能合约@1NewContract创建智能合约，-f使用文件导入智能合约参数。</li> <li>第3行，交易产生的区块id。</li> <li>第4行，交易产生的区块哈希。</li> <li>第5行，如果交易执行失败（0：无惩罚 1：惩罚）。</li> <li>第6行，如果交易执行失败，则返回一条错误文本消息，如果返回了区块id，err字段为该智能合约的id。</li></ul> <p>我们试着调用一下刚刚部署的智能合约。</p> <div class="language- extra-class"><pre class="language-text"><code>1  &gt;callContract @5SumMath {&quot;A&quot;:1, &quot;B&quot;:2}
2  
3  {
4      &quot;block_id&quot;: 1239,
5      &quot;hash&quot;: &quot;7fa09da0b9f65634119a910f9d91aaf4927208278efd62961499ef7e4f4c8c9c&quot;,
6      &quot;penalty&quot;: 0,
7      &quot;err&quot;: &quot;3&quot;
8  }
</code></pre></div><p>调用完成，结果符合预期,下面按行解释：</p> <ul><li>第1行调用智能合约，这里我们将智能合约部署到了生态id为5的生态里，当然如果当前所在生态id为5,同一个生态中时，也可以这么调用<code>callContract SumMath {&quot;A&quot;:1, &quot;B&quot;:2}</code>。</li> <li>第3行，交易产生的区块id。</li> <li>第4行，交易产生的区块哈希。</li> <li>第5行，如果交易执行失败（0：无惩罚 1：惩罚）。</li> <li>第6行，如果交易执行失败，则返回一条错误文本消息，如果返回了区块id，err字段为该智能合约的结果，也就是<code>$result</code>的值。</li></ul> <h2 id="command-line-tool-eco-development"><a href="#command-line-tool-eco-development" class="header-anchor">#</a> 命令行工具生态开发 </h2> <p>在本教程中，您将学习如何：
1、<a href="#step-1-create-ecosystem">创建生态</a>
2、<a href="#step-2-create-application">创建应用</a>
3、<a href="#step-3-create-table">创建数据表</a>
4、<a href="#step-4-create-application-parameters">创建应用参数</a>
5、<a href="#step-5-create-contract-deploy-contract">创建和部署智能合约</a>
6、<a href="#step-6-create-ecological-parameters">创建生态参数</a>
7、<a href="#step-7-add-localization">添加本地化</a>
8、<a href="#step-8-modify-the-contract">修改智能合约</a>
9、<a href="#step-9-modify-data-table-permissions">修改数据表权限</a></p> <p>为了更清楚的了解IBAX生态与应用是怎么样的，做什么用的，首选我们了解一下生态和应用应该属于那一部分，我们通过一个简单的思维导图可以更好的理解：
<img src="ibax-eco.png" alt="image"></p> <p>可以看到IBAX网络可以有许多<a href="/zh-CN/concepts/about-the-platform.html#ecolib">生态</a> ,每个生态可以有多个<a href="/zh-CN/concepts/about-the-platform.html#applications">应用</a> ,每个应用都有<a href="/zh-CN/concepts/thesaurus.html#smart-contract">智能合约</a> ,<a href="/zh-CN/concepts/about-the-platform.html#tables">数据表</a> , 生态有生态参数，应用有应用参数</p> <h3 id="step-1-create-ecosystem"><a href="#step-1-create-ecosystem" class="header-anchor">#</a> 第1步创建生态 </h3> <p>我们先使用<a href="https://github.com/IBAX-io/ibax-cli" target="_blank" rel="noopener noreferrer">命令行工具<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 创建一个生态, 调用智能合约@1NewEcosystem.如果你想修改生态名称，可以调用<code>@1EditEcosystemName</code>智能合约.</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token number">1</span>    $ ibax-cli console
<span class="token number">2</span>    
<span class="token number">3</span>    Welcome to the IBAX console<span class="token operator">!</span>
<span class="token number">4</span>    To exit, press ctrl-d or <span class="token builtin class-name">type</span> <span class="token builtin class-name">exit</span>
<span class="token number">5</span>    <span class="token operator">&gt;</span>callContract @1NewEcosystem <span class="token punctuation">{</span><span class="token string">&quot;Name&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;goodBoy school&quot;</span><span class="token punctuation">}</span>
<span class="token number">6</span>    
<span class="token number">7</span>    <span class="token punctuation">{</span>
<span class="token number">8</span>        <span class="token string">&quot;block_id&quot;</span><span class="token builtin class-name">:</span> <span class="token number">1199</span>,
<span class="token number">9</span>        <span class="token string">&quot;hash&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;a1dc90c1772545c16394b9521...227676b27b145743556a8973dd&quot;</span>,
<span class="token number">10</span>       <span class="token string">&quot;penalty&quot;</span><span class="token builtin class-name">:</span> <span class="token number">0</span>,
<span class="token number">11</span>       <span class="token string">&quot;err&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;18&quot;</span>
<span class="token number">12</span>   <span class="token punctuation">}</span>
</code></pre></div><p>下面按行解释：</p> <ul><li>第1行，启动了命令行控制台程序。</li> <li>第5行，调用智能合约@1NewEcosystem创建一个生态，该生态名称为<code>test ecosystem</code>。</li> <li>第8行，交易产生的区块id。</li> <li>第9行，交易产生的区块哈希。</li> <li>第10行，如果交易执行失败（0：无惩罚 1：惩罚）。</li> <li>第11行，如果交易执行失败，则返回一条错误文本消息，如果返回了区块id，err字段为该生态的id为<code>18</code>。</li></ul> <p>然后我们配置命令工具<code>config.yml</code>，将<code>ecosystem</code>设置为创建的生态id<code>18</code>，重新启动命令行控制台程序。</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token operator">&gt;</span>exit
INFO<span class="token punctuation">[</span>0002<span class="token punctuation">]</span> Exit

$ <span class="token function">vim</span> data/config.yml

$ ibax-cli console

Welcome to the IBAX console<span class="token operator">!</span>
To exit, press ctrl-d or <span class="token builtin class-name">type</span> <span class="token builtin class-name">exit</span>
<span class="token operator">&gt;</span>
</code></pre></div><h3 id="step-2-create-application"><a href="#step-2-create-application" class="header-anchor">#</a> 第2步创建应用 </h3> <p>调用智能合约<code>@1NewApplication</code>创建应用，该智能合约有一个应用名称参数和一个修改<a href="https://docs.ibax.io/concepts/about-the-platform.html#access-rights-control-mechanism" target="_blank" rel="noopener noreferrer">权限参数<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 。</p> <div class="language-text extra-class"><pre class="language-text"><code>1  &gt;callContract @1NewApplication {&quot;Name&quot;: &quot;GradesRecorder&quot;, &quot;Conditions&quot;: &quot;ContractConditions(\&quot;@1DeveloperCondition\&quot;)&quot;}
2  
3  {
4     &quot;block_id&quot;: 1246,
5     &quot;hash&quot;: &quot;85ab8953d26d0d1047fc610866115331babfaf88c80792d50b41826185c9f6f8&quot;,
6     &quot;penalty&quot;: 0,
7     &quot;err&quot;: &quot;47&quot;
8  }
</code></pre></div><p>如果你需要修改应用权限，可以调用<code>EditApplication</code>智能合约。</p> <p>下面按行解释：</p> <ul><li>第1行，调用智能合约@1NewApplication创建一个应用，应用名称为<code>GradesRecorder</code>,应用修改权限为开发者权限<code>@1DeveloperCondition</code>。</li> <li>第4行，交易产生的区块id。</li> <li>第5行，交易产生的区块哈希。</li> <li>第6行，如果交易执行失败（0：无惩罚 1：惩罚）。</li> <li>第7行，如果交易执行失败，则返回一条错误文本消息，如果返回了区块id，err字段该应用的id为<code>47</code>。</li></ul> <p>我们写一个简单的例子，这个应用可以记录学生的成绩，数据表字段包括学生的信息，年级<code>grade</code>，班级<code>class</code>，科目成绩<code>mathematics,physics,literature</code>，综合评分<code>overall_score</code>，评级<code>score</code>,创建时间戳（ms）<code>created_at</code>。</p> <h3 id="step-3-create-table"><a href="#step-3-create-table" class="header-anchor">#</a> 第3步创建数据表 </h3> <p>第一步我们编写一个智能合约参数文件，文件格式为json：</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;ApplicationId&quot;</span><span class="token operator">:</span> <span class="token number">47</span><span class="token punctuation">,</span>
  <span class="token property">&quot;Name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;grade_info&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;ColumnsArr&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">&quot;student&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;grade&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;class&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;mathematics&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;physics&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;literature&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;overall_score&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;score&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;created_at&quot;</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;TypesArr&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">&quot;varchar&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;number&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;number&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;number&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;number&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;number&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;number&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;varchar&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;number&quot;</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;InsertPerm&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ContractConditions(\&quot;MainCondition\&quot;)&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;UpdatePerm&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ContractConditions(\&quot;MainCondition\&quot;)&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;ReadPerm&quot;</span><span class="token operator">:</span> <span class="token string">&quot;true&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;NewColumnPerm&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ContractConditions(\&quot;MainCondition\&quot;)&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>其中<code>ApplicationId</code>为应用id,<code>Name</code>为创建的数据表名<code>test_teble</code>，<code>ColumnsArr</code>为数据表字段数组，<code>TypesArr</code>为数据表字段的类型，包括9种<a href="/zh-CN/concepts/about-the-platform.html#tables">类型</a> 。<code>varchar</code>,<code>character</code>,<code>json</code>,<code>number</code>,<code>datetime</code>,<code>double</code>,<code>money</code>,<code>text</code>,<code>bytea</code>,字段名跟字段类型是一一对应关系，<code>InsertPerm</code>为数据表新建条目权限，<code>UpdatePerm</code>为数据表更新条目权限，<code>ReadPerm</code>为数据表数据读取权限，<code>NewColumnPerm</code>为新建数据表字段权限。参考<a href="/zh-CN/concepts/about-the-platform.html#access-rights-control-mechanism">权限管理</a> ,这里的<code>ContractConditions(\&quot;MainCondition\&quot;)</code>为当前生态创建者可用。</p> <p>我们将它命名为createTable.json,然后调用智能合约创建数据表<code>@1NewTableJoint</code>。</p> <div class="language-text extra-class"><pre class="language-text"><code>&gt;callContract @1NewTableJoint -f ./createTestTable.json
</code></pre></div><h4 id="modify-data-table-field-permissions"><a href="#modify-data-table-field-permissions" class="header-anchor">#</a> 修改数据表字段权限 </h4> <p>我们可以修改数据表字段权限,数据表字段权限包括读取权限和更新权限，其中读取权限，在智能合约使用<code>DBFind.Columns</code>筛选字段或者接口如<a href="https://docs.ibax.io/reference/api2.html#list-name-limit-offset-columns" target="_blank" rel="noopener noreferrer">list<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 查询时,如果没有权限则会报权限错误,更新权限即为更新数据表字段的权限。 我们将<code>student</code>字段读取和更新权限设置为<code>false</code>，当然也可以设置为某个智能合约可操作。 调用<code>@1EditColumn</code>智能合约修改数据表字段权限。</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token operator">&gt;</span>callContract @1EditColumn <span class="token punctuation">{</span><span class="token string">&quot;TableName&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;grade_info&quot;</span>, <span class="token string">&quot;Name&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;student&quot;</span>, <span class="token string">&quot;UpdatePerm&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;false&quot;</span>, <span class="token string">&quot;ReadPerm&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;false&quot;</span><span class="token punctuation">}</span>
</code></pre></div><p>我们可以创建几个应用参数<code>grade_best_type</code>,<code>grade_type_a+</code>,<code>grade_type_a</code>,<code>grade_type_b+</code>,<code>grade_type_b</code>,<code>grade_type_c</code>,成绩评级类型。</p> <h3 id="step-4-create-application-parameters"><a href="#step-4-create-application-parameters" class="header-anchor">#</a> 第4步创建应用参数 </h3> <p>调用智能合约<code>@1NewAppParam</code>创建应用参数,如果你要修改应用参数可以调用<code>@1EditAppParam</code>智能合约.</p> <div class="language-text extra-class"><pre class="language-text"><code>&gt;callContract @1NewAppParam {&quot;ApplicationId&quot;: 47, &quot;Name&quot;: &quot;grade_best_type&quot;, &quot;Value&quot;: &quot;A+&quot;, &quot;Conditions&quot;: &quot;ContractConditions(\&quot;MainCondition\&quot;)&quot;}
&gt;callContract @1NewAppParam {&quot;ApplicationId&quot;: 47, &quot;Name&quot;: &quot;grade_type_a+&quot;, &quot;Value&quot;: &quot;{\&quot;max\&quot;: 101,\&quot;min\&quot;: 90}&quot;, &quot;Conditions&quot;: &quot;ContractConditions(\&quot;MainCondition\&quot;)&quot;}
&gt;callContract @1NewAppParam {&quot;ApplicationId&quot;: 47, &quot;Name&quot;: &quot;grade_type_a&quot;, &quot;Value&quot;: &quot;{\&quot;max\&quot;: 90,\&quot;min\&quot;: 80}&quot;, &quot;Conditions&quot;: &quot;ContractConditions(\&quot;MainCondition\&quot;)&quot;}
&gt;callContract @1NewAppParam {&quot;ApplicationId&quot;: 47, &quot;Name&quot;: &quot;grade_type_b+&quot;, &quot;Value&quot;: &quot;{\&quot;max\&quot;: 80,\&quot;min\&quot;: 70}&quot;, &quot;Conditions&quot;: &quot;ContractConditions(\&quot;MainCondition\&quot;)&quot;}
&gt;callContract @1NewAppParam {&quot;ApplicationId&quot;: 47, &quot;Name&quot;: &quot;grade_type_b&quot;, &quot;Value&quot;: &quot;{\&quot;max\&quot;: 70,\&quot;min\&quot;: 60}&quot;, &quot;Conditions&quot;: &quot;ContractConditions(\&quot;MainCondition\&quot;)&quot;}
&gt;callContract @1NewAppParam {&quot;ApplicationId&quot;: 47, &quot;Name&quot;: &quot;grade_type_c&quot;, &quot;Value&quot;: &quot;{\&quot;max\&quot;: 60,\&quot;min\&quot;: 0}&quot;, &quot;Conditions&quot;: &quot;ContractConditions(\&quot;MainCondition\&quot;)&quot;}
</code></pre></div><p>其中<code>grade_best_type</code>为最好的评级类型，<code>grade_type_a+</code>为评级<code>A+</code>所触发的条件，当分数大于等于90并且小于101时，评为<code>A+</code>,其他参数类似。</p> <h3 id="step-5-create-contract-deploy-contract"><a href="#step-5-create-contract-deploy-contract" class="header-anchor">#</a> 第5步创建智能合约部署智能合约 </h3> <p>我们创建一个智能合约，用于记录学生各科目成绩信息与最终评级，录入信息时输入学生的年级班级与各科目成绩，根据输入的各科的成绩做平均运算，得出综合评分<code>overallScore</code>与最终评级<code>score</code>,当调用智能合约时，将创建一条记录到我们刚刚创建的数据表中<code>grade_info</code>。</p> <p>首先我们编写一个智能合约，将它命名为<code>NewRecord.sim</code>。</p> <div class="language-text extra-class"><pre class="language-text"><code>1	contract NewRecord {				
2	    data {				
3	        Student string				
4	        Grade int				
5	        Class int				
6	        Mathematics int				
7	        Physics int				
8	        Literature int				
9	    }				
10	    func getScore(a b c int) map{				
11	        var m map				
12	        var overallScore int				
13	        overallScore = (a+b+c) / 3				
14	        m[&quot;overallScore&quot;] = overallScore				
15	        if overallScore &gt;= $gradeTypeABest[&quot;min&quot;] &amp;amp;&amp;amp; overallScore &amp;lt; $gradeTypeABest[&quot;max&quot;] {				
16	            m[&quot;score&quot;] = &quot;A+&quot;				
17	        }elif overallScore &gt;= $gradeTypeA[&quot;min&quot;] &amp;amp;&amp;amp; overallScore &amp;lt; $gradeTypeA[&quot;max&quot;] {				
18	            m[&quot;score&quot;] = &quot;A&quot;				
19	        }elif overallScore &gt;= $gradeTypeBBest[&quot;min&quot;] &amp;amp;&amp;amp; overallScore &amp;lt; $gradeTypeBBest[&quot;max&quot;] {				
20	            m[&quot;score&quot;] = &quot;B+&quot;				
21	        }elif overallScore &gt;= $gradeTypeB[&quot;min&quot;] &amp;amp;&amp;amp; overallScore &amp;lt; $gradeTypeB[&quot;max&quot;] {				
22	            m[&quot;score&quot;] = &quot;B&quot;				
23	        }elif overallScore &gt;= $gradeTypeC[&quot;min&quot;] &amp;amp;&amp;amp; overallScore &amp;lt; $gradeTypeC[&quot;max&quot;]{				
24	            m[&quot;score&quot;] = &quot;C&quot;				
25	        }else{				
26	            m[&quot;score&quot;] = &quot;Notset&quot;				
27	        }				
28	        return m				
29	    }				
30	    func safeJsonDecode(m string) map {				
31	        var res map				
32	        if Size(m) &gt; 0 {				
33	            res = JSONDecode(m)				
34	        }				
35	        return res				
36	    }				
37					
38	    conditions {				
39	        if Size($Student) == 0 {				
40	            warning &quot;Student Can not be empty&quot;				
41	        }				
42	        if $Class &amp;lt;= 0{				
43	            warning &quot;Class cannot be less than or equal to zero&quot;				
44	        }				
45	        if $Grade &amp;lt;= 0{				
46	            warning &quot;Grade cannot be less than or equal to zero&quot;				
47	        }				
48	        if $Mathematics &amp;lt; 0 {				
49	            warning &quot;Mathematics cannot be less than zero&quot;				
50	        }				
51	        if $Physics &amp;lt; 0 {				
52	            warning &quot;Physics cannot be less than zero&quot;				
53	        }				
54	        if $Literature &amp;lt; 0 {				
55	            warning &quot;Literature cannot be less than zero&quot;				
56	        }				
57	        if $Mathematics &gt; 100 || $Physics &gt; 100 ||  $Literature &gt; 100{				
58	            warning &quot;Score cannot exceed 100&quot;				
59	        }				
60	        var app map				
61	        app = DBFind(&quot;@1applications&quot;).Columns(&quot;id,ecosystem&quot;).Where({&quot;ecosystem&quot;: 18,&quot;name&quot;:&quot;GradesRecorder&quot;,&quot;deleted&quot;:0}).Row()				
62	        if !app {				
63	            warning LangRes(&quot;@1app_not_found&quot;)				
64	        }				
65					
66	        var app_id int				
67	        app_id = Int(app[&quot;id&quot;])				
68	        $eId = Int(app[&quot;ecosystem&quot;])				
69	        $gradeBestType = AppParam(app_id, &quot;grade_best_type&quot;, $eId)				
70	        $gradeTypeABest = safeJsonDecode(AppParam(app_id, &quot;grade_type_a+&quot;, $eId))				
71	        $gradeTypeA = safeJsonDecode(AppParam(app_id, &quot;grade_type_a&quot;, $eId))				
72	        $gradeTypeBBest = safeJsonDecode(AppParam(app_id, &quot;grade_type_b+&quot;, $eId))				
73	        $gradeTypeB = safeJsonDecode(AppParam(app_id, &quot;grade_type_b&quot;, $eId))				
74	        $gradeTypeC = safeJsonDecode(AppParam(app_id, &quot;grade_type_c&quot;, $eId))				
75	    }				
76	    action {				
77	        var m map 				
78	        m = getScore($Mathematics,$Physics,$Literature)				
79	        var in map				
80	        in[&quot;student&quot;] = $Student				
81	        in[&quot;class&quot;] = $Class				
82	        in[&quot;grade&quot;] = $Grade				
83	        in[&quot;mathematics&quot;] = $Mathematics				
84	        in[&quot;physics&quot;] = $Physics 				
85	        in[&quot;literature&quot;] = $Literature 				
86	        in[&quot;overall_score&quot;] = m[&quot;overallScore&quot;]				
87	        in[&quot;score&quot;] = m[&quot;score&quot;]				
88	        in[&quot;created_at&quot;] = $time				
89	        DBInsert(&quot;@&quot;+ Str($eId)+&quot;grade_info&quot;, in)				
90	    }				
91	}				
</code></pre></div><p>下面按行解释：</p> <ul><li>第2行，<a href="/zh-CN/topics/script.html#data-section">数据部分</a> 定义了输入参数<code>Student</code>学生名称,<code>Grade</code>年级,<code>Class</code>班级,<code>Mathematics</code>数学分数,<code>Physics</code>物理分数,<code>Literature</code>文学分数。</li> <li>第10行，getScore函数，根据各科成绩得出综合评分与最终评级。</li> <li>第30行，safeJsonDecode函数，将字符串进行json解码并转为map。</li> <li>第38行，<a href="/zh-CN/topics/script.html#conditions-section">条件部分</a> 。</li> <li>第39行，<a href="/zh-CN/topics/script.html#action-section">操作部分</a> 。</li></ul> <p>可以看到，当智能合约被调用时，首先走条件部分，验证智能合约输入参数是否有效，比如学生名称<code>if Size($Student) == 0 {</code>是否为空(第39行)，如果为空，则返回报错信息。<code>&quot;Student Can not be empty&quot;</code>(第30行),当所有输入参数都校验通过后，第61行，使用<a href="/zh-CN/topics/script.html#dbfind">DBFind</a> 从数据库检索生态id为<code>18</code>，应用名称为<code>GradesRecorder</code>并且未删除<code>deleted=0</code>的应用信息，第69行-74行，使用<a href="/zh-CN/topics/script.html#appparam">AppParam</a> 检索应用参数， 如<code>$gradeBestType = AppParam(app_id, &quot;grade_best_type&quot;, $eId)</code>（第69行）,如果应用参数为json格式存储，如<code>grade_type_a</code>,你可以参考<code>$gradeTypeABest = safeJsonDecode(AppParam(app_id, &quot;grade_type_a+&quot;, $eId))</code>,将获取到的应用参数通过safeJsonDecode函数转为map格式。</p> <p>然后执行到操作部分，调用getScore函数获取得出综合评分与最终评级(第10行),使用map存储，第79行，定义一个map，保存学生成绩信息，<a href="/zh-CN/topics/script.html#dbinsert">DBInsert</a> 往数据表<code>@18grade_info</code>插入数据。</p> <p>有两种方法创建智能合约，第一种方法：</p> <p>首先我们编写一个智能合约参数文件，文件格式为json：</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;ApplicationId&quot;</span><span class="token operator">:</span> <span class="token number">47</span><span class="token punctuation">,</span>
  <span class="token property">&quot;Value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;contract NewRecord {\n    data {\n        Student string\n        Grade int\n        Class int\n        Mathematics int\n        Physics int\n        Literature int\n    }\n    func getScore(a b c int) map{\n        var m map\n        var overallScore int\n        overallScore = (a+b+c) / 3\n        m[\&quot;overallScore\&quot;] = overallScore\n        if overallScore &gt;= $gradeTypeABest[\&quot;min\&quot;] &amp;&amp; overallScore &lt; $gradeTypeABest[\&quot;max\&quot;] {\n            m[\&quot;score\&quot;] = \&quot;A+\&quot;\n        }elif overallScore &gt;= $gradeTypeA[\&quot;min\&quot;] &amp;&amp; overallScore &lt; $gradeTypeA[\&quot;max\&quot;] {\n            m[\&quot;score\&quot;] = \&quot;A\&quot;\n        }elif overallScore &gt;= $gradeTypeBBest[\&quot;min\&quot;] &amp;&amp; overallScore &lt; $gradeTypeBBest[\&quot;max\&quot;] {\n            m[\&quot;score\&quot;] = \&quot;B+\&quot;\n        }elif overallScore &gt;= $gradeTypeB[\&quot;min\&quot;] &amp;&amp; overallScore &lt; $gradeTypeB[\&quot;max\&quot;] {\n            m[\&quot;score\&quot;] = \&quot;B\&quot;\n        }elif overallScore &gt;= $gradeTypeC[\&quot;min\&quot;] &amp;&amp; overallScore &lt; $gradeTypeC[\&quot;max\&quot;]{\n            m[\&quot;score\&quot;] = \&quot;C\&quot;\n        }else{\n            m[\&quot;score\&quot;] = \&quot;Notset\&quot;\n        }\n        return m\n    }\n    func safeJsonDecode(m string) map {\n        var res map\n        if Size(m) &gt; 0 {\n            res = JSONDecode(m)\n        }\n        return res\n    }\n\n    conditions {\n        if Size($Student) == 0 {\n            warning \&quot;Student Can not be empty\&quot;\n        }\n        if $Class &lt;= 0{\n            warning \&quot;Class cannot be less than or equal to zero\&quot;\n        }\n         if $Grade &lt;= 0{\n            warning \&quot;Grade cannot be less than or equal to zero\&quot;\n        }\n        if $Mathematics &lt; 0 {\n            warning \&quot;Mathematics cannot be less than zero\&quot;\n        }\n        if $Physics &lt; 0 {\n            warning \&quot;Physics cannot be less than zero\&quot;\n        }\n        if $Literature &lt; 0 {\n            warning \&quot;Literature cannot be less than zero\&quot;\n        }\n        if $Mathematics &gt; 100 || $Physics &gt; 100 ||  $Literature &gt; 100{\n            warning \&quot;Score cannot exceed 100\&quot;\n        }\n        var app map\n        app = DBFind(\&quot;@1applications\&quot;).Columns(\&quot;id,ecosystem\&quot;).Where({\&quot;ecosystem\&quot;: 18,\&quot;name\&quot;:\&quot;GradesRecorder\&quot;,\&quot;deleted\&quot;:0}).Row()\n        if !app {\n            warning LangRes(\&quot;@1app_not_found\&quot;)\n        }\n\n        var app_id int\n        app_id = Int(app[\&quot;id\&quot;])\n        $eId = Int(app[\&quot;ecosystem\&quot;])\n        $gradeBestType = AppParam(app_id, \&quot;grade_best_type\&quot;, $eId)\n        $gradeTypeABest = safeJsonDecode(AppParam(app_id, \&quot;grade_type_a+\&quot;, $eId))\n        $gradeTypeA = safeJsonDecode(AppParam(app_id, \&quot;grade_type_a\&quot;, $eId))\n        $gradeTypeBBest = safeJsonDecode(AppParam(app_id, \&quot;grade_type_b+\&quot;, $eId))\n        $gradeTypeB = safeJsonDecode(AppParam(app_id, \&quot;grade_type_b\&quot;, $eId))\n        $gradeTypeC = safeJsonDecode(AppParam(app_id, \&quot;grade_type_c\&quot;, $eId))\n    }\n    action {\n        var m map \n        m = getScore($Mathematics,$Physics,$Literature)\n        var in map\n        in[\&quot;student\&quot;] = $Student\n        in[\&quot;class\&quot;] = $Class\n        in[\&quot;grade\&quot;] = $Grade\n        in[\&quot;mathematics\&quot;] = $Mathematics\n        in[\&quot;physics\&quot;] = $Physics \n        in[\&quot;literature\&quot;] = $Literature \n        in[\&quot;overall_score\&quot;] = m[\&quot;overallScore\&quot;]\n        in[\&quot;score\&quot;] = m[\&quot;score\&quot;]\n        in[\&quot;created_at\&quot;] = $time\n        DBInsert(\&quot;@\&quot;+ Str($eId)+\&quot;grade_info\&quot;, in)\n    }\n}&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;Conditions&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ContractConditions(\&quot;@1DeveloperCondition\&quot;)&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>其中<code>ApplicationId</code>为应用id,，需要对特殊字符进行转义处理，<code>Conditions</code>为该智能合约修改权限,<code>Value</code>智能合约源码，我们将它保存为<code>NewRecordParams.json</code>：</p> <p>编写完智能合约后，我们需要部署智能合约，调用创建智能合约<code>@1NewContract</code>。</p> <div class="language-text extra-class"><pre class="language-text"><code>1    &gt;&gt;callContract @1NewContract -f=./data/NewRecordParams.json
2    {
3        &quot;block_id&quot;: 1262,
4        &quot;hash&quot;: &quot;d896f12f685835f6cf71705e1ba...4d8bcc0a1406f7b0b6482b2d230fc&quot;,
5        &quot;penalty&quot;: 0,
6        &quot;err&quot;: &quot;348&quot;
7    }
</code></pre></div><p>下面按行解释：</p> <ul><li>第1行：调用智能合约<code>@1NewContract</code>创建智能合约，-f使用文件导入刚刚创建的文件<code>NewRecord.json</code>作为智能合约参数。</li> <li>第3行，交易产生的区块id。</li> <li>第4行，交易产生的区块哈希。</li> <li>第5行，如果交易执行失败（0：无惩罚 1：惩罚）。</li> <li>第6行，如果交易执行失败，则返回一条错误文本消息，如果返回了区块id，err字段该智能合约的id为<code>348</code>。</li></ul> <p>第二种方法：</p> <p>直接将保存的智能合约源码文件传入智能合约参数中，参数格式为<code>参数名称</code>+ <code>-</code> + &quot;file&quot;,<code>paramsName-file</code>如下：</p> <div class="language-shell extra-class"><pre class="language-shell"><code>callContract @1NewContract <span class="token punctuation">{</span><span class="token string">&quot;ApplicationId&quot;</span><span class="token builtin class-name">:</span> <span class="token number">47</span>, <span class="token string">&quot;Value-file&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;NewRecord.sim&quot;</span>, <span class="token string">&quot;Conditions&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;ContractConditions(<span class="token entity" title="\&quot;">\&quot;</span>@1DeveloperCondition<span class="token entity" title="\&quot;">\&quot;</span>)&quot;</span><span class="token punctuation">}</span>
</code></pre></div><p>我们试着调用一下刚刚创建的智能合约。</p> <div class="language-text extra-class"><pre class="language-text"><code>1  &gt;callContract @18NewRecord {&quot;Student&quot;: &quot;tom&quot;, &quot;Grade&quot;: 1, &quot;Class&quot;: 1, &quot;Mathematics&quot;: 18, &quot;Physics&quot;: 57, &quot;Literature&quot;: 93}
2  
3  {
4     &quot;block_id&quot;: 1263,
5     &quot;hash&quot;: &quot;1b964a47fe6c5fd43ea55a752d01edb5ad576432fd6f63315344d87999a0473d&quot;,
6     &quot;penalty&quot;: 0,
7     &quot;err&quot;: &quot;&quot;
8  }
</code></pre></div><p>调用完成,接着我们查一下数据表是否保存了一条记录。</p> <div class="language-text extra-class"><pre class="language-text"><code>&gt;getList @18grade_info
{
    &quot;count&quot;: 1,
    &quot;list&quot;: [
        {
            &quot;class&quot;: &quot;1&quot;,
            &quot;created_at&quot;: &quot;1683698914109&quot;,
            &quot;grade&quot;: &quot;1&quot;,
            &quot;id&quot;: &quot;9&quot;,
            &quot;literature&quot;: &quot;93&quot;,
            &quot;mathematics&quot;: &quot;18&quot;,
            &quot;overall_score&quot;: &quot;56&quot;,
            &quot;physics&quot;: &quot;57&quot;,
            &quot;score&quot;: &quot;C&quot;,
            &quot;student&quot;: &quot;tom&quot;
        }
    ]
}
</code></pre></div><p>可以看到在数据表中已有一条记录，<code>student</code> tom的综合评分为56 评级为C。</p> <p>以上例子仅用于学习研究使用，你需要根据实际情况更改相关参数，比如数据表的写入权限, 智能合约的修改权限等。</p> <p>比如说我们要指定一个一个人才能调用这个新建记录的智能合约，其他所有人都不可以调用，我们可以设置一个生态参数<code>new_record_account</code>。</p> <h3 id="step-6-create-ecological-parameters"><a href="#step-6-create-ecological-parameters" class="header-anchor">#</a> 第6步设置生态参数 </h3> <p>调用智能合约<code>@1NewParameter</code>,将在<code>@1parameters</code>表创建生态参数<code>new_record_account</code>,如果你需要修改生态参数可以调用<code>@1EditParameter</code>。</p> <div class="language-text extra-class"><pre class="language-text"><code>&gt;callContract @1NewParameter {&quot;Name&quot;: &quot;new_record_account&quot;, &quot;Value&quot;: &quot;6667782293976713160&quot;, &quot;Conditions&quot;: &quot;ContractConditions(\&quot;MainCondition\&quot;)&quot;}

{
    &quot;block_id&quot;: 1416,
    &quot;hash&quot;: &quot;12fc87ce6a70e2fc993ab9ffe623311f1c50edd1157595ce6183c38c93960cae&quot;,
    &quot;penalty&quot;: 0,
    &quot;err&quot;: &quot;273&quot;
}
</code></pre></div><p>我们创建了一个生态参数<code>new_record_account</code>，设置值为keyId <code>6667782293976713160</code>, 修改权限为<code>ContractConditions(&quot;MainCondition&quot;)</code>指当前生态创建者可修改。交易执行成功时，&quot;err&quot;字段该生态参数id为<code>273</code>。</p> <h3 id="step-7-add-localization"><a href="#step-7-add-localization" class="header-anchor">#</a> 第7步添加本地化 </h3> <p>可以调用<code>@1NewLangJoint</code>智能合约创建本地化参数<code>account_not_access</code>，将在<code>@1languages</code>表创建参数，你可以通过<code>@1EditLangJoint</code>修改本地化参数.</p> <div class="language-shell extra-class"><pre class="language-shell"><code>callContract @1NewLangJoint <span class="token punctuation">{</span><span class="token string">&quot;Name&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;account_not_access&quot;</span>, <span class="token string">&quot;LocaleArr&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span><span class="token string">&quot;en&quot;</span>, <span class="token string">&quot;ja&quot;</span><span class="token punctuation">]</span>, <span class="token string">&quot;ValueArr&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span><span class="token string">&quot;Sorry, you do not have access to this action&quot;</span>, <span class="token string">&quot;申し訳ありませんが、このアクションにアクセスする権限がありません&quot;</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
</code></pre></div><h3 id="step-8-modify-the-contract"><a href="#step-8-modify-the-contract" class="header-anchor">#</a> 第8步修改智能合约 </h3> <p>接着我们需要修改一下合约源码<code>conditions</code>部分,在<code>conditions</code>添加如下代码。</p> <div class="language-text extra-class"><pre class="language-text"><code>conditions {
  if EcosysParam(&quot;new_record_account&quot;) != $key_id {
      warning LangRes(&quot;account_not_access&quot;)
  }
}
</code></pre></div><p>调用修改合约@1EditContract,这里的<code>Id</code>为合约id, <code>Value</code>：为合约源码。</p> <div class="language-text extra-class"><pre class="language-text"><code>&gt;callContract @1EditContract {&quot;Id&quot;: 348, &quot;Value&quot;: &quot;contract NewRecord {\n    data {\n        Student string\n        Grade int\n        Class int\n        Mathematics int\n        Physics int\n        Literature int\n    }\n    func getScore(a b c int) map{\n        var m map\n        var overallScore int\n        overallScore = (a+b+c) / 3\n        m[\&quot;overallScore\&quot;] = overallScore\n        if overallScore &gt;= $gradeTypeABest[\&quot;min\&quot;] &amp;amp;&amp;amp; overallScore &amp;lt; $gradeTypeABest[\&quot;max\&quot;] {\n            m[\&quot;score\&quot;] = \&quot;A+\&quot;\n        }elif overallScore &gt;= $gradeTypeA[\&quot;min\&quot;] &amp;amp;&amp;amp; overallScore &amp;lt; $gradeTypeA[\&quot;max\&quot;] {\n            m[\&quot;score\&quot;] = \&quot;A\&quot;\n        }elif overallScore &gt;= $gradeTypeBBest[\&quot;min\&quot;] &amp;amp;&amp;amp; overallScore &amp;lt; $gradeTypeBBest[\&quot;max\&quot;] {\n            m[\&quot;score\&quot;] = \&quot;B+\&quot;\n        }elif overallScore &gt;= $gradeTypeB[\&quot;min\&quot;] &amp;amp;&amp;amp; overallScore &amp;lt; $gradeTypeB[\&quot;max\&quot;] {\n            m[\&quot;score\&quot;] = \&quot;B\&quot;\n        }elif overallScore &gt;= $gradeTypeC[\&quot;min\&quot;] &amp;amp;&amp;amp; overallScore &amp;lt; $gradeTypeC[\&quot;max\&quot;]{\n            m[\&quot;score\&quot;] = \&quot;C\&quot;\n        }else{\n            m[\&quot;score\&quot;] = \&quot;Notset\&quot;\n        }\n        return m\n    }\n    func safeJsonDecode(m string) map {\n        var res map\n        if Size(m) &gt; 0 {\n            res = JSONDecode(m)\n        }\n        return res\n    }\n\n    conditions {\n        if EcosysParam(\&quot;new_record_account\&quot;) != $key_id {\n            warning LangRes(\&quot;account_not_access\&quot;)\n        }\n        if Size($Student) == 0 {\n            warning \&quot;Student Can not be empty\&quot;\n        }\n        if $Class &amp;lt;= 0{\n            warning \&quot;Class cannot be less than or equal to zero\&quot;\n        }\n         if $Grade &amp;lt;= 0{\n            warning \&quot;Grade cannot be less than or equal to zero\&quot;\n        }\n        if $Mathematics &amp;lt; 0 {\n            warning \&quot;Mathematics cannot be less than zero\&quot;\n        }\n        if $Physics &amp;lt; 0 {\n            warning \&quot;Physics cannot be less than zero\&quot;\n        }\n        if $Literature &amp;lt; 0 {\n            warning \&quot;Literature cannot be less than zero\&quot;\n        }\n        if $Mathematics &gt; 100 || $Physics &gt; 100 ||  $Literature &gt; 100{\n            warning \&quot;Score cannot exceed 100\&quot;\n        }\n        var app map\n        app = DBFind(\&quot;@1applications\&quot;).Columns(\&quot;id,ecosystem\&quot;).Where({\&quot;ecosystem\&quot;: 18,\&quot;name\&quot;:\&quot;GradesRecorder\&quot;,\&quot;deleted\&quot;:0}).Row()\n        if !app {\n            warning LangRes(\&quot;@1app_not_found\&quot;)\n        }\n\n        var app_id int\n        app_id = Int(app[\&quot;id\&quot;])\n        $eId = Int(app[\&quot;ecosystem\&quot;])\n        $gradeBestType = AppParam(app_id, \&quot;grade_best_type\&quot;, $eId)\n        $gradeTypeABest = safeJsonDecode(AppParam(app_id, \&quot;grade_type_a+\&quot;, $eId))\n        $gradeTypeA = safeJsonDecode(AppParam(app_id, \&quot;grade_type_a\&quot;, $eId))\n        $gradeTypeBBest = safeJsonDecode(AppParam(app_id, \&quot;grade_type_b+\&quot;, $eId))\n        $gradeTypeB = safeJsonDecode(AppParam(app_id, \&quot;grade_type_b\&quot;, $eId))\n        $gradeTypeC = safeJsonDecode(AppParam(app_id, \&quot;grade_type_c\&quot;, $eId))\n    }\n    action {\n        var m map \n        m = getScore($Mathematics,$Physics,$Literature)\n        var in map\n        in[\&quot;student\&quot;] = $Student\n        in[\&quot;class\&quot;] = $Class\n        in[\&quot;grade\&quot;] = $Grade\n        in[\&quot;mathematics\&quot;] = $Mathematics\n        in[\&quot;physics\&quot;] = $Physics \n        in[\&quot;literature\&quot;] = $Literature \n        in[\&quot;overall_score\&quot;] = m[\&quot;overallScore\&quot;]\n        in[\&quot;score\&quot;] = m[\&quot;score\&quot;]\n        in[\&quot;created_at\&quot;] = $time\n        DBInsert(\&quot;@\&quot;+ Str($eId)+\&quot;grade_info\&quot;, in)\n    }\n}&quot;}
</code></pre></div><h4 id="step-9-modify-data-table-permissions"><a href="#step-9-modify-data-table-permissions" class="header-anchor">#</a> 第9步修改数据表权限 </h4> <p>这里我们需要将数据表的插入权限修改，原先权限<code>ContractConditions(&quot;MainCondition&quot;)</code>为生态创建人，而合约设置<code>new_record_account</code>并不是生态创建人，所以只需将<code>ContractConditions(&quot;MainCondition&quot;)</code>修改为指定合约可操作<code>ContractAccess(&quot;@18NewRecord&quot;)</code>即可.调用合约<code>@1EditTable</code>修改数据表权限。</p> <div class="language-text extra-class"><pre class="language-text"><code>&gt;callContract @1EditTable {&quot;Name&quot;: &quot;@18grade_info&quot;, &quot;InsertPerm&quot;: &quot;ContractAccess(\&quot;@18NewRecord\&quot;)&quot;, &quot;UpdatePerm&quot;: &quot;ContractConditions(\&quot;MainCondition\&quot;)&quot;, &quot;ReadPerm&quot;: &quot;true&quot;, &quot;NewColumnPerm&quot;: &quot;ContractConditions(\&quot;MainCondition\&quot;)&quot;}
</code></pre></div><p>接着调用一下刚刚修改的合约，新建一条记录。</p> <div class="language-text extra-class"><pre class="language-text"><code>1  &gt;callContract @18NewRecord {&quot;Student&quot;: &quot;tom&quot;, &quot;Grade&quot;: 1, &quot;Class&quot;: 1, &quot;Mathematics&quot;: 18, &quot;Physics&quot;: 57, &quot;Literature&quot;: 93}
2  
3  {
4      &quot;block_id&quot;: 1435,
5      &quot;hash&quot;: &quot;7d4b06d3738133f9c2ec775935478cd2d6c20fd04eca275769afd0f8e6a4f687&quot;,
6      &quot;penalty&quot;: 1,
7      &quot;err&quot;: &quot;{\&quot;type\&quot;:\&quot;warning\&quot;,\&quot;error\&quot;:\&quot;Sorry, you do not have access to this action\&quot;}&quot;
8  }
</code></pre></div><p>可以看到我们刚刚设置的本地化参数<code>account_not_access</code>起作用了。</p> <p>发现报了权限错误，当前用户没有权限操作，我们切换到keyId为<code>6667782293976713160</code>的账户,我们可以通过命令行工具<code>account info</code>获取当前用户的信息。设置命令行工具<code>config.yml，切换到keyId为</code>6667782293976713160`的账户。设置完成后，再次调用合约。</p> <div class="language-text extra-class"><pre class="language-text"><code>&gt;callContract @18NewRecord {&quot;Student&quot;: &quot;tini&quot;, &quot;Grade&quot;: 1, &quot;Class&quot;: 3, &quot;Mathematics&quot;: 69, &quot;Physics&quot;: 89, &quot;Literature&quot;: 98}

{
    &quot;block_id&quot;: 1436,
    &quot;hash&quot;: &quot;93327dafb7bae9f9f66718eb87020a7bca4c00060f4bd0a243b49eea304c52e6&quot;,
    &quot;penalty&quot;: 0,
    &quot;err&quot;: &quot;&quot;
}
</code></pre></div><p>调用完成,通过<code>getList @18grade_info</code>查询数据表，结果符合预期。</p> <p>希望本文能帮助您更多地了解IBAX网络如何工作以及如何编写清晰安全的<code>Needle</code>代码。</p> <h2 id="deploy-application-using-command-line-tools"><a href="#deploy-application-using-command-line-tools" class="header-anchor">#</a> 使用命令行工具部署应用 </h2> <p>在本教程中，您将学习如何：</p> <ul><li>1.<a href="#export-application">导出应用</a></li> <li>2.<a href="#import-application">导入应用</a></li></ul> <p>在开始本教程之前，你需要有一个自己的应用并且知道生态与应用的概念，你可以参考<a href="#getting-started-guide">入门指南</a> 。我们将通过<a href="https://github.com/IBAX-io/ibax-cli" target="_blank" rel="noopener noreferrer">命令行工具<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 在IBAX区块链上导入应用、导出应用。</p> <h3 id="export-application"><a href="#export-application" class="header-anchor">#</a> 导出应用 </h3> <p>调用<code>account info</code>可以查询当前的账户信息,这里登录的生态id为<code>9</code>,调用<code>getList</code>命令可以查询当前生态有哪些应用。</p> <div class="language-shell extra-class"><pre class="language-shell"><code>$ ibax-cli console
   
Welcome to the IBAX console<span class="token operator">!</span>
To exit, press ctrl-d or <span class="token builtin class-name">type</span> <span class="token builtin class-name">exit</span>
<span class="token operator">&gt;</span>account info
<span class="token punctuation">{</span>
    <span class="token string">&quot;public_key&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;04d11ea197fe23152562c6f54c4...889c074dfd9080099982d8b2d4d100315e1cebc7&quot;</span>,     
    <span class="token string">&quot;ecosystem_id&quot;</span><span class="token builtin class-name">:</span> <span class="token number">9</span>,
    <span class="token string">&quot;key_id&quot;</span><span class="token builtin class-name">:</span> <span class="token number">6660819</span><span class="token punctuation">..</span>.78795186,
    <span class="token string">&quot;account&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;0666-0819-...-7879-5186&quot;</span>
<span class="token punctuation">}</span>

<span class="token operator">&gt;</span>getList @1applications <span class="token parameter variable">-w</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&quot;ecosystem&quot;</span><span class="token builtin class-name">:</span> <span class="token number">9</span><span class="token punctuation">}</span>

<span class="token punctuation">{</span>
    <span class="token string">&quot;count&quot;</span><span class="token builtin class-name">:</span> <span class="token number">6</span>,
    <span class="token string">&quot;list&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            <span class="token string">&quot;conditions&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;true&quot;</span>,
            <span class="token string">&quot;deleted&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;0&quot;</span>,
            <span class="token string">&quot;ecosystem&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;9&quot;</span>,
            <span class="token string">&quot;id&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;36&quot;</span>,
            <span class="token string">&quot;name&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;testapp&quot;</span>,
            <span class="token string">&quot;uuid&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;00000000-0000-0000-0000-000000000000&quot;</span>
        <span class="token punctuation">}</span>
        <span class="token punctuation">..</span>.
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><p>可以看到当前生态有6个应用，我们使用<code>export</code>命令导出<code>id</code>为<code>36</code>的应用。</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token operator">&gt;</span>export <span class="token number">36</span> <span class="token parameter variable">-f</span><span class="token operator">=</span>./data.json

<span class="token punctuation">{</span>
    <span class="token string">&quot;name&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;./data.json&quot;</span>,
    <span class="token string">&quot;type&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;application/json&quot;</span>,
    <span class="token string">&quot;value&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>这里的-f参数，将要导出的应用保存到当前目录<code>data.json</code>文件中，如果没有-f参数，则将在命令终端输出应用数据。</p> <p><code>export</code>命令封装了导出应用的步骤，你可以使用以上命令导出应用，或使用以下步骤，具体步骤如下：</p> <p>调用合约<code>@1ExportNewApp</code>导出一个新的应用，会在<code>1_buffer_data</code>表生成一条导出应用的记录。</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token operator">&gt;</span>callContract @1ExportNewApp <span class="token punctuation">{</span><span class="token string">&quot;ApplicationId&quot;</span><span class="token builtin class-name">:</span> <span class="token number">36</span><span class="token punctuation">}</span>
</code></pre></div><p>调用合约<code>@1Export</code>导出应用,在<code>1_buffer_data</code>表中查找所选应用程序，并将所有应用程序资源导出到生成的 json 字符串中。生成的 json 字符串将写入当前生态系统的<code>1_binaries</code>表。</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token operator">&gt;</span>callContract @1Export
</code></pre></div><p>通过<code>getList</code>命令查询<code>1_binaries</code>表中的数据。</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token operator">&gt;</span>getList @1binaries <span class="token parameter variable">-w</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&quot;name&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;export&quot;</span>, <span class="token string">&quot;account&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;0666-0819-...-7879-5186&quot;</span>, <span class="token string">&quot;ecosystem&quot;</span><span class="token builtin class-name">:</span> <span class="token number">9</span>, <span class="token string">&quot;app_id&quot;</span><span class="token builtin class-name">:</span> <span class="token number">36</span><span class="token punctuation">}</span> <span class="token parameter variable">-l</span><span class="token operator">=</span><span class="token number">1</span> <span class="token parameter variable">-c</span><span class="token operator">=</span><span class="token string">&quot;id,hash&quot;</span>

<span class="token punctuation">{</span>
    <span class="token string">&quot;count&quot;</span><span class="token builtin class-name">:</span> <span class="token number">1</span>,
    <span class="token string">&quot;list&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            <span class="token string">&quot;hash&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;8542cb57b77e0ae2c...92c3e05dbbe35ab646789be5b8ba8&quot;</span>,
            <span class="token string">&quot;id&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;14&quot;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><p>得到二进制文件id和hash。调用<code>binaryVerify</code>命令导出二进制文件。</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token operator">&gt;</span>binaryVerify <span class="token number">14</span> 8542cb57b77e0ae2c<span class="token punctuation">..</span>.92c3e05dbbe35ab646789be5b8ba8 <span class="token parameter variable">-f</span><span class="token operator">=</span>./data.json

<span class="token punctuation">{</span>
    <span class="token string">&quot;name&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;./data.json&quot;</span>,     
    <span class="token string">&quot;type&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;application/json&quot;</span>,
    <span class="token string">&quot;value&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="import-application"><a href="#import-application" class="header-anchor">#</a> 导入应用 </h3> <p>使用<code>import</code>命令导入应用，<code>-f</code>参数为指定导入的应用文件。</p> <div class="language-shell extra-class"><pre class="language-shell"><code>$ ibax-cli console

Welcome to the IBAX console<span class="token operator">!</span>
To exit, press ctrl-d or <span class="token builtin class-name">type</span> <span class="token builtin class-name">exit</span>

<span class="token operator">&gt;</span>import <span class="token parameter variable">-f</span> ./data.json
</code></pre></div><p>其中<code>import</code>命令封装了导入应用的步骤，你可以使用以上命令导入应用。</p> <p>或使用以下步骤，为方便学习与研究，具体步骤如下：</p> <ul><li>第1步,调用合约<code>@1ImportUpload</code>导入一个新的应用，会在<code>1_buffer_data</code>表生成一条导出应用的记录。<code>@1ImportUpload</code>该合约参数<code>Data</code>为<code>file</code><a href="/zh-CN/topics/vm.html#types">类型</a> ,包含关键字<code>Name</code>文件名(string),<code>MimeType</code>文件类型(string),<code>Body</code>([]byte)文件内容。你需要将应用文件数据进行base64编码后传入<code>Body</code>中，可以使用<code>base64Encode</code>命令进行base64编码。</li></ul> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token operator">&gt;</span>base64Encode <span class="token parameter variable">-f</span><span class="token operator">=</span>./data.json

Encode:ewoJIm5hbWUiOiAid<span class="token punctuation">..</span>.CQkJIlR5cGUiOiAiY29udHJhY3RzIiwKCQkJIk5hbWUiOiAiSGVsbG9Xb3JsZCIsCgkJCSJWYWx1ZSI6<span class="token punctuation">..</span>.

<span class="token operator">&gt;</span>callContract @1ImportUpload <span class="token punctuation">{</span><span class="token string">&quot;Data&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span><span class="token string">&quot;Name&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;filename&quot;</span>, <span class="token string">&quot;MimeType&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;mimeType&quot;</span>, <span class="token string">&quot;Body&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;ewoJIm5hbWUiOiAid...CQkJIlR5cGUiOiAiY29udHJhY3RzIiwKCQkJIk5hbWUiOiAiSGVsbG9Xb3JsZCIsCgkJCSJWYWx1ZSI6...&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
</code></pre></div><ul><li>第2步,调用完成后，使用<code>getList</code>命令查询<code>1_buffer_data</code>表中的数据。</li></ul> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token operator">&gt;</span>getList @1buffer_data <span class="token parameter variable">-w</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&quot;key&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;import&quot;</span>, <span class="token string">&quot;account&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;0666-0819-xxxx-7879-5186&quot;</span>, <span class="token string">&quot;ecosystem&quot;</span><span class="token builtin class-name">:</span> <span class="token number">19</span><span class="token punctuation">}</span> <span class="token parameter variable">-l</span><span class="token operator">=</span><span class="token number">1</span> <span class="token parameter variable">-c</span><span class="token operator">=</span>value-<span class="token operator">&gt;</span><span class="token string">'data'</span>

<span class="token punctuation">{</span>
    <span class="token string">&quot;count&quot;</span><span class="token builtin class-name">:</span> <span class="token number">1</span>,
    <span class="token string">&quot;list&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            <span class="token string">&quot;id&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;22&quot;</span>,
            <span class="token string">&quot;value.data&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;[{&quot;</span>Data<span class="token string">&quot;: &quot;</span><span class="token punctuation">[</span>a,b<span class="token punctuation">]</span><span class="token string">&quot;}, {&quot;</span>Data<span class="token string">&quot;: &quot;</span><span class="token punctuation">[</span>c,d<span class="token punctuation">]</span><span class="token string">&quot;}]&quot;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>第3步,将value.data-&gt;Data中的数据组装成一维数组，[a,b,c,d],然后创建一个合约参数文件<code>importParams.json</code>,内容如下：</li></ul> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span><span class="token property">&quot;Data&quot;</span><span class="token operator">:</span><span class="token string">&quot;[a,b,c,d]&quot;</span><span class="token punctuation">}</span>
</code></pre></div><p>-第4步,调用合约<code>@1Import</code>导入应用数据。</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token operator">&gt;</span>callContract @1Import <span class="token parameter variable">-f</span><span class="token operator">=</span>./importParams.json
</code></pre></div><h2 id="ecological-configuration-using-command-line-tool"><a href="#ecological-configuration-using-command-line-tool" class="header-anchor">#</a> 使用命令行工具生态配置 </h2> <p>在本教程中，您将学习如何：</p> <ol><li><a href="#apply-to-join-the-ecosystem">申请加入生态</a></li> <li><a href="#add-ecosystem-members">添加生态成员</a></li> <li><a href="#freezing-of-accounts">冻结账户</a></li> <li><a href="#role-management">角色管理</a></li> <li><a href="#issuance-of-token">生态代币发行</a></li> <li><a href="#eco-deduction">生态代扣</a></li> <li><a href="#dao-governance-ecosystem">DAO治理生态</a></li></ol> <p>在开始本教程之前，你需要有一个自己的应用并且知道生态与应用的概念，你可以参考<a href="#getting-started-guide">入门指南</a> 。我们将通过<a href="https://github.com/IBAX-io/ibax-cli" target="_blank" rel="noopener noreferrer">命令行工具<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 在IBAX区块链上进行生态配置。</p> <h3 id="apply-to-join-the-ecosystem"><a href="#apply-to-join-the-ecosystem" class="header-anchor">#</a> 申请加入生态 </h3> <p>我们可以调用<code>@1MembershipRequest</code>合约申请加入生态。如下例子：</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token operator">&gt;</span>callContract @1MembershipRequest <span class="token punctuation">{</span><span class="token string">&quot;EcosystemId&quot;</span><span class="token builtin class-name">:</span> <span class="token number">19</span><span class="token punctuation">}</span>
</code></pre></div><p>申请加入生态id为<code>19</code>的生态，<code>@1MembershipRequest</code>合约对调用生态做了限制，只有在基础生态才可调用，当申请成功后，目标生态管理者会收到一条申请，只有申请被生态管理者批复后才算是加入了目标生态,当然如果目标生态是公开的，你可以直接加入目标生态。</p> <h3 id="add-ecosystem-members"><a href="#add-ecosystem-members" class="header-anchor">#</a> 添加生态成员 </h3> <p>当生态刚创建时,生态成员只有生态创建者,当你需要邀请其他成员加入时,你需要知道被邀请人的公钥,然后调用合约<code>@1MembershipAdd</code>添加成员。</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token operator">&gt;</span>callContract @1MembershipAdd <span class="token punctuation">{</span><span class="token string">&quot;Keys&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;04f2c1780ca0aa0f343d0e541c77811...3b0d5bf3a9903253aad6e78c966b5f91ffb32703884020&quot;</span><span class="token punctuation">}</span>
</code></pre></div><p>如果生态是公开的允许任何人加入，你可以设置生态参数<code>free_membership</code> = 1,默认是不公开的，设置完成后，无需通过审批即可加入你的生态。</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token operator">&gt;</span>callContract @1NewParameter <span class="token punctuation">{</span><span class="token string">&quot;Name&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;free_membership&quot;</span>, <span class="token string">&quot;Value&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;1&quot;</span>, <span class="token string">&quot;Conditions&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;ContractConditions(<span class="token entity" title="\&quot;">\&quot;</span>MainCondition<span class="token entity" title="\&quot;">\&quot;</span>)&quot;</span><span class="token punctuation">}</span>
</code></pre></div><p>如果你没有设置参数<code>free_membership</code>,其他成员申请加入你的生态时，你将会收到一条申请通知，可通过``查看所有的角色通知。</p> <p>调用<code>@1MembershipDecide</code>合约批复申请,合约参数<code>NotificId</code>为通知id，'Accept'为决议标识，决议标识<code>1</code>为通过。</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token operator">&gt;</span>callContract @1MembershipDecide <span class="token punctuation">{</span><span class="token string">&quot;NotificId&quot;</span><span class="token builtin class-name">:</span> <span class="token number">6</span>, <span class="token string">&quot;Accept&quot;</span><span class="token builtin class-name">:</span> <span class="token number">1</span><span class="token punctuation">}</span>
</code></pre></div><h3 id="freezing-of-accounts"><a href="#freezing-of-accounts" class="header-anchor">#</a> 冻结账户 </h3> <p>调用<code>@1DeleteMember</code>合约冻结账户，注意此操作无法还原。</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token operator">&gt;</span>callContract @1DeleteMember <span class="token punctuation">{</span><span class="token string">&quot;MemberAccount&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;1539-2715-xxxx-1679-5385&quot;</span><span class="token punctuation">}</span>
</code></pre></div><h3 id="role-management"><a href="#role-management" class="header-anchor">#</a> 角色管理 </h3> <ul><li><a href="#new-role-creation">新建角色</a></li> <li><a href="#adding-role-members">添加角色成员</a></li> <li><a href="#delete-role-members">删除角色成员</a></li> <li><a href="#modify-role-manager">修改角色管理者</a></li> <li><a href="#delete-role">删除角色</a></li></ul> <h4 id="new-role-creation"><a href="#new-role-creation" class="header-anchor">#</a> 新建角色 </h4> <p>调用<code>@1RolesCreate</code>合约新建角色，角色名<code>student</code>,类型<code>2</code>(1-可分配 2-通过投票选任类型 3-System)。</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token operator">&gt;</span>callContract @1RolesCreate <span class="token punctuation">{</span><span class="token string">&quot;Name&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;student&quot;</span>, <span class="token string">&quot;Type&quot;</span><span class="token builtin class-name">:</span> <span class="token number">2</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span>
    <span class="token string">&quot;block_id&quot;</span><span class="token builtin class-name">:</span> <span class="token number">1685</span>,
    <span class="token string">&quot;hash&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;5321f2231a...d0d80158b62766395f14d0ff7&quot;</span>,
    <span class="token string">&quot;penalty&quot;</span><span class="token builtin class-name">:</span> <span class="token number">0</span>,
    <span class="token string">&quot;err&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;21&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>返回结果里包含角色id <code>21</code>。</p> <h4 id="adding-role-members"><a href="#adding-role-members" class="header-anchor">#</a> 添加角色成员 </h4> <p>有两种方法，第一种方法，生态成员发起申请，调用合约<code>@1RolesRequest</code>申请添加为该角色成员,其中<code>Rid</code>为角色id。</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token operator">&gt;</span>callContract @1RolesRequest <span class="token punctuation">{</span><span class="token string">&quot;Rid&quot;</span><span class="token builtin class-name">:</span> <span class="token number">21</span><span class="token punctuation">}</span>
</code></pre></div><p>第二种方法，角色管理者分配角色成员,角色管理者调用合约<code>@1RolesAssign</code>添加该角色的成员。</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token operator">&gt;</span>callContract @1RolesAssign <span class="token punctuation">{</span><span class="token string">&quot;MemberAccount&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;0666-7782-xxxx-7671-3160&quot;</span>, <span class="token string">&quot;Rid&quot;</span><span class="token builtin class-name">:</span> <span class="token number">21</span><span class="token punctuation">}</span>
</code></pre></div><h4 id="delete-role-members"><a href="#delete-role-members" class="header-anchor">#</a> 删除角色成员 </h4> <p>首先我们查看某个角色有哪些成员,我们可以通过getList查询,如下所示：</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token operator">&gt;</span>getList @1roles_participants <span class="token parameter variable">-w</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&quot;ecosystem&quot;</span><span class="token builtin class-name">:</span> <span class="token number">18</span>, <span class="token string">&quot;role-&gt;id&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;21&quot;</span>, <span class="token string">&quot;deleted&quot;</span><span class="token builtin class-name">:</span> <span class="token number">0</span><span class="token punctuation">}</span>

<span class="token punctuation">{</span>
    <span class="token string">&quot;count&quot;</span><span class="token builtin class-name">:</span> <span class="token number">3</span>,
    <span class="token string">&quot;list&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            <span class="token string">&quot;appointed&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;{<span class="token entity" title="\&quot;">\&quot;</span>account<span class="token entity" title="\&quot;">\&quot;</span>: <span class="token entity" title="\&quot;">\&quot;</span>1273-2644-xxxx-5846-6598<span class="token entity" title="\&quot;">\&quot;</span>, <span class="token entity" title="\&quot;">\&quot;</span>image_id<span class="token entity" title="\&quot;">\&quot;</span>: <span class="token entity" title="\&quot;">\&quot;</span>0<span class="token entity" title="\&quot;">\&quot;</span>, <span class="token entity" title="\&quot;">\&quot;</span>member_name<span class="token entity" title="\&quot;">\&quot;</span>: <span class="token entity" title="\&quot;">\&quot;</span>founder<span class="token entity" title="\&quot;">\&quot;</span>}&quot;</span>,
            <span class="token string">&quot;date_created&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;1684916023&quot;</span>,
            <span class="token string">&quot;date_deleted&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;0&quot;</span>,
            <span class="token string">&quot;deleted&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;0&quot;</span>,
            <span class="token string">&quot;ecosystem&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;18&quot;</span>,
            <span class="token string">&quot;id&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;21&quot;</span>,
            <span class="token string">&quot;member&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;{<span class="token entity" title="\&quot;">\&quot;</span>account<span class="token entity" title="\&quot;">\&quot;</span>: <span class="token entity" title="\&quot;">\&quot;</span>1273-2644-xxxx-5846-6598<span class="token entity" title="\&quot;">\&quot;</span>, <span class="token entity" title="\&quot;">\&quot;</span>image_id<span class="token entity" title="\&quot;">\&quot;</span>: <span class="token entity" title="\&quot;">\&quot;</span>0<span class="token entity" title="\&quot;">\&quot;</span>, <span class="token entity" title="\&quot;">\&quot;</span>member_name<span class="token entity" title="\&quot;">\&quot;</span>: <span class="token entity" title="\&quot;">\&quot;</span>founder<span class="token entity" title="\&quot;">\&quot;</span>}&quot;</span>,
            <span class="token string">&quot;role&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;{<span class="token entity" title="\&quot;">\&quot;</span>id<span class="token entity" title="\&quot;">\&quot;</span>: <span class="token entity" title="\&quot;">\&quot;</span>20<span class="token entity" title="\&quot;">\&quot;</span>, <span class="token entity" title="\&quot;">\&quot;</span>name<span class="token entity" title="\&quot;">\&quot;</span>: <span class="token entity" title="\&quot;">\&quot;</span>teacher<span class="token entity" title="\&quot;">\&quot;</span>, <span class="token entity" title="\&quot;">\&quot;</span>type<span class="token entity" title="\&quot;">\&quot;</span>: <span class="token entity" title="\&quot;">\&quot;</span>1<span class="token entity" title="\&quot;">\&quot;</span>, <span class="token entity" title="\&quot;">\&quot;</span>image_id<span class="token entity" title="\&quot;">\&quot;</span>: <span class="token entity" title="\&quot;">\&quot;</span>0<span class="token entity" title="\&quot;">\&quot;</span>}&quot;</span>
        <span class="token punctuation">}</span>
        <span class="token punctuation">..</span>.
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><p>其中<code>where</code>条件<code>ecosystem</code>指定生态，<code>role-&gt;id</code>指定角色id，<code>deleted</code>: 0指定未删除。我们可以看到查询到了3条记录,假如我们要移除成员为<code>1273-2644-xxxx-5846-6598</code>的角色权限，即<code>id</code>为<code>21</code>的角色。管理员可以调用合约<code>@1RolesUnassign</code>删除角色成员,如下所示：</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token operator">&gt;</span>callContract @1RolesUnassign <span class="token punctuation">{</span><span class="token string">&quot;RowId&quot;</span><span class="token builtin class-name">:</span> <span class="token number">21</span><span class="token punctuation">}</span>
</code></pre></div><h4 id="modify-role-manager"><a href="#modify-role-manager" class="header-anchor">#</a> 修改角色管理者 </h4> <p>我们查看一下当前生态的角色。</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token operator">&gt;</span>getList @1roles <span class="token parameter variable">-w</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&quot;ecosystem&quot;</span><span class="token builtin class-name">:</span> <span class="token number">18</span><span class="token punctuation">}</span>

<span class="token punctuation">{</span>
    <span class="token string">&quot;count&quot;</span><span class="token builtin class-name">:</span> <span class="token number">5</span>,
    <span class="token string">&quot;list&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            <span class="token string">&quot;company_id&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;0&quot;</span>,
            <span class="token string">&quot;creator&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;{<span class="token entity" title="\&quot;">\&quot;</span>account<span class="token entity" title="\&quot;">\&quot;</span>: <span class="token entity" title="\&quot;">\&quot;</span>1273-2644-xxxx-5846-6598<span class="token entity" title="\&quot;">\&quot;</span>, <span class="token entity" title="\&quot;">\&quot;</span>image_id<span class="token entity" title="\&quot;">\&quot;</span>: <span class="token entity" title="\&quot;">\&quot;</span>0<span class="token entity" title="\&quot;">\&quot;</span>, <span class="token entity" title="\&quot;">\&quot;</span>member_name<span class="token entity" title="\&quot;">\&quot;</span>: <span class="token entity" title="\&quot;">\&quot;</span>founder<span class="token entity" title="\&quot;">\&quot;</span>}&quot;</span>,
            <span class="token string">&quot;date_created&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;1684910917&quot;</span>,
            <span class="token string">&quot;date_deleted&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;0&quot;</span>,
            <span class="token string">&quot;default_page&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;&quot;</span>,
            <span class="token string">&quot;deleted&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;0&quot;</span>,
            <span class="token string">&quot;ecosystem&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;18&quot;</span>,
            <span class="token string">&quot;id&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;20&quot;</span>,
            <span class="token string">&quot;image_id&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;0&quot;</span>,
            <span class="token string">&quot;role_name&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;teacher&quot;</span>,
            <span class="token string">&quot;role_type&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;1&quot;</span>,
            <span class="token string">&quot;roles_access&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;[]&quot;</span>
        <span class="token punctuation">}</span>
        <span class="token punctuation">..</span>.
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><p>其中<code>roles_access</code>为当前角色的管理角色，它是一个数组，可以有多个。我们给<code>teacher</code>这个角色添加管理角色，调用<code>@1RolesAccessManager</code>合约,其中合约参数<code>Action</code> 管理操作符(<code>clean</code>清空,<code>remove</code>删除,<code>add</code>添加),<code>Rid</code>要管理的角色ID,<code>ManagerRid</code>该 Rid 角色的管理者。</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token operator">&gt;</span>callContract @1RolesAccessManager <span class="token punctuation">{</span><span class="token string">&quot;Action&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;add&quot;</span>, <span class="token string">&quot;Rid&quot;</span><span class="token builtin class-name">:</span> <span class="token number">20</span>, <span class="token string">&quot;ManagerRid&quot;</span><span class="token builtin class-name">:</span> <span class="token number">13</span><span class="token punctuation">}</span>

<span class="token punctuation">{</span>
    <span class="token string">&quot;block_id&quot;</span><span class="token builtin class-name">:</span> <span class="token number">1745</span>,
    <span class="token string">&quot;hash&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;e2eb8ff0dc309ec7652db...bbbe58bca4ca574804e46c2f63653eb73104&quot;</span>,
    <span class="token string">&quot;penalty&quot;</span><span class="token builtin class-name">:</span> <span class="token number">0</span>,
    <span class="token string">&quot;err&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="delete-role"><a href="#delete-role" class="header-anchor">#</a> 删除角色 </h4> <p>我们可以调用<code>@1RolesDelete</code>合约删除角色，其中合约参数<code>Rid</code>要管理的角色ID，<code>Ops</code>为操作符(<code>D</code>为删除 <code>R</code>为恢复)</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token operator">&gt;</span>callContract @1RolesDelete <span class="token punctuation">{</span><span class="token string">&quot;Rid&quot;</span><span class="token builtin class-name">:</span> <span class="token number">24</span>, <span class="token string">&quot;Ops&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;D&quot;</span><span class="token punctuation">}</span>

<span class="token punctuation">{</span>
    <span class="token string">&quot;block_id&quot;</span><span class="token builtin class-name">:</span> <span class="token number">1785</span>,
    <span class="token string">&quot;hash&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;1ebf99a04f504fc3d2...4ecfbdfc419bf3dbf39df0013dca913f844&quot;</span>,
    <span class="token string">&quot;penalty&quot;</span><span class="token builtin class-name">:</span> <span class="token number">0</span>,
    <span class="token string">&quot;err&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="issuance-of-token"><a href="#issuance-of-token" class="header-anchor">#</a> 生态代币发行 </h3> <ul><li><a href="#create-ecosystem">创建生态</a></li> <li><a href="#installing-basic-applications">安装基础应用</a></li> <li><a href="#token-issuance">生态发币</a></li></ul> <h4 id="create-ecosystem"><a href="#create-ecosystem" class="header-anchor">#</a> 创建生态 </h4> <p>创建一个生态, 调用<code>@1NewEcosystem</code>合约。</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token operator">&gt;</span>callContract @1NewEcosystem <span class="token punctuation">{</span><span class="token string">&quot;Name&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;Test Ecosystem&quot;</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span>
    <span class="token string">&quot;block_id&quot;</span><span class="token builtin class-name">:</span> <span class="token number">1787</span>,
    <span class="token string">&quot;hash&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;384f35ef93243c9dd4f53b9298873b356b25b31cf7c6a6be7600ee7694d77006&quot;</span>,
    <span class="token string">&quot;penalty&quot;</span><span class="token builtin class-name">:</span> <span class="token number">0</span>,
    <span class="token string">&quot;err&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;21&quot;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>然后我们修改命令行工具配置，登录到新创建的这个生态ecosystem: &quot;21&quot;。</p> <h4 id="installing-basic-applications"><a href="#installing-basic-applications" class="header-anchor">#</a> 安装基础应用 </h4> <p>调用合约安装基础应用,如下所示：</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token number">1</span>  <span class="token operator">&gt;</span>callContract @1PlatformAppsInstall
<span class="token number">2</span>  <span class="token operator">&gt;</span>callContract @1RolesInstall
<span class="token number">3</span>  <span class="token operator">&gt;</span>callContract @1AppInstall <span class="token punctuation">{</span><span class="token string">&quot;ApplicationId&quot;</span><span class="token builtin class-name">:</span> <span class="token number">5</span><span class="token punctuation">}</span>
<span class="token number">4</span>  <span class="token operator">&gt;</span>callContract @1AppInstall <span class="token punctuation">{</span><span class="token string">&quot;ApplicationId&quot;</span><span class="token builtin class-name">:</span> <span class="token number">6</span><span class="token punctuation">}</span>
</code></pre></div><p>第1行，安装平台应用。
第2行，安装默认角色。
第3-4行，安装生态配置与代币发行应用，其中应用id <code>5,6</code>可通过getList查询，如下：</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token operator">&gt;</span>getList @1applications <span class="token parameter variable">-w</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&quot;ecosystem&quot;</span><span class="token builtin class-name">:</span> <span class="token number">1</span>, <span class="token string">&quot;<span class="token variable">$or</span>&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token string">&quot;name&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;Token emission&quot;</span><span class="token punctuation">}</span>,<span class="token punctuation">{</span><span class="token string">&quot;name&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;Ecosystems catalog&quot;</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">}</span> <span class="token parameter variable">-c</span><span class="token operator">=</span><span class="token string">&quot;name,ecosystem&quot;</span>

<span class="token punctuation">{</span>
    <span class="token string">&quot;count&quot;</span><span class="token builtin class-name">:</span> <span class="token number">2</span>,
    <span class="token string">&quot;list&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            <span class="token string">&quot;ecosystem&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;1&quot;</span>,
            <span class="token string">&quot;id&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;5&quot;</span>,
            <span class="token string">&quot;name&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;Token emission&quot;</span>
        <span class="token punctuation">}</span>,
        <span class="token punctuation">{</span>
            <span class="token string">&quot;ecosystem&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;1&quot;</span>,
            <span class="token string">&quot;id&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;6&quot;</span>,
            <span class="token string">&quot;name&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;Ecosystems catalog&quot;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="token-issuance"><a href="#token-issuance" class="header-anchor">#</a> 生态发币 </h4> <p>因为是新建的生态，需要进行代币发行设置,调用<code>@1TeSettings</code>合约指定可发行代币的角色。</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token operator">&gt;</span>callContract @1TeSettings <span class="token punctuation">{</span><span class="token string">&quot;RoleDeveloper&quot;</span><span class="token builtin class-name">:</span> <span class="token number">30</span><span class="token punctuation">}</span>
</code></pre></div><p>其中<code>RoleDeveloper</code>为当前生态角色id，可通过<code>@1roles</code>数据表获取。</p> <p><strong>代币发行</strong> 调用<code>@1NewToken</code>合约发行代币。</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token operator">&gt;</span>callContract @1NewToken <span class="token punctuation">{</span><span class="token string">&quot;Symbol&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;TEST&quot;</span>, <span class="token string">&quot;Name&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;TEST Coin&quot;</span>, <span class="token string">&quot;Amount&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;10000000000000000&quot;</span> ,<span class="token string">&quot;Digits&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;12&quot;</span><span class="token punctuation">}</span>
</code></pre></div><p>其中合约参数<code>Symbol</code>为代币符号，<code>Name</code>为代币名称，<code>Amount</code>为总额，<code>Digits</code>为精度。</p> <p><strong>增发代币</strong></p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token operator">&gt;</span>callContract @1TeEmission <span class="token punctuation">{</span><span class="token string">&quot;Amount&quot;</span><span class="token builtin class-name">:</span> <span class="token number">1000000000000</span><span class="token punctuation">}</span>
</code></pre></div><p><strong>销毁代币</strong></p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token operator">&gt;</span>callContract @1TeBurn <span class="token punctuation">{</span><span class="token string">&quot;Amount&quot;</span><span class="token builtin class-name">:</span> <span class="token number">1000000000000</span><span class="token punctuation">}</span>
</code></pre></div><p>默认增发代币和销毁代币是允许的，你可以通过<code>@1TeChange</code>设置关闭，其中<code>TypeChange</code>为类型(<code>emission</code>增发,<code>withdraw</code>销毁),<code>Value</code>为开关状态(<code>1</code>开启,<code>2</code>关闭)，例如：<strong>关闭增发</strong> 注意：关闭后无法开启 。</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token operator">&gt;</span>callContract @1TeChange <span class="token punctuation">{</span><span class="token string">&quot;TypeChange&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;emission&quot;</span>, <span class="token string">&quot;Value&quot;</span><span class="token builtin class-name">:</span> <span class="token number">2</span><span class="token punctuation">}</span>
</code></pre></div><p><strong>关闭销毁</strong>,如果你想再次开启销毁功能，将<code>Value</code>置为<code>1</code>即可。</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token operator">&gt;</span>callContract @1TeChange <span class="token punctuation">{</span><span class="token string">&quot;TypeChange&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;withdraw&quot;</span>, <span class="token string">&quot;Value&quot;</span><span class="token builtin class-name">:</span> <span class="token number">2</span><span class="token punctuation">}</span>
</code></pre></div><h3 id="eco-deduction"><a href="#eco-deduction" class="header-anchor">#</a> 生态代扣 </h3> <p>在设置生态代扣之前，你需要了解IBAX收费模型，可在 <a href="https://github.com/IBAX-io/whitepaper" target="_blank" rel="noopener noreferrer">白皮书<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 中找到.</p> <p>我们首先设置生态钱包地址,调用<code>@1EditParameter</code>合约，修改生态参数：</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token operator">&gt;</span>callContract @1EditParameter <span class="token punctuation">{</span><span class="token string">&quot;Id&quot;</span><span class="token builtin class-name">:</span> <span class="token number">334</span>, <span class="token string">&quot;Value&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;1273-2644-xxxx-5846-6598&quot;</span><span class="token punctuation">}</span>
</code></pre></div><p>其中<code>Id</code>为生态钱包<code>ecosystem_wallet</code>参数id，可通过如下方式查询：</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token operator">&gt;</span>getList @1parameters <span class="token parameter variable">-w</span><span class="token operator">=</span><span class="token punctuation">{</span><span class="token string">&quot;ecosystem&quot;</span><span class="token builtin class-name">:</span> <span class="token number">22</span>, <span class="token string">&quot;name&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;ecosystem_wallet&quot;</span><span class="token punctuation">}</span>
</code></pre></div><p><code>Value</code>值为将要绑定的生态钱包地址，合约产生的gas费，由该地址付款。该地址必须在当前生态有足够的代币，并且需要被绑定地址同意后才会修改成功。</p> <p>调用<code>@1EcoFeeModeManage</code>合约设置多生态扣费,如下：</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token operator">&gt;</span>callContract @1EcoFeeModeManage <span class="token punctuation">{</span><span class="token string">&quot;FollowFuel&quot;</span><span class="token builtin class-name">:</span> <span class="token number">0.01</span>, <span class="token string">&quot;CombustionFlag&quot;</span><span class="token builtin class-name">:</span> <span class="token number">1</span>, <span class="token string">&quot;VmCostFlag&quot;</span><span class="token builtin class-name">:</span> <span class="token number">2</span>, <span class="token string">&quot;VmCostConversionRate&quot;</span><span class="token builtin class-name">:</span> <span class="token number">100</span>, <span class="token string">&quot;StorageConversionRate&quot;</span><span class="token builtin class-name">:</span> <span class="token number">100</span>, <span class="token string">&quot;StorageFlag&quot;</span><span class="token builtin class-name">:</span> <span class="token number">2</span>, <span class="token string">&quot;ExpediteFlag&quot;</span><span class="token builtin class-name">:</span> <span class="token number">1</span><span class="token punctuation">}</span>
</code></pre></div><p>其中合约参数字段定义如下：</p> <ul><li><code>FollowFuel</code>        参数为跟随生态1费率的倍数。</li> <li><code>CombustionFlag</code>	是否开启生态交易gas费燃烧，1-否，2-是。</li> <li><code>CombustionPercent</code>	燃烧百分比，仅开启gas费燃烧生效,取值1到100，未开启时为0。</li> <li><code>VmCostFlag</code>	    虚拟机费用标识，设置直付或代付，1-直付，2-代付。</li> <li><code>StorageFlag</code>	    存储费用标识，设置直付或代付，1-直付，2-代付。</li> <li><code>ExpediteFlag</code>	    加急费用标识，设置直付或代付，1-直付，2-代付。</li> <li><code>VmCostConversionRate</code>	   虚拟机费用转换率，小数位2位，仅代付生效，大于零。</li> <li><code>StorageConversionRate</code>	   存储费用转换率，小数位2位，仅代付生效，大于零。</li></ul> <p>如果你使用了上述设置,所有用户在该生态内调用合约所产生的交易费用，由当前生态设置的生态钱包统一支付。所有用户只需要支付在该生态内所产生的gas费用.当然你可以根据实际需要，调整对应费用参数。</p> <h3 id="dao-governance-ecosystem"><a href="#dao-governance-ecosystem" class="header-anchor">#</a> DAO治理生态 </h3> <p>在修改为DAO治理生态之前，你需要确保当前生态已经发行代币，修改为DAO治理生态后，生态所有的提案都将由治理委员会成员投票决定，不再单独由生态开发者管理， DAO治理委员会成员由生态持币量前50名代表当选。</p> <p>调用<code>@1EditControlMode</code>合约，将生态治理模式改为DAO治理模式。</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token operator">&gt;</span>callContract @1EditControlMode <span class="token punctuation">{</span><span class="token string">&quot;Value&quot;</span><span class="token builtin class-name">:</span> <span class="token number">2</span><span class="token punctuation">}</span>
</code></pre></div><p>其中<code>Value</code>参数 <code>1</code>表示创建者模型 <code>2</code>表示DAO治理模型。</p> <p>我们可以试着创建一个应用：</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token operator">&gt;</span>callContract @1NewApplication <span class="token punctuation">{</span><span class="token string">&quot;Name&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;testApp&quot;</span>, <span class="token string">&quot;Conditions&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;ContractConditions(<span class="token entity" title="\&quot;">\&quot;</span>@1DeveloperCondition<span class="token entity" title="\&quot;">\&quot;</span>)&quot;</span><span class="token punctuation">}</span>
</code></pre></div><p>这个时候会生成一个DAO治理提案，经过DAO治理委员会投票通过后才会创建应用.有效提案需75%的投票数中68%的通过率.
DAO治理范围包括：
1、增删改应用、合约、页面、代码片段、选项卡、菜单、应用参数、数据表及字段。
2、修改多语言。
3、DAO和创建者模型开关。
4、编辑生态参数。
5、角色，分配移除角色成员。
6、增发销毁币种。
7、修改平台参数。
8、修改生态信息。
9、修改延迟合约。
10、修改投票模版。</p> <h2 id="deploy-applications-using-application-packaging-tool"><a href="#deploy-applications-using-application-packaging-tool" class="header-anchor">#</a> 使用应用打包工具部署应用 </h2> <p>在开始本教程之前，你需要下载<a href="https://github.com/IBAX-io/app-tool" target="_blank" rel="noopener noreferrer">IBAX应用打包工具<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ,我们需要使用这个工具打包IBAX应用程序。</p> <p>我们需要按照以下目录结构存放应用程序文件：</p> <div class="language-text extra-class"><pre class="language-text"><code>- APP Name
    - app_params
        params1.csv
        params2.csv
        ...
    - contracts
        contract1.sim
        contract2.sim
        ...
    - tables
        tableName1.json
        tableName2.json
        ...
    config.json
</code></pre></div><p>如下所示：</p> <div class="language-shell extra-class"><pre class="language-shell"><code>airdrop$ <span class="token function">ls</span> *
config.json

app_params:
dedicated_account.csv  lock_percent.csv  per_period_sec.csv  period_count.csv

contracts:
AddAirdrop.sim  ClaimAirdrop.sim  SpeedAirdrop.sim

tables:
airdrop_info.json
</code></pre></div><p>其中<code>app_params</code>目录存放应用参数文件，命名使用参数名+文件格式<code>.csv</code>，文件内容为参数值.<code>contracts</code>目录存放合约，<code>.sim</code>文件格式，文件内容为合约源码.<code>tables</code>目录存放应用数据表结构，<code>json</code>文件格式，如下所示：</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">[</span>
  <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;account&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;conditions&quot;</span><span class="token operator">:</span> <span class="token string">&quot;{\&quot;read\&quot;: \&quot;true\&quot;, \&quot;update\&quot;: \&quot;ContractConditions(\&quot;MainCondition\&quot;)\&quot;}&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;varchar&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;balance_amount&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;conditions&quot;</span><span class="token operator">:</span> <span class="token string">&quot;true&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;money&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;stake_amount&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;conditions&quot;</span><span class="token operator">:</span> <span class="token string">&quot;true&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;money&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;surplus&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;conditions&quot;</span><span class="token operator">:</span> <span class="token string">&quot;true&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;number&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;total_amount&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;conditions&quot;</span><span class="token operator">:</span> <span class="token string">&quot;true&quot;</span><span class="token punctuation">,</span> <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;money&quot;</span> <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre></div><p><code>name</code>为数据表字段名称，<code>conditions</code>为数据表字段权限，<code>type</code>为字段类型。</p> <p>第1步，我们生成一个config.json文件，将它保存到airdrop目录，文件内容如下所示：</p> <div class="language-text extra-class"><pre class="language-text"><code>{
    &quot;name&quot;: &quot;Airdrop&quot;,
    &quot;conditions&quot;: &quot;ContractConditions(\&quot;@1MainCondition\&quot;)&quot;
}
</code></pre></div><p>其中<code>name</code>为此应用的名称，<code>conditions</code>: 为修改该应用的权限，然后将它保存到airdrop目录.</p> <p>第2步,打包应用，通过以下命令会在当前目录生成应用<code>airdrop.json</code>,如果你修改了合约或应用参数，需要重新打包应用.</p> <div class="language-shell extra-class"><pre class="language-shell"><code>$ ./app-tool airdrop/
</code></pre></div><p>我们可以通过<a href="https://github.com/IBAX-io/ibax-cli" target="_blank" rel="noopener noreferrer">命令行工具<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 导入应用,如下所示：</p> <p>使用<code>import</code>命令导入应用，<code>-f</code>参数为指定导入的应用文件。</p> <div class="language-shell extra-class"><pre class="language-shell"><code>$ ibax-cli console

Welcome to the IBAX console<span class="token operator">!</span>
To exit, press ctrl-d or <span class="token builtin class-name">type</span> <span class="token builtin class-name">exit</span>

<span class="token operator">&gt;</span>import <span class="token parameter variable">-f</span> ./airdrop.json
</code></pre></div><p>当然如果你有一个应用，也可以通过以下命令生成完整的目录结构。</p> <div class="language-shell extra-class"><pre class="language-shell"><code>$ app-tool.exe airdrop.json
</code></pre></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/IBAX-io/documentation/edit/master/docs/zh-CN/tutorials/tutorial.md" target="_blank" rel="noopener noreferrer">在 GitHub 上编辑此页</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2023/6/25 15:46:02</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/zh-CN/tutorials/app_tutorial.html" class="prev">
        应用程序开发教程 {#tutorial-for-application-development}
      </a></span> <!----></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.8ffd1d30.js" defer></script><script src="/assets/js/2.8d94a0db.js" defer></script><script src="/assets/js/168.bad3d875.js" defer></script>
  </body>
</html>
