(window.webpackJsonp=window.webpackJsonp||[]).push([[150],{425:function(t,s,a){"use strict";a.r(s);var e=a(14),n=Object(e.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"ibax-development-tutorial"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ibax-development-tutorial"}},[t._v("#")]),t._v(" IBAX开发教程 ")]),t._v(" "),s("h2",{attrs:{id:"getting-started-guide"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#getting-started-guide"}},[t._v("#")]),t._v(" 入门指南 ")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"#deploy-first-smart-contract-via-command-line-tool"}},[t._v("通过命令行工具部署第一个智能合约")])]),t._v(" "),s("li",[s("a",{attrs:{href:"#command-line-tool-eco-development"}},[t._v("命令行工具生态开发")])])]),t._v(" "),s("h2",{attrs:{id:"deployment"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#deployment"}},[t._v("#")]),t._v(" 部署 ")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"#deploy-application-using-command-line-tools"}},[t._v("使用命令行工具部署应用")])]),t._v(" "),s("li",[s("a",{attrs:{href:"#ecological-configuration-using-command-line-tool"}},[t._v("使用命令行工具生态配置")])])]),t._v(" "),s("h2",{attrs:{id:"advanced-guide"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#advanced-guide"}},[t._v("#")]),t._v(" 进阶指南 ")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"#deploy-applications-using-application-packaging-tool"}},[t._v("使用应用打包工具部署应用")])])]),t._v(" "),s("h2",{attrs:{id:"deploy-first-smart-contract-via-command-line-tool"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#deploy-first-smart-contract-via-command-line-tool"}},[t._v("#")]),t._v(" 通过命令行工具部署第一个智能合约 ")]),t._v(" "),s("p",[t._v("我们将通过"),s("a",{attrs:{href:"https://github.com/IBAX-io/ibax-cli",target:"_blank",rel:"noopener noreferrer"}},[t._v("命令行工具"),s("OutboundLink")],1),t._v(" 在IBAX区块链上部署"),s("RouterLink",{attrs:{to:"/zh-CN/concepts/thesaurus.html#smart-contract"}},[t._v("智能合约")]),t._v(" , 并学习何如调用智能合约。\n作为我们的第一个智能合约，我们将其部署到"),s("RouterLink",{attrs:{to:"/zh-CN/concepts/blockchain-layers.html"}},[t._v("本地测试网络")]),t._v(" 上，\n如何部署本地网络你可以参考"),s("RouterLink",{attrs:{to:"/zh-CN/howtos/deployment.html"}},[t._v("网络部署")]),t._v(" , 因此您不需要任何开销就可以随意部署和运行它。")],1),t._v(" "),s("h3",{attrs:{id:"create-application"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#create-application"}},[t._v("#")]),t._v(" 创建应用 ")]),t._v(" "),s("p",[t._v("调用合约@1NewApplication创建应用，该合约有一个应用名称参数和一个修改"),s("RouterLink",{attrs:{to:"/zh-CN/concepts/about-the-platform.html#access-rights-control-mechanism"}},[t._v("权限参数")]),t._v(" 。")],1),t._v(" "),s("div",{staticClass:"language-text extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('1    $ ibax-cli console\n2    \n3    Welcome to the IBAX console!\n4    To exit, press ctrl-d or type exit\n5  >callContract @1NewApplication {"Name": "testapp", "Conditions": "ContractConditions(\\"@1DeveloperCondition\\")"}\n6  \n7  {\n8      "block_id": 1217,\n9      "hash": "6327161d2202c33c06d34ab4ed9b509c05fc2cbb15cf260c6d3d404a6f640028",\n10      "penalty": 0,\n11      "err": "31"\n12  }\n')])])]),s("p",[t._v("下面按行解释：")]),t._v(" "),s("ul",[s("li",[t._v("第1行，启动命令行终端。")]),t._v(" "),s("li",[t._v("第5行，调用合约@1NewApplication创建一个应用，应用名称为"),s("code",[t._v("testapp")]),t._v(",应用修改权限为开发者权限"),s("code",[t._v("@1DeveloperCondition")]),t._v("。")]),t._v(" "),s("li",[t._v("第8行，交易产生的区块id。")]),t._v(" "),s("li",[t._v("第9行，交易产生的区块哈希。")]),t._v(" "),s("li",[t._v("第10行，如果交易执行失败（0：无惩罚 1：惩罚）。")]),t._v(" "),s("li",[t._v("第11行，如果交易执行失败，则返回一条错误文本消息，如果返回了区块id，err字段为该应用的id。")])]),t._v(" "),s("p",[t._v("当然如果你想查看这个合约有哪些字段，字段类型，可以调用"),s("code",[t._v("getContractInfo")]),t._v("方法,它将返回合约信息，如下：")]),t._v(" "),s("div",{staticClass:"language-text extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('>getContractInfo @1NewApplication\n\n{\n    "id": 5022,\n    "state": 1,\n    "tableid": "22",\n    "walletid": "0",\n    "tokenid": "1",\n    "address": "0000-0000-0000-0000-0000",\n    "fields": [\n        {\n            "name": "Name",\n            "type": "string",\n            "optional": false\n        },\n        {\n            "name": "Conditions",\n            "type": "string",\n            "optional": false\n        },\n        {\n            "name": "VotingId",\n            "type": "int",\n            "optional": true\n        }\n    ],\n    "name": "@1NewApplication",\n    "app_id": 1,\n    "ecosystem": 1,\n    "conditions": "ContractConditions(\\"@1DeveloperCondition\\")"\n}\n')])])]),s("p",[s("code",[t._v("fields")]),t._v("字段为该合约的参数,包括参数的名称"),s("code",[t._v("name")]),t._v("，类型"),s("code",[t._v("type")]),t._v("，可选项"),s("code",[t._v("optional")]),t._v("，"),s("code",[t._v("Name")]),t._v("和"),s("code",[t._v("Conditions")]),t._v("为必填项，"),s("code",[t._v("VotingId")]),t._v("为可选项,可参考"),s("RouterLink",{attrs:{to:"/zh-CN/reference/api2.html#contract-name"}},[t._v("contract/name")]),t._v("  API方法。")],1),t._v(" "),s("h3",{attrs:{id:"writing-contracts"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#writing-contracts"}},[t._v("#")]),t._v(" 编写合约 ")]),t._v(" "),s("p",[t._v("我们使用"),s("RouterLink",{attrs:{to:"/zh-CN/topics/script.html#needle-contract-language"}},[t._v("Needle")]),t._v(" 编写智能合约，\n我们实现一个简单的加法运算，合约源码如下,我们将合约保存为"),s("code",[t._v("SumMath.sim")]),t._v("。")],1),t._v(" "),s("div",{staticClass:"language-text extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("1    contract SumMath {\n2        data {\n3            A int\n4            B int\n5        }\n6        conditions {\n7    \n8        }\n9        action {\n10            var sum int\n11            sum = $A + $B\n12            $result = sum\n13        }\n14    }\n")])])]),s("p",[t._v("下面按行解释：")]),t._v(" "),s("ul",[s("li",[t._v("第1行，我们定义了一个名称为SumMath的合约。")]),t._v(" "),s("li",[t._v("第2行, "),s("RouterLink",{attrs:{to:"/zh-CN/topics/script.html#data-section"}},[t._v("数据部分")]),t._v(" 。")],1),t._v(" "),s("li",[t._v("第3-第4行，我们定义了两个输入64位整数型参数"),s("code",[t._v("A B")]),t._v("。")]),t._v(" "),s("li",[t._v("第6行,"),s("RouterLink",{attrs:{to:"/zh-CN/topics/script.html#conditions-section"}},[t._v("条件部分")]),t._v(" 。")],1),t._v(" "),s("li",[t._v("第9行,"),s("RouterLink",{attrs:{to:"/zh-CN/topics/script.html#action-section"}},[t._v("操作部分")]),t._v(" 我们定义了一个变量sum，用于接收A+B结果，\n将sum的值赋给$result,作为合约的返回结果.当然也可以直接将A+B的值赋给$result，但它可以作为一个例子展示.")],1)]),t._v(" "),s("h3",{attrs:{id:"create-contract"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#create-contract"}},[t._v("#")]),t._v(" 创建合约 ")]),t._v(" "),s("p",[t._v("有两种方法创建合约，第一种方法：\n第一步我们编写一个合约参数文件，文件格式为json：")]),t._v(" "),s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"ApplicationId"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("31")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"Value"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"contract SumMath {\\n    data {\\n        A int\\n        B int\\n    }\\n    conditions {\\n\\n    }\\n    action {\\n        var sum int\\n        sum = $A + $B\\n        $result = sum\\n    }\\n}"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"Conditions"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ContractConditions(\\"@1DeveloperCondition\\")"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("其中"),s("code",[t._v("ApplicationId")]),t._v("为应用id,"),s("code",[t._v("Value")]),t._v("为合约源码，需要对特殊字符进行转义处理，"),s("code",[t._v("Conditions")]),t._v("为该合约修改权限。")]),t._v(" "),s("p",[t._v("我们将它命名为"),s("code",[t._v("SumMathParams.json")]),t._v("。")]),t._v(" "),s("p",[t._v("第二步调用创建合约@1NewContract。")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('1    >callContract @1NewContract -f=./data/SumMathParams.json\n2    {\n3        "block_id": 1238,\n4        "hash": "f3fe7aff8a613c96299723b7e9af0682aa8cabe7becf67a485e2a77a974f58b6",\n5        "penalty": 0,\n6        "err": "328"\n7    }\n')])])]),s("p",[t._v("第二种方法：\n直接将保存的合约源码文件传入合约参数中，参数格式为"),s("code",[t._v("参数名称")]),t._v("+ "),s("code",[t._v("-")]),t._v(' + "file",'),s("code",[t._v("paramsName-file")]),t._v("如下：")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("    "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("callContract @1NewContract "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ApplicationId"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("31")]),t._v(", "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Value-file"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"SumMath.sim"')]),t._v(", "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Conditions"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"true"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("    \n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("        "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"block_id"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2055")]),t._v(",\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v("        "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"hash"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"cdf25060669cf7cba137278...26ca463fd5d458f3402a5f0137f693db"')]),t._v(",\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v("        "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"penalty"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(",\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),t._v("        "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"err"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"368"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("7")]),t._v("    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("下面按行解释：")]),t._v(" "),s("ul",[s("li",[t._v("第1行：调用合约@1NewContract创建合约，-f使用文件导入合约参数。")]),t._v(" "),s("li",[t._v("第3行，交易产生的区块id。")]),t._v(" "),s("li",[t._v("第4行，交易产生的区块哈希。")]),t._v(" "),s("li",[t._v("第5行，如果交易执行失败（0：无惩罚 1：惩罚）。")]),t._v(" "),s("li",[t._v("第6行，如果交易执行失败，则返回一条错误文本消息，如果返回了区块id，err字段为该合约的id。")])]),t._v(" "),s("p",[t._v("我们试着调用一下刚刚部署的合约。")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('1  >callContract @5SumMath {"A":1, "B":2}\n2  \n3  {\n4      "block_id": 1239,\n5      "hash": "7fa09da0b9f65634119a910f9d91aaf4927208278efd62961499ef7e4f4c8c9c",\n6      "penalty": 0,\n7      "err": "3"\n8  }\n')])])]),s("p",[t._v("调用完成，结果符合预期,下面按行解释：")]),t._v(" "),s("ul",[s("li",[t._v("第1行调用合约，这里我们将合约部署到了生态id为5的生态里，当然如果当前所在生态id为5,同一个生态中时，也可以这么调用"),s("code",[t._v('callContract SumMath {"A":1, "B":2}')]),t._v("。")]),t._v(" "),s("li",[t._v("第3行，交易产生的区块id。")]),t._v(" "),s("li",[t._v("第4行，交易产生的区块哈希。")]),t._v(" "),s("li",[t._v("第5行，如果交易执行失败（0：无惩罚 1：惩罚）。")]),t._v(" "),s("li",[t._v("第6行，如果交易执行失败，则返回一条错误文本消息，如果返回了区块id，err字段为该合约的结果，也就是"),s("code",[t._v("$result")]),t._v("的值。")])]),t._v(" "),s("h2",{attrs:{id:"command-line-tool-eco-development"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#command-line-tool-eco-development"}},[t._v("#")]),t._v(" 命令行工具生态开发 ")]),t._v(" "),s("p",[t._v("在本教程中，您将学习如何：\n1、"),s("a",{attrs:{href:"#step-1-create-ecosystem"}},[t._v("创建生态")]),t._v("\n2、"),s("a",{attrs:{href:"#step-2-create-application"}},[t._v("创建应用")]),t._v("\n3、"),s("a",{attrs:{href:"#step-3-create-table"}},[t._v("创建数据表")]),t._v("\n4、"),s("a",{attrs:{href:"#step-4-create-application-parameters"}},[t._v("创建应用参数")]),t._v("\n5、"),s("a",{attrs:{href:"#step-5-create-contract-deploy-contract"}},[t._v("创建和部署合约")]),t._v("\n6、"),s("a",{attrs:{href:"#step-6-create-ecological-parameters"}},[t._v("创建生态参数")]),t._v("\n7、"),s("a",{attrs:{href:"#step-7-add-localization"}},[t._v("添加本地化")]),t._v("\n8、"),s("a",{attrs:{href:"#step-8-modify-the-contract"}},[t._v("修改合约")]),t._v("\n9、"),s("a",{attrs:{href:"#step-9-modify-data-table-permissions"}},[t._v("修改数据表权限")])]),t._v(" "),s("p",[t._v("为了更清楚的了解IBAX生态与应用是怎么样的，做什么用的，首选我们了解一下生态和应用应该属于那一部分，我们通过一个简单的思维导图可以更好的理解：\n"),s("img",{attrs:{src:"_ststic/ibax-eco.png",alt:"image"}})]),t._v(" "),s("p",[t._v("可以看到IBAX网络可以有许多"),s("RouterLink",{attrs:{to:"/zh-CN/concepts/about-the-platform.html#ecolib"}},[t._v("生态")]),t._v(" ,\n每个生态可以有多个"),s("a",{attrs:{href:"https://docs.ibax.io/concepts/about-the-platform.html#applications",target:"_blank",rel:"noopener noreferrer"}},[t._v("应用"),s("OutboundLink")],1),t._v(" ,\n每个应用都有"),s("a",{attrs:{href:"https://docs.ibax.io/concepts/thesaurus.html#smart-contract",target:"_blank",rel:"noopener noreferrer"}},[t._v("合约"),s("OutboundLink")],1),t._v(" ,\n"),s("a",{attrs:{href:"https://docs.ibax.io/concepts/about-the-platform.html#tables",target:"_blank",rel:"noopener noreferrer"}},[t._v("数据表"),s("OutboundLink")],1),t._v(" , 生态有生态参数，应用有应用参数")],1),t._v(" "),s("h3",{attrs:{id:"step-1-create-ecosystem"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#step-1-create-ecosystem"}},[t._v("#")]),t._v(" 第1步创建生态 ")]),t._v(" "),s("p",[t._v("我们先使用"),s("a",{attrs:{href:"https://github.com/IBAX-io/ibax-cli",target:"_blank",rel:"noopener noreferrer"}},[t._v("命令行工具"),s("OutboundLink")],1),t._v(" 创建一个生态, 调用合约@1NewEcosystem.\n如果你想修改生态名称，可以调用"),s("code",[t._v("@1EditEcosystemName")]),t._v("合约.")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("    $ ibax-cli console\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("    \n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("    Welcome to the IBAX console"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v("    To exit, press ctrl-d or "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("type")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("exit")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v("    "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("callContract @1NewEcosystem "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Name"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"goodBoy school"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),t._v("    \n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("7")]),t._v("    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),t._v("        "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"block_id"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1199")]),t._v(",\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("9")]),t._v("        "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"hash"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"a1dc90c1772545c16394b9521645ae60c0c292227676b27b145743556a8973dd"')]),t._v(",\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v("       "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"penalty"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(",\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("11")]),t._v("       "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"err"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"18"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("12")]),t._v("   "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("下面按行解释：")]),t._v(" "),s("ul",[s("li",[t._v("第1行，启动了命令行控制台程序。")]),t._v(" "),s("li",[t._v("第5行，调用合约@1NewEcosystem创建一个生态，该生态名称为"),s("code",[t._v("test ecosystem")]),t._v("。")]),t._v(" "),s("li",[t._v("第8行，交易产生的区块id。")]),t._v(" "),s("li",[t._v("第9行，交易产生的区块哈希。")]),t._v(" "),s("li",[t._v("第10行，如果交易执行失败（0：无惩罚 1：惩罚）。")]),t._v(" "),s("li",[t._v("第11行，如果交易执行失败，则返回一条错误文本消息，如果返回了区块id，err字段为该生态的id为"),s("code",[t._v("18")]),t._v("。")])]),t._v(" "),s("p",[t._v("然后我们配置命令工具"),s("code",[t._v("config.yml")]),t._v("，将"),s("code",[t._v("ecosystem")]),t._v("设置为创建的生态id"),s("code",[t._v("18")]),t._v("，重新启动命令行控制台程序。")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("exit\nINFO"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("0002"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" Exit\n\n$ "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("vim")]),t._v(" data/config.yml\n\n$ ibax-cli console\n\nWelcome to the IBAX console"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("\nTo exit, press ctrl-d or "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("type")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("exit")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])])]),s("h3",{attrs:{id:"step-2-create-application"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#step-2-create-application"}},[t._v("#")]),t._v(" 第2步创建应用 ")]),t._v(" "),s("p",[t._v("调用合约"),s("code",[t._v("@1NewApplication")]),t._v("创建应用，该合约有一个应用名称参数和一个修改"),s("a",{attrs:{href:"https://docs.ibax.io/concepts/about-the-platform.html#access-rights-control-mechanism",target:"_blank",rel:"noopener noreferrer"}},[t._v("权限参数"),s("OutboundLink")],1),t._v(" 。")]),t._v(" "),s("div",{staticClass:"language-text extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('1  >callContract @1NewApplication {"Name": "GradesRecorder", "Conditions": "ContractConditions(\\"@1DeveloperCondition\\")"}\n2  \n3  {\n4     "block_id": 1246,\n5     "hash": "85ab8953d26d0d1047fc610866115331babfaf88c80792d50b41826185c9f6f8",\n6     "penalty": 0,\n7     "err": "47"\n8  }\n')])])]),s("p",[t._v("如果你需要修改应用权限，可以调用"),s("code",[t._v("EditApplication")]),t._v("合约。")]),t._v(" "),s("p",[t._v("下面按行解释：")]),t._v(" "),s("ul",[s("li",[t._v("第1行，调用合约@1NewApplication创建一个应用，应用名称为"),s("code",[t._v("GradesRecorder")]),t._v(",应用修改权限为开发者权限"),s("code",[t._v("@1DeveloperCondition")]),t._v("。")]),t._v(" "),s("li",[t._v("第4行，交易产生的区块id。")]),t._v(" "),s("li",[t._v("第5行，交易产生的区块哈希。")]),t._v(" "),s("li",[t._v("第6行，如果交易执行失败（0：无惩罚 1：惩罚）。")]),t._v(" "),s("li",[t._v("第7行，如果交易执行失败，则返回一条错误文本消息，如果返回了区块id，err字段该应用的id为"),s("code",[t._v("47")]),t._v("。")])]),t._v(" "),s("p",[t._v("我们写一个简单的例子，这个应用可以记录学生的成绩，\n数据表字段包括学生的信息，年级"),s("code",[t._v("grade")]),t._v("，班级"),s("code",[t._v("class")]),t._v("，科目成绩"),s("code",[t._v("mathematics,physics,literature")]),t._v("，\n综合评分"),s("code",[t._v("overall_score")]),t._v("，评级"),s("code",[t._v("score")]),t._v(",创建时间戳（ms）"),s("code",[t._v("created_at")]),t._v("。")]),t._v(" "),s("h3",{attrs:{id:"step-3-create-table"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#step-3-create-table"}},[t._v("#")]),t._v(" 第3步创建数据表 ")]),t._v(" "),s("p",[t._v("第一步我们编写一个合约参数文件，文件格式为json：")]),t._v(" "),s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"ApplicationId"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("47")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"Name"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"grade_info"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"ColumnsArr"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"student"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"grade"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"class"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"mathematics"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"physics"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"literature"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"overall_score"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"score"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"created_at"')]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"TypesArr"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"varchar"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"number"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"number"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"number"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"number"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"number"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"number"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"varchar"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"number"')]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"InsertPerm"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ContractConditions(\\"MainCondition\\")"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"UpdatePerm"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ContractConditions(\\"MainCondition\\")"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"ReadPerm"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"true"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"NewColumnPerm"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ContractConditions(\\"MainCondition\\")"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("其中"),s("code",[t._v("ApplicationId")]),t._v("为应用id,"),s("code",[t._v("Name")]),t._v("为创建的数据表名"),s("code",[t._v("test_teble")]),t._v("，\n"),s("code",[t._v("ColumnsArr")]),t._v("为数据表字段数组，"),s("code",[t._v("TypesArr")]),t._v("为数据表字段的类型，包括9种"),s("RouterLink",{attrs:{to:"/zh-CN/concepts/about-the-platform.html#tables"}},[t._v("类型")]),t._v(" 。\n"),s("code",[t._v("varchar")]),t._v(","),s("code",[t._v("character")]),t._v(","),s("code",[t._v("json")]),t._v(","),s("code",[t._v("number")]),t._v(","),s("code",[t._v("datetime")]),t._v(","),s("code",[t._v("double")]),t._v(","),s("code",[t._v("money")]),t._v(","),s("code",[t._v("text")]),t._v(","),s("code",[t._v("bytea")]),t._v(",字段名跟字段类型是一一对应关系，\n"),s("code",[t._v("InsertPerm")]),t._v("为数据表新建条目权限，"),s("code",[t._v("UpdatePerm")]),t._v("为数据表更新条目权限，"),s("code",[t._v("ReadPerm")]),t._v("为数据表数据读取权限，"),s("code",[t._v("NewColumnPerm")]),t._v("为新建数据表字段权限。\n参考"),s("RouterLink",{attrs:{to:"/zh-CN/concepts/about-the-platform.html#access-rights-control-mechanism"}},[t._v("权限管理")]),t._v(" ,这里的"),s("code",[t._v('ContractConditions(\\"MainCondition\\")')]),t._v("为当前生态创建者可用。")],1),t._v(" "),s("p",[t._v("我们将它命名为createTable.json,然后调用合约创建数据表"),s("code",[t._v("@1NewTableJoint")]),t._v("。")]),t._v(" "),s("div",{staticClass:"language-text extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v(">callContract @1NewTableJoint -f ./createTestTable.json\n")])])]),s("h4",{attrs:{id:"modify-data-table-field-permissions"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#modify-data-table-field-permissions"}},[t._v("#")]),t._v(" 修改数据表字段权限 ")]),t._v(" "),s("p",[t._v("我们可以修改数据表字段权限,数据表字段权限包括读取权限和更新权限，其中读取权限，在合约使用"),s("code",[t._v("DBFind.Columns")]),t._v("筛选字段或者接口如"),s("a",{attrs:{href:"https://docs.ibax.io/reference/api2.html#list-name-limit-offset-columns",target:"_blank",rel:"noopener noreferrer"}},[t._v("list"),s("OutboundLink")],1),t._v(" 查询时,如果没有权限则会报权限错误,\n更新权限即为更新数据表字段的权限。\n我们将"),s("code",[t._v("student")]),t._v("字段读取和更新权限设置为"),s("code",[t._v("false")]),t._v("，当然也可以设置为某个合约可操作。\n调用"),s("code",[t._v("@1EditColumn")]),t._v("合约修改数据表字段权限。")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("callContract @1EditColumn "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"TableName"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"grade_info"')]),t._v(", "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Name"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"student"')]),t._v(", "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"UpdatePerm"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"false"')]),t._v(", "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ReadPerm"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"false"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("我们可以创建几个应用参数"),s("code",[t._v("grade_best_type")]),t._v(","),s("code",[t._v("grade_type_a+")]),t._v(","),s("code",[t._v("grade_type_a")]),t._v(","),s("code",[t._v("grade_type_b+")]),t._v(","),s("code",[t._v("grade_type_b")]),t._v(","),s("code",[t._v("grade_type_c")]),t._v(",成绩评级类型。")]),t._v(" "),s("h3",{attrs:{id:"step-4-create-application-parameters"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#step-4-create-application-parameters"}},[t._v("#")]),t._v(" 第4步创建应用参数 ")]),t._v(" "),s("p",[t._v("调用合约"),s("code",[t._v("@1NewAppParam")]),t._v("创建应用参数,如果你要修改应用参数可以调用"),s("code",[t._v("@1EditAppParam")]),t._v("合约.")]),t._v(" "),s("div",{staticClass:"language-text extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('>callContract @1NewAppParam {"ApplicationId": 47, "Name": "grade_best_type", "Value": "A+", "Conditions": "ContractConditions(\\"MainCondition\\")"}\n>callContract @1NewAppParam {"ApplicationId": 47, "Name": "grade_type_a+", "Value": "{\\"max\\": 101,\\"min\\": 90}", "Conditions": "ContractConditions(\\"MainCondition\\")"}\n>callContract @1NewAppParam {"ApplicationId": 47, "Name": "grade_type_a", "Value": "{\\"max\\": 90,\\"min\\": 80}", "Conditions": "ContractConditions(\\"MainCondition\\")"}\n>callContract @1NewAppParam {"ApplicationId": 47, "Name": "grade_type_b+", "Value": "{\\"max\\": 80,\\"min\\": 70}", "Conditions": "ContractConditions(\\"MainCondition\\")"}\n>callContract @1NewAppParam {"ApplicationId": 47, "Name": "grade_type_b", "Value": "{\\"max\\": 70,\\"min\\": 60}", "Conditions": "ContractConditions(\\"MainCondition\\")"}\n>callContract @1NewAppParam {"ApplicationId": 47, "Name": "grade_type_c", "Value": "{\\"max\\": 60,\\"min\\": 0}", "Conditions": "ContractConditions(\\"MainCondition\\")"}\n')])])]),s("p",[t._v("其中"),s("code",[t._v("grade_best_type")]),t._v("为最好的评级类型，\n"),s("code",[t._v("grade_type_a+")]),t._v("为评级"),s("code",[t._v("A+")]),t._v("所触发的条件，当分数大于等于90并且小于101时，评为"),s("code",[t._v("A+")]),t._v(",其他参数类似。")]),t._v(" "),s("h3",{attrs:{id:"step-5-create-contract-deploy-contract"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#step-5-create-contract-deploy-contract"}},[t._v("#")]),t._v(" 第5步创建合约部署合约 ")]),t._v(" "),s("p",[t._v("我们创建一个合约，用于记录学生各科目成绩信息与最终评级，录入信息时输入学生的年级班级与各科目成绩，\n根据输入的各科的成绩做平均运算，得出综合评分"),s("code",[t._v("overallScore")]),t._v("与最终评级"),s("code",[t._v("score")]),t._v(",\n当调用合约时，将创建一条记录到我们刚刚创建的数据表中"),s("code",[t._v("grade_info")]),t._v("。")]),t._v(" "),s("p",[t._v("首先我们编写一个合约，将它命名为"),s("code",[t._v("NewRecord.sim")]),t._v("。")]),t._v(" "),s("div",{staticClass:"language-text extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('1\tcontract NewRecord {\t\t\t\t\n2\t    data {\t\t\t\t\n3\t        Student string\t\t\t\t\n4\t        Grade int\t\t\t\t\n5\t        Class int\t\t\t\t\n6\t        Mathematics int\t\t\t\t\n7\t        Physics int\t\t\t\t\n8\t        Literature int\t\t\t\t\n9\t    }\t\t\t\t\n10\t    func getScore(a b c int) map{\t\t\t\t\n11\t        var m map\t\t\t\t\n12\t        var overallScore int\t\t\t\t\n13\t        overallScore = (a+b+c) / 3\t\t\t\t\n14\t        m["overallScore"] = overallScore\t\t\t\t\n15\t        if overallScore >= $gradeTypeABest["min"] &amp;&amp; overallScore &lt; $gradeTypeABest["max"] {\t\t\t\t\n16\t            m["score"] = "A+"\t\t\t\t\n17\t        }elif overallScore >= $gradeTypeA["min"] &amp;&amp; overallScore &lt; $gradeTypeA["max"] {\t\t\t\t\n18\t            m["score"] = "A"\t\t\t\t\n19\t        }elif overallScore >= $gradeTypeBBest["min"] &amp;&amp; overallScore &lt; $gradeTypeBBest["max"] {\t\t\t\t\n20\t            m["score"] = "B+"\t\t\t\t\n21\t        }elif overallScore >= $gradeTypeB["min"] &amp;&amp; overallScore &lt; $gradeTypeB["max"] {\t\t\t\t\n22\t            m["score"] = "B"\t\t\t\t\n23\t        }elif overallScore >= $gradeTypeC["min"] &amp;&amp; overallScore &lt; $gradeTypeC["max"]{\t\t\t\t\n24\t            m["score"] = "C"\t\t\t\t\n25\t        }else{\t\t\t\t\n26\t            m["score"] = "Notset"\t\t\t\t\n27\t        }\t\t\t\t\n28\t        return m\t\t\t\t\n29\t    }\t\t\t\t\n30\t    func safeJsonDecode(m string) map {\t\t\t\t\n31\t        var res map\t\t\t\t\n32\t        if Size(m) > 0 {\t\t\t\t\n33\t            res = JSONDecode(m)\t\t\t\t\n34\t        }\t\t\t\t\n35\t        return res\t\t\t\t\n36\t    }\t\t\t\t\n37\t\t\t\t\t\n38\t    conditions {\t\t\t\t\n39\t        if Size($Student) == 0 {\t\t\t\t\n40\t            warning "Student Can not be empty"\t\t\t\t\n41\t        }\t\t\t\t\n42\t        if $Class &lt;= 0{\t\t\t\t\n43\t            warning "Class cannot be less than or equal to zero"\t\t\t\t\n44\t        }\t\t\t\t\n45\t        if $Grade &lt;= 0{\t\t\t\t\n46\t            warning "Grade cannot be less than or equal to zero"\t\t\t\t\n47\t        }\t\t\t\t\n48\t        if $Mathematics &lt; 0 {\t\t\t\t\n49\t            warning "Mathematics cannot be less than zero"\t\t\t\t\n50\t        }\t\t\t\t\n51\t        if $Physics &lt; 0 {\t\t\t\t\n52\t            warning "Physics cannot be less than zero"\t\t\t\t\n53\t        }\t\t\t\t\n54\t        if $Literature &lt; 0 {\t\t\t\t\n55\t            warning "Literature cannot be less than zero"\t\t\t\t\n56\t        }\t\t\t\t\n57\t        if $Mathematics > 100 || $Physics > 100 ||  $Literature > 100{\t\t\t\t\n58\t            warning "Score cannot exceed 100"\t\t\t\t\n59\t        }\t\t\t\t\n60\t        var app map\t\t\t\t\n61\t        app = DBFind("@1applications").Columns("id,ecosystem").Where({"ecosystem": 18,"name":"GradesRecorder","deleted":0}).Row()\t\t\t\t\n62\t        if !app {\t\t\t\t\n63\t            warning LangRes("@1app_not_found")\t\t\t\t\n64\t        }\t\t\t\t\n65\t\t\t\t\t\n66\t        var app_id int\t\t\t\t\n67\t        app_id = Int(app["id"])\t\t\t\t\n68\t        $eId = Int(app["ecosystem"])\t\t\t\t\n69\t        $gradeBestType = AppParam(app_id, "grade_best_type", $eId)\t\t\t\t\n70\t        $gradeTypeABest = safeJsonDecode(AppParam(app_id, "grade_type_a+", $eId))\t\t\t\t\n71\t        $gradeTypeA = safeJsonDecode(AppParam(app_id, "grade_type_a", $eId))\t\t\t\t\n72\t        $gradeTypeBBest = safeJsonDecode(AppParam(app_id, "grade_type_b+", $eId))\t\t\t\t\n73\t        $gradeTypeB = safeJsonDecode(AppParam(app_id, "grade_type_b", $eId))\t\t\t\t\n74\t        $gradeTypeC = safeJsonDecode(AppParam(app_id, "grade_type_c", $eId))\t\t\t\t\n75\t    }\t\t\t\t\n76\t    action {\t\t\t\t\n77\t        var m map \t\t\t\t\n78\t        m = getScore($Mathematics,$Physics,$Literature)\t\t\t\t\n79\t        var in map\t\t\t\t\n80\t        in["student"] = $Student\t\t\t\t\n81\t        in["class"] = $Class\t\t\t\t\n82\t        in["grade"] = $Grade\t\t\t\t\n83\t        in["mathematics"] = $Mathematics\t\t\t\t\n84\t        in["physics"] = $Physics \t\t\t\t\n85\t        in["literature"] = $Literature \t\t\t\t\n86\t        in["overall_score"] = m["overallScore"]\t\t\t\t\n87\t        in["score"] = m["score"]\t\t\t\t\n88\t        in["created_at"] = $time\t\t\t\t\n89\t        DBInsert("@"+ Str($eId)+"grade_info", in)\t\t\t\t\n90\t    }\t\t\t\t\n91\t}\t\t\t\t\n')])])]),s("p",[t._v("下面按行解释：")]),t._v(" "),s("ul",[s("li",[t._v("第2行，"),s("RouterLink",{attrs:{to:"/zh-CN/topics/script.html#data-section"}},[t._v("数据部分")]),t._v(" 定义了输入参数"),s("code",[t._v("Student")]),t._v("学生名称,"),s("code",[t._v("Grade")]),t._v("年级,"),s("code",[t._v("Class")]),t._v("班级,"),s("code",[t._v("Mathematics")]),t._v("数学分数,"),s("code",[t._v("Physics")]),t._v("物理分数,"),s("code",[t._v("Literature")]),t._v("文学分数。")],1),t._v(" "),s("li",[t._v("第10行，getScore函数，根据各科成绩得出综合评分与最终评级。")]),t._v(" "),s("li",[t._v("第30行，safeJsonDecode函数，将字符串进行json解码并转为map。")]),t._v(" "),s("li",[t._v("第38行，"),s("RouterLink",{attrs:{to:"/zh-CN/topics/script.html#conditions-section"}},[t._v("条件部分")]),t._v(" 。")],1),t._v(" "),s("li",[t._v("第39行，"),s("RouterLink",{attrs:{to:"/zh-CN/topics/script.html#action-section"}},[t._v("操作部分")]),t._v(" 。")],1)]),t._v(" "),s("p",[t._v("可以看到，当合约被调用时，首先走条件部分，验证合约输入参数是否有效，比如学生名称"),s("code",[t._v("if Size($Student) == 0 {")]),t._v("是否为空(第39行)，如果为空，则返回报错信息。\n"),s("code",[t._v('"Student Can not be empty"')]),t._v("(第30行),当所有输入参数都校验通过后，第61行，使用"),s("RouterLink",{attrs:{to:"/zh-CN/topics/script.html#dbfind"}},[t._v("DBFind")]),t._v(" 从数据库检索生态id为"),s("code",[t._v("18")]),t._v("，应用名称为"),s("code",[t._v("GradesRecorder")]),t._v("并且未删除"),s("code",[t._v("deleted=0")]),t._v("的应用信息，\n第69行-74行，使用"),s("RouterLink",{attrs:{to:"/zh-CN/topics/script.html#appparam"}},[t._v("AppParam")]),t._v(" 检索应用参数， 如"),s("code",[t._v('$gradeBestType = AppParam(app_id, "grade_best_type", $eId)')]),t._v("（第69行）,\n如果应用参数为json格式存储，如"),s("code",[t._v("grade_type_a")]),t._v(",你可以参考"),s("code",[t._v('$gradeTypeABest = safeJsonDecode(AppParam(app_id, "grade_type_a+", $eId))')]),t._v(",将获取到的应用参数通过safeJsonDecode函数转为map格式。")],1),t._v(" "),s("p",[t._v("然后执行到操作部分，调用getScore函数获取得出综合评分与最终评级(第10行),使用map存储，第79行，定义一个map，保存学生成绩信息，\n"),s("RouterLink",{attrs:{to:"/zh-CN/topics/script.html#dbinsert"}},[t._v("DBInsert")]),t._v(" 往数据表"),s("code",[t._v("@18grade_info")]),t._v("插入数据。")],1),t._v(" "),s("p",[t._v("有两种方法创建合约，第一种方法：\n首先我们编写一个合约参数文件，文件格式为json：")]),t._v(" "),s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"ApplicationId"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("47")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"Value"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"contract NewRecord {\\n    data {\\n        Student string\\n        Grade int\\n        Class int\\n        Mathematics int\\n        Physics int\\n        Literature int\\n    }\\n    func getScore(a b c int) map{\\n        var m map\\n        var overallScore int\\n        overallScore = (a+b+c) / 3\\n        m[\\"overallScore\\"] = overallScore\\n        if overallScore >= $gradeTypeABest[\\"min\\"] && overallScore < $gradeTypeABest[\\"max\\"] {\\n            m[\\"score\\"] = \\"A+\\"\\n        }elif overallScore >= $gradeTypeA[\\"min\\"] && overallScore < $gradeTypeA[\\"max\\"] {\\n            m[\\"score\\"] = \\"A\\"\\n        }elif overallScore >= $gradeTypeBBest[\\"min\\"] && overallScore < $gradeTypeBBest[\\"max\\"] {\\n            m[\\"score\\"] = \\"B+\\"\\n        }elif overallScore >= $gradeTypeB[\\"min\\"] && overallScore < $gradeTypeB[\\"max\\"] {\\n            m[\\"score\\"] = \\"B\\"\\n        }elif overallScore >= $gradeTypeC[\\"min\\"] && overallScore < $gradeTypeC[\\"max\\"]{\\n            m[\\"score\\"] = \\"C\\"\\n        }else{\\n            m[\\"score\\"] = \\"Notset\\"\\n        }\\n        return m\\n    }\\n    func safeJsonDecode(m string) map {\\n        var res map\\n        if Size(m) > 0 {\\n            res = JSONDecode(m)\\n        }\\n        return res\\n    }\\n\\n    conditions {\\n        if Size($Student) == 0 {\\n            warning \\"Student Can not be empty\\"\\n        }\\n        if $Class <= 0{\\n            warning \\"Class cannot be less than or equal to zero\\"\\n        }\\n         if $Grade <= 0{\\n            warning \\"Grade cannot be less than or equal to zero\\"\\n        }\\n        if $Mathematics < 0 {\\n            warning \\"Mathematics cannot be less than zero\\"\\n        }\\n        if $Physics < 0 {\\n            warning \\"Physics cannot be less than zero\\"\\n        }\\n        if $Literature < 0 {\\n            warning \\"Literature cannot be less than zero\\"\\n        }\\n        if $Mathematics > 100 || $Physics > 100 ||  $Literature > 100{\\n            warning \\"Score cannot exceed 100\\"\\n        }\\n        var app map\\n        app = DBFind(\\"@1applications\\").Columns(\\"id,ecosystem\\").Where({\\"ecosystem\\": 18,\\"name\\":\\"GradesRecorder\\",\\"deleted\\":0}).Row()\\n        if !app {\\n            warning LangRes(\\"@1app_not_found\\")\\n        }\\n\\n        var app_id int\\n        app_id = Int(app[\\"id\\"])\\n        $eId = Int(app[\\"ecosystem\\"])\\n        $gradeBestType = AppParam(app_id, \\"grade_best_type\\", $eId)\\n        $gradeTypeABest = safeJsonDecode(AppParam(app_id, \\"grade_type_a+\\", $eId))\\n        $gradeTypeA = safeJsonDecode(AppParam(app_id, \\"grade_type_a\\", $eId))\\n        $gradeTypeBBest = safeJsonDecode(AppParam(app_id, \\"grade_type_b+\\", $eId))\\n        $gradeTypeB = safeJsonDecode(AppParam(app_id, \\"grade_type_b\\", $eId))\\n        $gradeTypeC = safeJsonDecode(AppParam(app_id, \\"grade_type_c\\", $eId))\\n    }\\n    action {\\n        var m map \\n        m = getScore($Mathematics,$Physics,$Literature)\\n        var in map\\n        in[\\"student\\"] = $Student\\n        in[\\"class\\"] = $Class\\n        in[\\"grade\\"] = $Grade\\n        in[\\"mathematics\\"] = $Mathematics\\n        in[\\"physics\\"] = $Physics \\n        in[\\"literature\\"] = $Literature \\n        in[\\"overall_score\\"] = m[\\"overallScore\\"]\\n        in[\\"score\\"] = m[\\"score\\"]\\n        in[\\"created_at\\"] = $time\\n        DBInsert(\\"@\\"+ Str($eId)+\\"grade_info\\", in)\\n    }\\n}"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"Conditions"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ContractConditions(\\"@1DeveloperCondition\\")"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("其中"),s("code",[t._v("ApplicationId")]),t._v("为应用id,，需要对特殊字符进行转义处理，"),s("code",[t._v("Conditions")]),t._v("为该合约修改权限,\n"),s("code",[t._v("Value")]),t._v("合约源码，我们将它保存为"),s("code",[t._v("NewRecordParams.json")]),t._v("：")]),t._v(" "),s("p",[t._v("编写完合约后，我们需要部署合约，调用创建合约"),s("code",[t._v("@1NewContract")]),t._v("。")]),t._v(" "),s("div",{staticClass:"language-text extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('1    >>callContract @1NewContract -f=./data/NewRecordParams.json\n2    {\n3        "block_id": 1262,\n4        "hash": "d896f12f685835f6cf71705e1ba...4d8bcc0a1406f7b0b6482b2d230fc",\n5        "penalty": 0,\n6        "err": "348"\n7    }\n')])])]),s("p",[t._v("下面按行解释：")]),t._v(" "),s("ul",[s("li",[t._v("第1行：调用合约"),s("code",[t._v("@1NewContract")]),t._v("创建合约，-f使用文件导入刚刚创建的文件"),s("code",[t._v("NewRecord.json")]),t._v("作为合约参数。")]),t._v(" "),s("li",[t._v("第3行，交易产生的区块id。")]),t._v(" "),s("li",[t._v("第4行，交易产生的区块哈希。")]),t._v(" "),s("li",[t._v("第5行，如果交易执行失败（0：无惩罚 1：惩罚）。")]),t._v(" "),s("li",[t._v("第6行，如果交易执行失败，则返回一条错误文本消息，如果返回了区块id，err字段该合约的id为"),s("code",[t._v("348")]),t._v("。")])]),t._v(" "),s("p",[t._v("第二种方法：\n直接将保存的合约源码文件传入合约参数中，参数格式为"),s("code",[t._v("参数名称")]),t._v("+ "),s("code",[t._v("-")]),t._v(' + "file",'),s("code",[t._v("paramsName-file")]),t._v("如下：")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("callContract @1NewContract "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ApplicationId"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("47")]),t._v(", "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Value-file"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"NewRecord.sim"')]),t._v(", "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Conditions"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ContractConditions('),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v("@1DeveloperCondition"),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v(')"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("我们试着调用一下刚刚创建的合约。")]),t._v(" "),s("div",{staticClass:"language-text extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('1  >callContract @18NewRecord {"Student": "tom", "Grade": 1, "Class": 1, "Mathematics": 18, "Physics": 57, "Literature": 93}\n2  \n3  {\n4     "block_id": 1263,\n5     "hash": "1b964a47fe6c5fd43ea55a752d01edb5ad576432fd6f63315344d87999a0473d",\n6     "penalty": 0,\n7     "err": ""\n8  }\n')])])]),s("p",[t._v("调用完成,接着我们查一下数据表是否保存了一条记录。")]),t._v(" "),s("div",{staticClass:"language-text extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('>getList @18grade_info\n{\n    "count": 1,\n    "list": [\n        {\n            "class": "1",\n            "created_at": "1683698914109",\n            "grade": "1",\n            "id": "9",\n            "literature": "93",\n            "mathematics": "18",\n            "overall_score": "56",\n            "physics": "57",\n            "score": "C",\n            "student": "tom"\n        }\n    ]\n}\n')])])]),s("p",[t._v("可以看到在数据表中已有一条记录，"),s("code",[t._v("student")]),t._v(" tom的综合评分为56 评级为C。")]),t._v(" "),s("p",[t._v("以上例子仅用于学习研究使用，你需要根据实际情况更改相关参数，比如数据表的写入权限, 合约的修改权限等。")]),t._v(" "),s("p",[t._v("比如说我们要指定一个一个人才能调用这个新建记录的合约，其他所有人都不可以调用，我们可以设置一个生态参数"),s("code",[t._v("new_record_account")]),t._v("。")]),t._v(" "),s("h3",{attrs:{id:"step-6-create-ecological-parameters"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#step-6-create-ecological-parameters"}},[t._v("#")]),t._v(" 第6步设置生态参数 ")]),t._v(" "),s("p",[t._v("调用合约"),s("code",[t._v("@1NewParameter")]),t._v(",将在"),s("code",[t._v("@1parameters")]),t._v("表创建生态参数"),s("code",[t._v("new_record_account")]),t._v(",如果你需要修改生态参数可以调用"),s("code",[t._v("@1EditParameter")]),t._v("。")]),t._v(" "),s("div",{staticClass:"language-text extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('>callContract @1NewParameter {"Name": "new_record_account", "Value": "6667782293976713160", "Conditions": "ContractConditions(\\"MainCondition\\")"}\n\n{\n    "block_id": 1416,\n    "hash": "12fc87ce6a70e2fc993ab9ffe623311f1c50edd1157595ce6183c38c93960cae",\n    "penalty": 0,\n    "err": "273"\n}\n')])])]),s("p",[t._v("我们创建了一个生态参数"),s("code",[t._v("new_record_account")]),t._v("，设置值为keyId "),s("code",[t._v("6667782293976713160")]),t._v(", 修改权限为"),s("code",[t._v('ContractConditions("MainCondition")')]),t._v('指当前生态创建者可修改。\n交易执行成功时，"err"字段该生态参数id为'),s("code",[t._v("273")]),t._v("。")]),t._v(" "),s("h3",{attrs:{id:"step-7-add-localization"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#step-7-add-localization"}},[t._v("#")]),t._v(" 第7步添加本地化 ")]),t._v(" "),s("p",[t._v("可以调用"),s("code",[t._v("@1NewLangJoint")]),t._v("合约创建本地化参数"),s("code",[t._v("account_not_access")]),t._v("，将在"),s("code",[t._v("@1languages")]),t._v("表创建参数，你可以通过"),s("code",[t._v("@1EditLangJoint")]),t._v("修改本地化参数.")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("callContract @1NewLangJoint "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Name"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"account_not_access"')]),t._v(", "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"LocaleArr"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"en"')]),t._v(", "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ja"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(", "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ValueArr"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Sorry, you do not have access to this action"')]),t._v(", "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"申し訳ありませんが、このアクションにアクセスする権限がありません"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h3",{attrs:{id:"step-8-modify-the-contract"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#step-8-modify-the-contract"}},[t._v("#")]),t._v(" 第8步修改合约 ")]),t._v(" "),s("p",[t._v("接着我们需要修改一下合约源码"),s("code",[t._v("conditions")]),t._v("部分,在"),s("code",[t._v("conditions")]),t._v("添加如下代码。")]),t._v(" "),s("div",{staticClass:"language-text extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('conditions {\n  if EcosysParam("new_record_account") != $key_id {\n      warning LangRes("account_not_access")\n  }\n}\n')])])]),s("p",[t._v("调用修改合约@1EditContract,这里的"),s("code",[t._v("Id")]),t._v("为合约id, "),s("code",[t._v("Value")]),t._v("：为合约源码。")]),t._v(" "),s("div",{staticClass:"language-text extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('>callContract @1EditContract {"Id": 348, "Value": "contract NewRecord {\\n    data {\\n        Student string\\n        Grade int\\n        Class int\\n        Mathematics int\\n        Physics int\\n        Literature int\\n    }\\n    func getScore(a b c int) map{\\n        var m map\\n        var overallScore int\\n        overallScore = (a+b+c) / 3\\n        m[\\"overallScore\\"] = overallScore\\n        if overallScore >= $gradeTypeABest[\\"min\\"] &amp;&amp; overallScore &lt; $gradeTypeABest[\\"max\\"] {\\n            m[\\"score\\"] = \\"A+\\"\\n        }elif overallScore >= $gradeTypeA[\\"min\\"] &amp;&amp; overallScore &lt; $gradeTypeA[\\"max\\"] {\\n            m[\\"score\\"] = \\"A\\"\\n        }elif overallScore >= $gradeTypeBBest[\\"min\\"] &amp;&amp; overallScore &lt; $gradeTypeBBest[\\"max\\"] {\\n            m[\\"score\\"] = \\"B+\\"\\n        }elif overallScore >= $gradeTypeB[\\"min\\"] &amp;&amp; overallScore &lt; $gradeTypeB[\\"max\\"] {\\n            m[\\"score\\"] = \\"B\\"\\n        }elif overallScore >= $gradeTypeC[\\"min\\"] &amp;&amp; overallScore &lt; $gradeTypeC[\\"max\\"]{\\n            m[\\"score\\"] = \\"C\\"\\n        }else{\\n            m[\\"score\\"] = \\"Notset\\"\\n        }\\n        return m\\n    }\\n    func safeJsonDecode(m string) map {\\n        var res map\\n        if Size(m) > 0 {\\n            res = JSONDecode(m)\\n        }\\n        return res\\n    }\\n\\n    conditions {\\n        if EcosysParam(\\"new_record_account\\") != $key_id {\\n            warning LangRes(\\"account_not_access\\")\\n        }\\n        if Size($Student) == 0 {\\n            warning \\"Student Can not be empty\\"\\n        }\\n        if $Class &lt;= 0{\\n            warning \\"Class cannot be less than or equal to zero\\"\\n        }\\n         if $Grade &lt;= 0{\\n            warning \\"Grade cannot be less than or equal to zero\\"\\n        }\\n        if $Mathematics &lt; 0 {\\n            warning \\"Mathematics cannot be less than zero\\"\\n        }\\n        if $Physics &lt; 0 {\\n            warning \\"Physics cannot be less than zero\\"\\n        }\\n        if $Literature &lt; 0 {\\n            warning \\"Literature cannot be less than zero\\"\\n        }\\n        if $Mathematics > 100 || $Physics > 100 ||  $Literature > 100{\\n            warning \\"Score cannot exceed 100\\"\\n        }\\n        var app map\\n        app = DBFind(\\"@1applications\\").Columns(\\"id,ecosystem\\").Where({\\"ecosystem\\": 18,\\"name\\":\\"GradesRecorder\\",\\"deleted\\":0}).Row()\\n        if !app {\\n            warning LangRes(\\"@1app_not_found\\")\\n        }\\n\\n        var app_id int\\n        app_id = Int(app[\\"id\\"])\\n        $eId = Int(app[\\"ecosystem\\"])\\n        $gradeBestType = AppParam(app_id, \\"grade_best_type\\", $eId)\\n        $gradeTypeABest = safeJsonDecode(AppParam(app_id, \\"grade_type_a+\\", $eId))\\n        $gradeTypeA = safeJsonDecode(AppParam(app_id, \\"grade_type_a\\", $eId))\\n        $gradeTypeBBest = safeJsonDecode(AppParam(app_id, \\"grade_type_b+\\", $eId))\\n        $gradeTypeB = safeJsonDecode(AppParam(app_id, \\"grade_type_b\\", $eId))\\n        $gradeTypeC = safeJsonDecode(AppParam(app_id, \\"grade_type_c\\", $eId))\\n    }\\n    action {\\n        var m map \\n        m = getScore($Mathematics,$Physics,$Literature)\\n        var in map\\n        in[\\"student\\"] = $Student\\n        in[\\"class\\"] = $Class\\n        in[\\"grade\\"] = $Grade\\n        in[\\"mathematics\\"] = $Mathematics\\n        in[\\"physics\\"] = $Physics \\n        in[\\"literature\\"] = $Literature \\n        in[\\"overall_score\\"] = m[\\"overallScore\\"]\\n        in[\\"score\\"] = m[\\"score\\"]\\n        in[\\"created_at\\"] = $time\\n        DBInsert(\\"@\\"+ Str($eId)+\\"grade_info\\", in)\\n    }\\n}"}\n')])])]),s("h4",{attrs:{id:"step-9-modify-data-table-permissions"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#step-9-modify-data-table-permissions"}},[t._v("#")]),t._v(" 第9步修改数据表权限 ")]),t._v(" "),s("p",[t._v("这里我们需要将数据表的插入权限修改，原先权限"),s("code",[t._v('ContractConditions("MainCondition")')]),t._v("为生态创建人，而合约设置"),s("code",[t._v("new_record_account")]),t._v("并不是生态创建人，\n所以只需将"),s("code",[t._v('ContractConditions("MainCondition")')]),t._v("修改为指定合约可操作"),s("code",[t._v('ContractAccess("@18NewRecord")')]),t._v("即可.\n调用合约"),s("code",[t._v("@1EditTable")]),t._v("修改数据表权限。")]),t._v(" "),s("div",{staticClass:"language-text extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('>callContract @1EditTable {"Name": "@18grade_info", "InsertPerm": "ContractAccess(\\"@18NewRecord\\")", "UpdatePerm": "ContractConditions(\\"MainCondition\\")", "ReadPerm": "true", "NewColumnPerm": "ContractConditions(\\"MainCondition\\")"}\n')])])]),s("p",[t._v("接着调用一下刚刚修改的合约，新建一条记录。")]),t._v(" "),s("div",{staticClass:"language-text extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('1  >callContract @18NewRecord {"Student": "tom", "Grade": 1, "Class": 1, "Mathematics": 18, "Physics": 57, "Literature": 93}\n2  \n3  {\n4      "block_id": 1435,\n5      "hash": "7d4b06d3738133f9c2ec775935478cd2d6c20fd04eca275769afd0f8e6a4f687",\n6      "penalty": 1,\n7      "err": "{\\"type\\":\\"warning\\",\\"error\\":\\"Sorry, you do not have access to this action\\"}"\n8  }\n')])])]),s("p",[t._v("可以看到我们刚刚设置的本地化参数"),s("code",[t._v("account_not_access")]),t._v("起作用了。")]),t._v(" "),s("p",[t._v("发现报了权限错误，当前用户没有权限操作，我们切换到keyId为"),s("code",[t._v("6667782293976713160")]),t._v("的账户,我们可以通过命令行工具"),s("code",[t._v("account info")]),t._v("获取当前用户的信息。\n设置命令行工具"),s("code",[t._v("config.yml，切换到keyId为")]),t._v("6667782293976713160`的账户。\n设置完成后，再次调用合约。")]),t._v(" "),s("div",{staticClass:"language-text extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('>callContract @18NewRecord {"Student": "tini", "Grade": 1, "Class": 3, "Mathematics": 69, "Physics": 89, "Literature": 98}\n\n{\n    "block_id": 1436,\n    "hash": "93327dafb7bae9f9f66718eb87020a7bca4c00060f4bd0a243b49eea304c52e6",\n    "penalty": 0,\n    "err": ""\n}\n')])])]),s("p",[t._v("调用完成,通过"),s("code",[t._v("getList @18grade_info")]),t._v("查询数据表，结果符合预期。")]),t._v(" "),s("p",[t._v("希望本文能帮助您更多地了解IBAX网络如何工作以及如何编写清晰安全的"),s("code",[t._v("Needle")]),t._v("代码。")]),t._v(" "),s("h2",{attrs:{id:"deploy-application-using-command-line-tools"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#deploy-application-using-command-line-tools"}},[t._v("#")]),t._v(" 使用命令行工具部署应用 ")]),t._v(" "),s("p",[t._v("在本教程中，您将学习如何：")]),t._v(" "),s("ul",[s("li",[t._v("1."),s("a",{attrs:{href:"#export-application"}},[t._v("导出应用")])]),t._v(" "),s("li",[t._v("2."),s("a",{attrs:{href:"#import-application"}},[t._v("导入应用")])])]),t._v(" "),s("p",[t._v("在开始本教程之前，你需要有一个自己的应用并且知道生态与应用的概念，你可以参考"),s("a",{attrs:{href:"#getting-started-guide"}},[t._v("入门指南")]),t._v(" 。\n我们将通过"),s("a",{attrs:{href:"https://github.com/IBAX-io/ibax-cli",target:"_blank",rel:"noopener noreferrer"}},[t._v("命令行工具"),s("OutboundLink")],1),t._v(" 在IBAX区块链上导入应用、导出应用。")]),t._v(" "),s("h3",{attrs:{id:"export-application"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#export-application"}},[t._v("#")]),t._v(" 导出应用 ")]),t._v(" "),s("p",[t._v("调用"),s("code",[t._v("account info")]),t._v("可以查询当前的账户信息,这里登录的生态id为"),s("code",[t._v("9")]),t._v(",调用"),s("code",[t._v("getList")]),t._v("命令可以查询当前生态有哪些应用。")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("$ ibax-cli console\n   \nWelcome to the IBAX console"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("\nTo exit, press ctrl-d or "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("type")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("exit")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("account info\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"public_key"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"04d11ea197fe23152562c6f54c4...889c074dfd9080099982d8b2d4d100315e1cebc7"')]),t._v(",     \n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ecosystem_id"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("9")]),t._v(",\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"key_id"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("6660819")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".78795186,\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"account"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0666-0819-...-7879-5186"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("getList @1applications "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-w")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ecosystem"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("9")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"count"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),t._v(",\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"list"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"conditions"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"true"')]),t._v(",\n            "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"deleted"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0"')]),t._v(",\n            "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ecosystem"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"9"')]),t._v(",\n            "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"id"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"36"')]),t._v(",\n            "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"name"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"testapp"')]),t._v(",\n            "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"uuid"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"00000000-0000-0000-0000-000000000000"')]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("可以看到当前生态有6个应用，我们使用"),s("code",[t._v("export")]),t._v("命令导出"),s("code",[t._v("id")]),t._v("为"),s("code",[t._v("36")]),t._v("的应用。")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("export "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("36")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-f")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("./data.json\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"name"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./data.json"')]),t._v(",\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"type"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"application/json"')]),t._v(",\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"value"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("这里的-f参数，将要导出的应用保存到当前目录"),s("code",[t._v("data.json")]),t._v("文件中，\n如果没有-f参数，则将在命令终端输出应用数据。")]),t._v(" "),s("p",[s("code",[t._v("export")]),t._v("命令封装了导出应用的步骤，你可以使用以上命令导出应用，或使用以下步骤，具体步骤如下：\n调用合约"),s("code",[t._v("@1ExportNewApp")]),t._v("导出一个新的应用，会在"),s("code",[t._v("1_buffer_data")]),t._v("表生成一条导出应用的记录。")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("callContract @1ExportNewApp "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ApplicationId"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("36")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("调用合约"),s("code",[t._v("@1Export")]),t._v("导出应用,在"),s("code",[t._v("1_buffer_data")]),t._v("表中查找所选应用程序，并将所有应用程序资源导出到生成的 json 字符串中。\n生成的 json 字符串将写入当前生态系统的"),s("code",[t._v("1_binaries")]),t._v("表。")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("callContract @1Export\n")])])]),s("p",[t._v("通过"),s("code",[t._v("getList")]),t._v("命令查询"),s("code",[t._v("1_binaries")]),t._v("表中的数据。")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("getList @1binaries "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-w")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"name"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"export"')]),t._v(", "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"account"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0666-0819-...-7879-5186"')]),t._v(", "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ecosystem"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("9")]),t._v(", "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"app_id"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("36")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-l")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-c")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"id,hash"')]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"count"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(",\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"list"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"hash"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"8542cb57b77e0ae2c...92c3e05dbbe35ab646789be5b8ba8"')]),t._v(",\n            "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"id"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"14"')]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("得到二进制文件id和hash。\n调用"),s("code",[t._v("binaryVerify")]),t._v("命令导出二进制文件。")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("binaryVerify "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("14")]),t._v(" 8542cb57b77e0ae2c"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".92c3e05dbbe35ab646789be5b8ba8 "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-f")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("./data.json\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"name"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./data.json"')]),t._v(",     \n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"type"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"application/json"')]),t._v(",\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"value"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h3",{attrs:{id:"import-application"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#import-application"}},[t._v("#")]),t._v(" 导入应用 ")]),t._v(" "),s("p",[t._v("使用"),s("code",[t._v("import")]),t._v("命令导入应用，"),s("code",[t._v("-f")]),t._v("参数为指定导入的应用文件。")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("$ ibax-cli console\n\nWelcome to the IBAX console"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("\nTo exit, press ctrl-d or "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("type")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("exit")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("import "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-f")]),t._v(" ./data.json\n")])])]),s("p",[t._v("其中"),s("code",[t._v("import")]),t._v("命令封装了导入应用的步骤，你可以使用以上命令导入应用。")]),t._v(" "),s("p",[t._v("或使用以下步骤，为方便学习与研究，具体步骤如下：")]),t._v(" "),s("ul",[s("li",[t._v("第1步\n调用合约"),s("code",[t._v("@1ImportUpload")]),t._v("导入一个新的应用，会在"),s("code",[t._v("1_buffer_data")]),t._v("表生成一条导出应用的记录。\n"),s("code",[t._v("@1ImportUpload")]),t._v("该合约参数"),s("code",[t._v("Data")]),t._v("为"),s("code",[t._v("file")]),s("RouterLink",{attrs:{to:"/zh-CN/topics/vm.html#types"}},[t._v("类型")]),t._v(" ,\n包含关键字"),s("code",[t._v("Name")]),t._v("文件名(string),"),s("code",[t._v("MimeType")]),t._v("文件类型(string),"),s("code",[t._v("Body")]),t._v("([]byte)文件内容。\n你需要将应用文件数据进行base64编码后传入"),s("code",[t._v("Body")]),t._v("中，可以使用"),s("code",[t._v("base64Encode")]),t._v("命令进行base64编码。")],1)]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("base64Encode "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-f")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("./data.json\n\nEncode:ewoJIm5hbWUiOiAid"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".CQkJIlR5cGUiOiAiY29udHJhY3RzIiwKCQkJIk5hbWUiOiAiSGVsbG9Xb3JsZCIsCgkJCSJWYWx1ZSI6"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\n\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("callContract @1ImportUpload "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Data"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Name"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"filename"')]),t._v(", "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"MimeType"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"mimeType"')]),t._v(", "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Body"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ewoJIm5hbWUiOiAid...CQkJIlR5cGUiOiAiY29udHJhY3RzIiwKCQkJIk5hbWUiOiAiSGVsbG9Xb3JsZCIsCgkJCSJWYWx1ZSI6..."')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("ul",[s("li",[t._v("第2步\n调用完成后，使用"),s("code",[t._v("getList")]),t._v("命令查询"),s("code",[t._v("1_buffer_data")]),t._v("表中的数据。")])]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("getList @1buffer_data "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-w")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"key"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"import"')]),t._v(", "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"account"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0666-0819-xxxx-7879-5186"')]),t._v(", "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ecosystem"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-l")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-c")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("value-"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'data'")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"count"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(",\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"list"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"id"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"22"')]),t._v(",\n            "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"value.data"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"[{"')]),t._v("Data"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('": "')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("a,b"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"}, {"')]),t._v("Data"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('": "')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("c,d"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"}]"')]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("ul",[s("li",[t._v("第3步\n将value.data->Data中的数据组装成一维数组，[a,b,c,d],\n然后创建一个合约参数文件"),s("code",[t._v("importParams.json")]),t._v(",内容如下：")])]),t._v(" "),s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"Data"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"[a,b,c,d]"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("-第4步 调用合约"),s("code",[t._v("@1Import")]),t._v("导入应用数据。")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("callContract @1Import "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-f")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("./importParams.json\n")])])]),s("h2",{attrs:{id:"ecological-configuration-using-command-line-tool"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ecological-configuration-using-command-line-tool"}},[t._v("#")]),t._v(" 使用命令行工具生态配置 ")]),t._v(" "),s("p",[t._v("在本教程中，您将学习如何：")]),t._v(" "),s("ul",[s("li",[t._v("1."),s("a",{attrs:{href:"#apply-to-join-the-ecology"}},[t._v("申请加入生态")])]),t._v(" "),s("li",[t._v("2."),s("a",{attrs:{href:"#add-ecological-members"}},[t._v("添加生态成员")])]),t._v(" "),s("li",[t._v("3."),s("a",{attrs:{href:"#role-management"}},[t._v("角色管理")])]),t._v(" "),s("li",[t._v("4."),s("a",{attrs:{href:"#issuance-of-token"}},[t._v("生态代币发行")])]),t._v(" "),s("li",[t._v("5."),s("a",{attrs:{href:"#eco-deduction"}},[t._v("生态代扣")])]),t._v(" "),s("li",[t._v("6."),s("a",{attrs:{href:"#dao-governance-ecology"}},[t._v("DAO治理生态")])])]),t._v(" "),s("p",[t._v("在开始本教程之前，你需要有一个自己的应用并且知道生态与应用的概念，你可以参考"),s("a",{attrs:{href:"#getting-started-guide"}},[t._v("入门指南")]),t._v(" 。\n我们将通过"),s("a",{attrs:{href:"https://github.com/IBAX-io/ibax-cli",target:"_blank",rel:"noopener noreferrer"}},[t._v("命令行工具"),s("OutboundLink")],1),t._v(" 在IBAX区块链上进行生态配置。")]),t._v(" "),s("h3",{attrs:{id:"apply-to-join-the-ecology"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#apply-to-join-the-ecology"}},[t._v("#")]),t._v(" 申请加入生态 ")]),t._v(" "),s("p",[t._v("我们可以调用"),s("code",[t._v("@1MembershipRequest")]),t._v("合约申请加入生态。\n如下例子：")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("callContract @1MembershipRequest "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"EcosystemId"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("19")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("申请加入生态id为"),s("code",[t._v("19")]),t._v("的生态，"),s("code",[t._v("@1MembershipRequest")]),t._v("合约对调用生态做了限制，只有在基础生态才可调用，\n当申请成功后，目标生态管理者会收到一条申请，只有申请被生态管理者批复后才算是加入了目标生态,\n当然如果目标生态时公开的，你可以直接加入目标生态。")]),t._v(" "),s("h3",{attrs:{id:"add-ecological-members"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#add-ecological-members"}},[t._v("#")]),t._v(" 添加生态成员 ")]),t._v(" "),s("p",[t._v("当生态刚创建时,生态成员只有生态创建者,当你需要邀请其他成员加入时,你需要知道被邀请人的公钥,然后调用合约"),s("code",[t._v("@1MembershipAdd")]),t._v("添加成员。")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("callContract @1MembershipAdd "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Keys"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"04f2c1780ca0aa0f343d0e541c77811...3b0d5bf3a9903253aad6e78c966b5f91ffb32703884020"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("如果生态是公开的允许任何人加入，你可以设置生态参数"),s("code",[t._v("free_membership")]),t._v(" = 1,默认是不公开的，\n设置完成后，无需通过审批即可加入你的生态。")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("callContract @1NewParameter "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Name"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"free_membership"')]),t._v(", "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Value"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1"')]),t._v(", "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Conditions"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ContractConditions('),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v("MainCondition"),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v(')"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("如果你没有设置参数"),s("code",[t._v("free_membership")]),t._v(",其他成员申请加入你的生态时，你将会收到一条申请通知，可通过``查看所有的角色通知。")]),t._v(" "),s("p",[t._v("调用"),s("code",[t._v("@1MembershipDecide")]),t._v("合约批复申请,合约参数"),s("code",[t._v("NotificId")]),t._v("为通知id，'Accept'为决议标识，决议标识"),s("code",[t._v("1")]),t._v("为通过。")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("callContract @1MembershipDecide "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"NotificId"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),t._v(", "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Accept"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h3",{attrs:{id:"freezing-of-accounts"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#freezing-of-accounts"}},[t._v("#")]),t._v(" 冻结账户 ")]),t._v(" "),s("p",[t._v("调用"),s("code",[t._v("@1DeleteMember")]),t._v("合约冻结账户，注意此操作无法还原。")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("callContract @1DeleteMember "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"MemberAccount"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1539-2715-xxxx-1679-5385"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h3",{attrs:{id:"role-management"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#role-management"}},[t._v("#")]),t._v(" 角色管理 ")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"#new-role-creation"}},[t._v("新建角色")])]),t._v(" "),s("li",[s("a",{attrs:{href:"#adding-role-members"}},[t._v("添加角色成员")])]),t._v(" "),s("li",[s("a",{attrs:{href:"#delete-role-members"}},[t._v("删除角色成员")])]),t._v(" "),s("li",[s("a",{attrs:{href:"#modify-role-manager"}},[t._v("修改角色管理者")])]),t._v(" "),s("li",[s("a",{attrs:{href:"#delete-role"}},[t._v("删除角色")])])]),t._v(" "),s("h4",{attrs:{id:"new-role-creation"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#new-role-creation"}},[t._v("#")]),t._v(" 新建角色 ")]),t._v(" "),s("p",[t._v("调用"),s("code",[t._v("@1RolesCreate")]),t._v("合约新建角色，角色名"),s("code",[t._v("student")]),t._v(",类型"),s("code",[t._v("2")]),t._v("(1-可分配 2-通过投票选任类型 3-System)。")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("callContract @1RolesCreate "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Name"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"student"')]),t._v(", "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Type"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"block_id"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1685")]),t._v(",\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"hash"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"5321f2231a...d0d80158b62766395f14d0ff7"')]),t._v(",\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"penalty"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(",\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"err"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"21"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("返回结果里包含角色id "),s("code",[t._v("21")]),t._v("。")]),t._v(" "),s("h4",{attrs:{id:"adding-role-members"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#adding-role-members"}},[t._v("#")]),t._v(" 添加角色成员 ")]),t._v(" "),s("p",[t._v("有两种方法，第一种方法，生态成员发起申请，调用合约"),s("code",[t._v("@1RolesRequest")]),t._v("申请添加为该角色成员,其中"),s("code",[t._v("Rid")]),t._v("为角色id。")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("callContract @1RolesRequest "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Rid"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("21")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("第二种方法，角色管理者分配角色成员,角色管理者调用合约"),s("code",[t._v("@1RolesAssign")]),t._v("添加该角色的成员。")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("callContract @1RolesAssign "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"MemberAccount"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0666-7782-xxxx-7671-3160"')]),t._v(", "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Rid"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("21")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h4",{attrs:{id:"delete-role-members"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#delete-role-members"}},[t._v("#")]),t._v(" 删除角色成员 ")]),t._v(" "),s("p",[t._v("首先我们查看某个角色有哪些成员,我们可以通过getList查询,如下所示：")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("getList @1roles_participants "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-w")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ecosystem"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("18")]),t._v(", "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"role->id"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"21"')]),t._v(", "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"deleted"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"count"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(",\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"list"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"appointed"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"{'),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v("account"),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v(": "),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v("1273-2644-xxxx-5846-6598"),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v(", "),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v("image_id"),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v(": "),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v("0"),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v(", "),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v("member_name"),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v(": "),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v("founder"),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v('}"')]),t._v(",\n            "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"date_created"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1684916023"')]),t._v(",\n            "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"date_deleted"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0"')]),t._v(",\n            "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"deleted"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0"')]),t._v(",\n            "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ecosystem"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"18"')]),t._v(",\n            "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"id"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"21"')]),t._v(",\n            "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"member"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"{'),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v("account"),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v(": "),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v("1273-2644-xxxx-5846-6598"),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v(", "),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v("image_id"),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v(": "),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v("0"),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v(", "),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v("member_name"),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v(": "),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v("founder"),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v('}"')]),t._v(",\n            "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"role"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"{'),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v("id"),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v(": "),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v("20"),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v(", "),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v("name"),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v(": "),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v("teacher"),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v(", "),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v("type"),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v(": "),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v("1"),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v(", "),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v("image_id"),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v(": "),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v("0"),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v('}"')]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("其中"),s("code",[t._v("where")]),t._v("条件"),s("code",[t._v("ecosystem")]),t._v("指定生态，"),s("code",[t._v("role->id")]),t._v("指定角色id，"),s("code",[t._v("deleted")]),t._v(": 0指定未删除。\n我们可以看到查询到了3条记录,假如我们要移除成员为"),s("code",[t._v("1273-2644-xxxx-5846-6598")]),t._v("的角色权限，即"),s("code",[t._v("id")]),t._v("为"),s("code",[t._v("21")]),t._v("的角色。\n管理员可以调用合约"),s("code",[t._v("@1RolesUnassign")]),t._v("删除角色成员,如下所示：")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("callContract @1RolesUnassign "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"RowId"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("21")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h4",{attrs:{id:"modify-role-manager"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#modify-role-manager"}},[t._v("#")]),t._v(" 修改角色管理者 ")]),t._v(" "),s("p",[t._v("我们查看一下当前生态的角色。")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("getList @1roles "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-w")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ecosystem"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("18")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"count"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),t._v(",\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"list"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"company_id"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0"')]),t._v(",\n            "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"creator"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"{'),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v("account"),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v(": "),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v("1273-2644-xxxx-5846-6598"),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v(", "),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v("image_id"),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v(": "),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v("0"),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v(", "),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v("member_name"),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v(": "),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v("founder"),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v('}"')]),t._v(",\n            "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"date_created"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1684910917"')]),t._v(",\n            "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"date_deleted"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0"')]),t._v(",\n            "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"default_page"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),t._v(",\n            "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"deleted"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0"')]),t._v(",\n            "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ecosystem"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"18"')]),t._v(",\n            "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"id"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"20"')]),t._v(",\n            "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"image_id"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"0"')]),t._v(",\n            "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"role_name"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"teacher"')]),t._v(",\n            "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"role_type"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1"')]),t._v(",\n            "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"roles_access"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"[]"')]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("其中"),s("code",[t._v("roles_access")]),t._v("为当前角色的管理角色，它是一个数组，可以有多个。\n我们给"),s("code",[t._v("teacher")]),t._v("这个角色添加管理角色，调用"),s("code",[t._v("@1RolesAccessManager")]),t._v("合约,其中合约参数"),s("code",[t._v("Action")]),t._v(" 管理操作符("),s("code",[t._v("clean")]),t._v("清空,"),s("code",[t._v("remove")]),t._v("删除,"),s("code",[t._v("add")]),t._v("添加),"),s("code",[t._v("Rid")]),t._v("要管理的角色ID,"),s("code",[t._v("ManagerRid")]),t._v("该 Rid 角色的管理者。")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("callContract @1RolesAccessManager "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Action"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"add"')]),t._v(", "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Rid"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),t._v(", "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ManagerRid"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("13")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"block_id"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1745")]),t._v(",\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"hash"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"e2eb8ff0dc309ec7652db...bbbe58bca4ca574804e46c2f63653eb73104"')]),t._v(",\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"penalty"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(",\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"err"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h4",{attrs:{id:"delete-role"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#delete-role"}},[t._v("#")]),t._v(" 删除角色 ")]),t._v(" "),s("p",[t._v("我们可以调用"),s("code",[t._v("@1RolesDelete")]),t._v("合约删除角色，其中合约参数"),s("code",[t._v("Rid")]),t._v("要管理的角色ID，"),s("code",[t._v("Ops")]),t._v("为操作符("),s("code",[t._v("D")]),t._v("为删除 "),s("code",[t._v("R")]),t._v("为恢复)")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("callContract @1RolesDelete "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Rid"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("24")]),t._v(", "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Ops"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"D"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"block_id"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1785")]),t._v(",\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"hash"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1ebf99a04f504fc3d2...4ecfbdfc419bf3dbf39df0013dca913f844"')]),t._v(",\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"penalty"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(",\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"err"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h3",{attrs:{id:"issuance-of-token"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#issuance-of-token"}},[t._v("#")]),t._v(" 生态代币发行 ")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"#create-ecology"}},[t._v("创建生态")])]),t._v(" "),s("li",[s("a",{attrs:{href:"#installing-basic-applications"}},[t._v("安装基础应用")])]),t._v(" "),s("li",[s("a",{attrs:{href:"#token-issuance"}},[t._v("生态发币")])])]),t._v(" "),s("h4",{attrs:{id:"create-ecology"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#create-ecology"}},[t._v("#")]),t._v(" 创建生态 ")]),t._v(" "),s("p",[t._v("创建一个生态, 调用"),s("code",[t._v("@1NewEcosystem")]),t._v("合约。")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("callContract @1NewEcosystem "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Name"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Test Ecosystem"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"block_id"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1787")]),t._v(",\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"hash"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"384f35ef93243c9dd4f53b9298873b356b25b31cf7c6a6be7600ee7694d77006"')]),t._v(",\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"penalty"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(",\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"err"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"21"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v('然后我们修改命令行工具配置，登录到新创建的这个生态ecosystem: "21"。')]),t._v(" "),s("h4",{attrs:{id:"installing-basic-applications"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#installing-basic-applications"}},[t._v("#")]),t._v(" 安装基础应用 ")]),t._v(" "),s("p",[t._v("调用合约安装基础应用,如下所示：")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("callContract @1PlatformAppsInstall\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("callContract @1RolesInstall\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("callContract @1AppInstall "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ApplicationId"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("callContract @1AppInstall "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ApplicationId"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("第1行，安装平台应用。\n第2行，安装默认角色。\n第3-4行，安装生态配置与代币发行应用，其中应用id "),s("code",[t._v("5,6")]),t._v("可通过getList查询，如下：")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("getList @1applications "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-w")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ecosystem"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(", "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$or")]),t._v('"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"name"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Token emission"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(","),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"name"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Ecosystems catalog"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-c")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"name,ecosystem"')]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"count"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(",\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"list"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ecosystem"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1"')]),t._v(",\n            "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"id"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"5"')]),t._v(",\n            "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"name"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Token emission"')]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(",\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ecosystem"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1"')]),t._v(",\n            "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"id"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"6"')]),t._v(",\n            "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"name"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Ecosystems catalog"')]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h4",{attrs:{id:"token-issuance"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#token-issuance"}},[t._v("#")]),t._v(" 生态发币 ")]),t._v(" "),s("p",[t._v("因为是新建的生态，需要进行代币发行设置,调用"),s("code",[t._v("@1TeSettings")]),t._v("合约指定可发行代币的角色。")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("callContract @1TeSettings "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"RoleDeveloper"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("30")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("其中"),s("code",[t._v("RoleDeveloper")]),t._v("为当前生态角色id，可通过"),s("code",[t._v("@1roles")]),t._v("数据表获取。")]),t._v(" "),s("p",[s("strong",[t._v("代币发行")]),t._v(" 调用"),s("code",[t._v("@1NewToken")]),t._v("合约发行代币。")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("callContract @1NewToken "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Symbol"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"TEST"')]),t._v(", "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Name"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"TEST Coin"')]),t._v(", "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Amount"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"10000000000000000"')]),t._v(" ,"),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Digits"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"12"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("其中合约参数"),s("code",[t._v("Symbol")]),t._v("为代币符号，"),s("code",[t._v("Name")]),t._v("为代币名称，"),s("code",[t._v("Amount")]),t._v("为总额，"),s("code",[t._v("Digits")]),t._v("为精度。")]),t._v(" "),s("p",[s("strong",[t._v("增发代币")])]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("callContract @1TeEmission "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Amount"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000000000000")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[s("strong",[t._v("销毁代币")])]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("callContract @1TeBurn "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Amount"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000000000000")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("默认增发代币和销毁代币是允许的，你可以通过"),s("code",[t._v("@1TeChange")]),t._v("设置关闭，其中"),s("code",[t._v("TypeChange")]),t._v("为类型("),s("code",[t._v("emission")]),t._v("增发,"),s("code",[t._v("withdraw")]),t._v("销毁),\n"),s("code",[t._v("Value")]),t._v("为开关状态("),s("code",[t._v("1")]),t._v("开启,"),s("code",[t._v("2")]),t._v("关闭)，例如：\n"),s("strong",[t._v("关闭增发")]),t._v(" 注意：关闭后无法开启 。")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("callContract @1TeChange "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"TypeChange"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"emission"')]),t._v(", "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Value"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[s("strong",[t._v("关闭销毁")]),t._v(",如果你想再次开启销毁功能，将"),s("code",[t._v("Value")]),t._v("置为"),s("code",[t._v("1")]),t._v("即可。")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("callContract @1TeChange "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"TypeChange"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"withdraw"')]),t._v(", "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Value"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h3",{attrs:{id:"eco-deduction"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#eco-deduction"}},[t._v("#")]),t._v(" 生态代扣 ")]),t._v(" "),s("p",[t._v("在设置生态代扣之前，你需要了解IBAX收费模型，可在 "),s("a",{attrs:{href:"https://github.com/IBAX-io/whitepaper",target:"_blank",rel:"noopener noreferrer"}},[t._v("白皮书"),s("OutboundLink")],1),t._v(" 中找到.")]),t._v(" "),s("p",[t._v("我们首先设置生态钱包地址,调用"),s("code",[t._v("@1EditParameter")]),t._v("合约，修改生态参数：")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("callContract @1EditParameter "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Id"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("334")]),t._v(", "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Value"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1273-2644-xxxx-5846-6598"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("其中"),s("code",[t._v("Id")]),t._v("为生态钱包"),s("code",[t._v("ecosystem_wallet")]),t._v("参数id，可通过如下方式查询：")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("getList @1parameters "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-w")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ecosystem"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("22")]),t._v(", "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"name"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ecosystem_wallet"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[s("code",[t._v("Value")]),t._v("值为将要绑定的生态钱包地址，合约产生的gas费，由该地址付款。该地址必须在当前生态有足够的代币，并且需要被绑定地址同意后才会修改成功。")]),t._v(" "),s("p",[t._v("调用"),s("code",[t._v("@1EcoFeeModeManage")]),t._v("合约设置多生态扣费,如下：")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("callContract @1EcoFeeModeManage "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"FollowFuel"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.01")]),t._v(", "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"CombustionFlag"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(", "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"VmCostFlag"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(", "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"VmCostConversionRate"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),t._v(", "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"StorageConversionRate"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),t._v(", "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"StorageFlag"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(", "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ExpediteFlag"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("其中合约参数字段定义如下：")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("FollowFuel")]),t._v("        参数为跟随生态1费率的倍数。")]),t._v(" "),s("li",[s("code",[t._v("CombustionFlag")]),t._v("\t是否开启生态交易gas费燃烧，1-否，2-是。")]),t._v(" "),s("li",[s("code",[t._v("CombustionPercent")]),t._v("\t燃烧百分比，仅开启gas费燃烧生效,取值1到100，未开启时为0。")]),t._v(" "),s("li",[s("code",[t._v("VmCostFlag")]),t._v("\t    虚拟机费用标识，设置直付或代付，1-直付，2-代付。")]),t._v(" "),s("li",[s("code",[t._v("StorageFlag")]),t._v("\t    存储费用标识，设置直付或代付，1-直付，2-代付。")]),t._v(" "),s("li",[s("code",[t._v("ExpediteFlag")]),t._v("\t    加急费用标识，设置直付或代付，1-直付，2-代付。")]),t._v(" "),s("li",[s("code",[t._v("VmCostConversionRate")]),t._v("\t   虚拟机费用转换率，小数位2位，仅代付生效，大于零。")]),t._v(" "),s("li",[s("code",[t._v("StorageConversionRate")]),t._v("\t   存储费用转换率，小数位2位，仅代付生效，大于零。")])]),t._v(" "),s("p",[t._v("如果你使用了上述设置,所有用户在该生态内调用合约所产生的交易费用，由当前生态设置的生态钱包统一支付。\n所有用户只需要支付在该生态内所产生的gas费用.当然你可以根据实际需要，调整对应费用参数。")]),t._v(" "),s("h3",{attrs:{id:"dao-governance-ecology"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#dao-governance-ecology"}},[t._v("#")]),t._v(" DAO治理生态 ")]),t._v(" "),s("p",[t._v("在修改为DAO治理生态之前，你需要确保当前生态已经发行代币，修改为DAO治理生态后，生态所有的提案都将由治理委员会成员投票决定，\n不再单独由生态开发者管理， DAO治理委员会成员由生态持币量前50名代表当选。")]),t._v(" "),s("p",[t._v("调用"),s("code",[t._v("@1EditControlMode")]),t._v("合约，将生态治理模式改为DAO治理模式。")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("callContract @1EditControlMode "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Value"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("其中"),s("code",[t._v("Value")]),t._v("参数 "),s("code",[t._v("1")]),t._v("表示创建者模型 "),s("code",[t._v("2")]),t._v("表示DAO治理模型。")]),t._v(" "),s("p",[t._v("我们可以试着创建一个应用：")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("callContract @1NewApplication "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Name"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"testApp"')]),t._v(", "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Conditions"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ContractConditions('),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v("@1DeveloperCondition"),s("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[t._v('\\"')]),t._v(')"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("这个时候会生成一个DAO治理提案，经过DAO治理委员会投票通过后才会创建应用.有效提案需75%的投票数中68%的通过率.\nDAO治理范围包括：\n1、增删改应用、合约、页面、代码片段、选项卡、菜单、应用参数、数据表及字段。\n2、修改多语言。\n3、DAO和创建者模型开关。\n4、编辑生态参数。\n5、角色，分配移除角色成员。\n6、增发销毁币种。\n7、修改平台参数。\n8、修改生态信息。\n9、修改延迟合约。\n10、修改投票模版。")]),t._v(" "),s("h2",{attrs:{id:"deploy-applications-using-application-packaging-tool"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#deploy-applications-using-application-packaging-tool"}},[t._v("#")]),t._v(" 使用应用打包工具部署应用 ")]),t._v(" "),s("p",[t._v("在开始本教程之前，你需要下载"),s("a",{attrs:{href:"https://github.com/IBAX-io/app-tool",target:"_blank",rel:"noopener noreferrer"}},[t._v("IBAX应用打包工具"),s("OutboundLink")],1),t._v(" ,我们需要使用这个工具打包IBAX应用程序。")]),t._v(" "),s("p",[t._v("我们需要按照以下目录结构存放应用程序文件：")]),t._v(" "),s("div",{staticClass:"language-text extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("- APP Name\n    - app_params\n        params1.csv\n        params2.csv\n        ...\n    - contracts\n        contract1.sim\n        contract2.sim\n        ...\n    - tables\n        tableName1.json\n        tableName2.json\n        ...\n    config.json\n")])])]),s("p",[t._v("如下所示：")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("airdrop$ "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("ls")]),t._v(" *\nconfig.json\n\napp_params:\ndedicated_account.csv  lock_percent.csv  per_period_sec.csv  period_count.csv\n\ncontracts:\nAddAirdrop.sim  ClaimAirdrop.sim  SpeedAirdrop.sim\n\ntables:\nairdrop_info.json\n")])])]),s("p",[t._v("其中"),s("code",[t._v("app_params")]),t._v("目录存放应用参数文件，命名使用参数名+文件格式"),s("code",[t._v(".csv")]),t._v("，文件内容为参数值.\n"),s("code",[t._v("contracts")]),t._v("目录存放合约，"),s("code",[t._v(".sim")]),t._v("文件格式，文件内容为合约源码.\n"),s("code",[t._v("tables")]),t._v("目录存放应用数据表结构，"),s("code",[t._v("json")]),t._v("文件格式，如下所示：")]),t._v(" "),s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"name"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"account"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"conditions"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"{\\"read\\": \\"true\\", \\"update\\": \\"ContractConditions(\\"MainCondition\\")\\"}"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"type"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"varchar"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"name"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"balance_amount"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"conditions"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"true"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"type"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"money"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"name"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"stake_amount"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"conditions"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"true"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"type"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"money"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"name"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"surplus"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"conditions"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"true"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"type"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"number"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"name"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"total_amount"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"conditions"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"true"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v('"type"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"money"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])]),s("p",[s("code",[t._v("name")]),t._v("为数据表字段名称，"),s("code",[t._v("conditions")]),t._v("为数据表字段权限， "),s("code",[t._v("type")]),t._v("为字段类型。")]),t._v(" "),s("p",[t._v("第1步，我们生成一个config.json文件，将它保存到airdrop目录，文件内容如下所示：")]),t._v(" "),s("div",{staticClass:"language-text extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('{\n    "name": "Airdrop",\n    "conditions": "ContractConditions(\\"@1MainCondition\\")"\n}\n')])])]),s("p",[t._v("其中"),s("code",[t._v("name")]),t._v("为此应用的名称，"),s("code",[t._v("conditions")]),t._v(": 为修改该应用的权限，然后将它保存到airdrop目录.")]),t._v(" "),s("p",[t._v("第2步,打包应用，通过以下命令会在当前目录生成应用"),s("code",[t._v("airdrop.json")]),t._v(",如果你修改了合约或应用参数，需要重新打包应用.")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("$ ./app-tool airdrop/\n")])])]),s("p",[t._v("我们可以通过"),s("a",{attrs:{href:"https://github.com/IBAX-io/ibax-cli",target:"_blank",rel:"noopener noreferrer"}},[t._v("命令行工具"),s("OutboundLink")],1),t._v(" 导入应用,如下所示：\n使用"),s("code",[t._v("import")]),t._v("命令导入应用，"),s("code",[t._v("-f")]),t._v("参数为指定导入的应用文件。")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("$ ibax-cli console\n\nWelcome to the IBAX console"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("\nTo exit, press ctrl-d or "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("type")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("exit")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("import "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-f")]),t._v(" ./airdrop.json\n")])])]),s("p",[t._v("当然如果你有一个应用，也可以通过以下命令生成完整的目录结构。")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("$ app-tool.exe airdrop.json\n")])])])])}),[],!1,null,null,null);s.default=n.exports}}]);